Apigee.APIModel.Common=function(){navigator.sayswho=function(){var c=navigator.appName,b=navigator.userAgent,a;var d=b.match(/(opera|chrome|safari|firefox|msie|trident)\/?\s*(\.?\d+(\.\d+)*)/i);if(d&&(a=b.match(/version\/([\.\d]+)/i))!=null){d[2]=a[1]}d=d?[d[1],d[2]]:[c,navigator.appVersion,"-?"];return d}();showMessage=function(a){theParent=document.getElementsByTagName("body")[0];theKid=document.createElement("div");theKid.setAttribute("style","height:20px;width:100%;background-color:#F9F6C5;text-align:center;position:fixed;z-index:999;");theKid.innerHTML=a;theParent.appendChild(theKid);theParent.insertBefore(theKid,theParent.firstChild)};isOldMSIE=function(){return navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.match(/msie [6-9]/i)};this.makeAJAXCall=function(f){var j=f.url.toString();var k=document.location.host.toString();if(j.indexOf("targeturl=")!=-1){j=j.split("targeturl=")[0].toString()}if(isOldMSIE()&&window.XDomainRequest&&j.indexOf(k)==-1){var c=f.url;var h=f.type?f.type:"get";if(c.indexOf("targeturl")!=-1){var a=f.type?f.type:"get";c+="&method="+a;h="POST"}if(f.headers){var m=f.headers;var e="{";for(var g=0,d=m.length;g<d;g++){e+='"'+m[g].name+'" : "'+m[g].value+'"';if(d!=1&&g!=d-1){e+=","}}e+="}";e=encodeURIComponent(e);c+="&headers="+e}var b=f.data?f.data:null;xdr=new XDomainRequest;xdr.onload=function(){var n;var l=true;try{n=jQuery.parseJSON(xdr.responseText)}catch(o){l=false}if(!l){f.callback(xdr.responseText)}else{if(n){var i=n.responseStatusCode;if(i){if(parseInt(i)>=400){if(f.errorCallback){f.errorCallback(i);jQuery("#working_alert").fadeOut();return}else{f.callback(n);jQuery("#working_alert").fadeOut();return}}}f.callback(n)}else{f.callback(xdr.responseText)}}jQuery("#working_alert").fadeOut()};xdr.onerror=function(){if(f.errorCallback){f.errorCallback(xdr.responseText)}else{f.callback(xdr.responseText)}jQuery("#working_alert").fadeOut()};xdr.open(h,c);xdr.send(b)}else{jQuery.ajax({url:f.url,cache:false,type:f.hasOwnProperty("type")?f.type:"get",data:f.hasOwnProperty("data")?f.data:null,contentType:f.hasOwnProperty("contentType")?f.contentType:"application/x-www-form-urlencoded;charset=utf-8",processData:f.hasOwnProperty("processData")?f.processData:true,beforeSend:function(p){if(f.headers){for(var o=0,n=f.headers.length;o<n;o++){var q=f.headers[o];p.setRequestHeader(q.name,q.value)}}},success:function(n,o,l){if(typeof n!="object"){f.callback(l.responseText)}else{if(n){var i=n.responseStatusCode;if(i){if(parseInt(i)>=400){if(f.errorCallback){f.errorCallback(i);return}else{f.callback(n);return}}}f.callback(n)}}},error:function(n,i,l){if(window.console){console.error(l)}if(f.errorCallback){f.errorCallback(n.status)}else{f.callback(n.responseText)}},complete:function(){jQuery("#working_alert").fadeOut()}})}};this.closeAuthModal=function(){jQuery('[role="dialog"].modal').modal("hide");jQuery('[role="dialog"].modal input').removeClass("error");jQuery('[role="dialog"].modal .error_container').hide().html("")};this.validateBasicAuthFields=function(b){var c="";userEmail=jQuery.trim(jQuery("[data-role='"+b+"']").find("#inputEmail").val());if(!userEmail.length){jQuery("#inputEmail").addClass("error");c+="<span>Email required.</span><br/>"}var a=jQuery("[data-role='"+b+"']").find("#inputPassword");if(!jQuery.trim(a.val()).length){a.addClass("error");c+="<span>Password required.</span><br/>"}return c};this.shortenText=function(c,a){var b=c.text();if(b.length>a){b=b.substring(0,a-3)+"...";c.text(b)}};this.parseAndReturn=function(a){var c="";try{c=jQuery.parseJSON(a)}catch(b){c=a}return c};this.getQueryParam=function(c,e){var a=c.split("?");if(a.length>2){a=c.split(/\?(.*)/)}if(a.length>1){a=a[1];a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].split("=");if(d[0]==e){return d[1]}}return""}return""};this.escapeSpecialChars=function(a){return a.replace(/\\n/g,"\\n").replace(/'/g,"'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")};this.showError=function(a){jQuery("[data-role='error_container']").text(a).show();jQuery("body").scrollTop(0)};this.showUnsupportedBrowserAlertMessage=function(){var b=navigator.sayswho.toString();var d=b.split(",")[0].toLowerCase();var a=parseInt(b.split(",")[1]);var c="<p>You are using an unsupported browser. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 9. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedBrowserMessage()'> Close</a> ]</p>";if(d!="chrome"){if(d=="firefox"){if(a<10){showMessage(c)}}if(d=="safari"){if(a<6){showMessage(c)}}if(d=="msie"){if(a<9){showMessage(c)}}}};this.hideUnsupportedBrowserMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedBrowserFlag","true")};this.showUnsupportedAttachmentAlertMessage=function(){showMessage("<p>Attachment is not supported in IE9. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 10. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedAttachmentMessage()'> Close</a> ]</p>")};this.hideUnsupportedAttachmentMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedAttachmentFlag","true")};this.dateDiff=function(b,a){var c=b.getTime()-a.getTime();return c/(24*60*60*1e3)}};Apigee.APIModel.Editor=function(){var a;this.initRequestPayloadEditor=function(){var b=jQuery('[data-role="request-payload-example"]');if(b.length){b.children("textarea").show();var c=b.find("textarea");bodyPayloadElementValue=jQuery.trim(c.val());b.val(bodyPayloadElementValue);if(c){var d=c.data("format")=="application/xml"?"xml":"javascript";a=CodeMirror.fromTextArea(c.get(0),{mode:d,lineNumbers:true});if(a.lineCount()<=2){a.setSize("100%",a.lineCount()*18)}else{a.setSize("100%",a.lineCount()*15)}}}};this.getRequestPayLoad=function(){return a.getValue()};this.setRequestPayLoad=function(b){a.setValue(b)}};Apigee.APIModel.Schema=function(){var a;this.initRequestPayloadSchema=function(){if(jQuery('[data-role="request-payload-schema"]').length){jQuery('[data-role="request-payload-schema"]').children("textarea").show();bodyPayloadElementValue=jQuery.trim(jQuery('[data-role="request-payload-schema"]').find("textarea").val());jQuery(".request_payload textarea.payload_text_schema").val(bodyPayloadElementValue);bodyPayloadElement=jQuery(".request_payload textarea.payload_text_schema");if(bodyPayloadElement){var b=bodyPayloadElement.data("format")=="application/xml"?"xml":"javascript";a=CodeMirror.fromTextArea(jQuery(".request_payload textarea.payload_text_schema").get(0),{mode:b,lineNumbers:true});if(a.lineCount()<=2){a.setSize("100%",a.lineCount()*18)}else{a.setSize("100%",a.lineCount()*15)}}jQuery('[data-role="request-payload-schema"]').hide()}};this.getRequestPayLoad=function(){return a.getValue()};this.setRequestPayLoad=function(b){a.setValue(b)}};Apigee.APIModel.Methods=function(){var k=this;var b;var e="";var j="";var t;var r="";var m;var l=false;var v=[];var g=false;var o=[];var n=false;var f=[];var i={};var d={};var p=false;var a="";var q=window.location.href;var h=Apigee.APIModel.apiName;var u=Apigee.APIModel.revisionNumber;var c="";var s="-None-";this.init=function(){var B=jQuery("[data-role='auth-type']");t=jQuery.trim(B.text());if(t.substr(-1)==","){t=t.substr(0,t.length-1)}k.updateAuthContainer();var E="";jQuery("[data-role='method_url_container'] span").each(function(){E+='<span data-role="'+jQuery(this).attr("data-role")+'">'+jQuery(this).html()+"</span>"});jQuery("[data-role='method_url_container']").html(E);b=jQuery("[data-role='method_url_container']");b.html(b.html().replace(/\{/g,"<span data-toggle='tooltip' data-original-title=''><span class='template_param' contenteditable='true'>{").replace(/\}/g,"}</span><span></span></span>"));b.find("span.template_param").each(function(){jQuery(this).siblings("span").attr("data-role",jQuery(this).text());jQuery(this).focusout(function(){var F=jQuery(this);if(jQuery.trim(F.text())==""){F.text(F.siblings("span").attr("data-role"))}})});jQuery("[data-role='template-params']").find("p").each(function(){var G=jQuery(this).find("[data-role='name']").html();var F=jQuery(this).find("[data-role='description']").html();jQuery("[data-toggle='tooltip']").each(function(){var H=jQuery(this).find("span:eq(1)").data("role");if(H){H=H.substring(1,H.length-1);if(H==G){F=jQuery.trim(F);if(F.charAt(F.length-1)!="."){F+="."}jQuery(this).attr("data-original-title",F+" Click to edit the value.")}}})});if(localStorage.hasOwnProperty("templateParams")){var y=JSON.parse(localStorage.getItem("templateParams"));for(var x=0;x<y.length;x++){var A=y[x].name;var w=y[x].value;jQuery("[data-role='method_url_container'] span.template_param").each(function(){var F=jQuery(this).siblings("span");var G=jQuery(this);if(F.attr("data-role")==A){G.text(jQuery.trim(w))}})}}jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='attachments-list']").each(function(F,G){if(!jQuery(this).find("span.required").length&&jQuery(this).find(".value select").length){jQuery(this).find(".value select").prepend("<option value='"+s+"' selected>"+s+"</option>")}var H=jQuery(this).find("[data-role='value']");H.attr("data-original-value",jQuery.trim(H.val()))});var D=jQuery("[data-role='body-param-list']").length;jQuery("[data-role='body-param-list']").each(function(){var F=jQuery(this).find("[data-role='name']").text();if(F=="Content-Type"){jQuery(this).remove();if(D==1){jQuery("#formParams").remove()}}});if(jQuery("[data-role='request-payload-docs']").length&&!jQuery("[data-role='request-payload-example']").length){jQuery("[data-role='request-payload-docs']").show()}jQuery("#working_alert").css("left",jQuery(window).width()/2-56);jQuery("#method_content").show();if(Apigee.APIModel.resourceName!=""&&Apigee.APIModel.expandedSchema[Apigee.APIModel.resourceName]){var C=new Apigee.APIModel.SwaggerModel(Apigee.APIModel.resourceName,Apigee.APIModel.originalExpandedSchema[Apigee.APIModel.resourceName]);var z=C.createJSONSample(false);jQuery("textarea.payload_text").val(JSON.stringify(z,null,4));$bodyParamListNode=jQuery("[data-role='body-param-list']");if($bodyParamListNode.length==0){jQuery("#formParams").hide()}}window.apiModelEditor.initRequestPayloadEditor();Apigee.APIModel.proxyURL=Drupal.settings.smartdocs.proxyUrl;Apigee.APIModel.authUrl=Drupal.settings.smartdocs.authUrl;Apigee.APIModel.initMethodsPageEvents();Apigee.APIModel.initMethodsAuthDialogsEvents();k.getCustomTokenCredentials()};this.renderCallbackURL=function(w){if(window.console){console.log(w.authUrl)}window.open(w.authUrl,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")};this.handleOAuth2Failure=function(){k.showError("Unable to proceed because of missing OAuth configuration.")};this.renderCustomTokenCredentials=function(B){var w=B;var F=w.tokenType;var z=Object.keys(w.tokenMap).length;jQuery("[data-role='custom_token_row']").each(function(G){if(G>0){jQuery(this).remove()}});if(z>=1){for(var C=1,y=z;C<y;C++){jQuery("[data-role='custom_token_row']").first().clone().appendTo("[data-role='custom_token_rows']")}}var D=1;for(var E in w.tokenMap){var A=E;var x=w.tokenMap[E];jQuery("[data-role='custom_token_row']:nth-child("+D+")").find("[data-role='name']").val(A);jQuery("[data-role='custom_token_row']:nth-child("+D+")").find("[data-role='value']").val(x);D++}if(F=="header"){jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked","checked")}else{jQuery("[data-role='custom_token_modal']").find("[data-role='query']").attr("checked","checked")}};this.handleCustomTokenFailure=function(){k.showError("Unable to proceed because of missing Custom token configuration.")};this.updateTemplateParamWidth=function(x,z){var y=x.text();var w=y.length;if(w==0){w=8.4}else{w=Math.ceil(w*8.4)}if(z){x.css("width",w)}else{x.css("width","auto")}};this.updateTemplateParamText=function(x){var y=x.text();var w=y.length;if(w==0){w=8.4;x.html("&nbsp;")}else{w=Math.ceil(w*8.4);if(x.html().indexOf("&nbsp;")!=-1){x.slice(x.html().indexOf("&nbsp;"),x.html().indexOf("&nbsp;")+1)}}};this.updateAuthContainer=function(){if(t.indexOf("No auth")!=-1){jQuery("[data-role='authentication_container']").css({visibility:"hidden"});jQuery(".icon_lock").css({visibility:"hidden"})}else{if(t.indexOf("HTTP Basic")!=-1){if(t.indexOf(",")==-1){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@basicauth";a="basicauth"}var A="";if(localStorage.apisBasicAuthDetails){var w=new Date;var D=w.getMonth()+1+"/"+w.getDate()+"/"+w.getFullYear();var y=localStorage.apisBasicAuthDetails.split("@@@")[3];var E=D;var C=E-y;var C=parseInt(k.dateDiff(new Date(E),new Date(y)));if(C>30){localStorage.removeItem("apisBasicAuthDetails")}else{A=localStorage.apisBasicAuthDetails}}else{if(sessionStorage.apisBasicAuthDetails){A=sessionStorage.apisBasicAuthDetails}}if(A!==""){if(h==A.split("@@@")[0]){j=A.split("@@@")[1];var B=j;if(B.length>12){B=B.substring(0,12)+"..."}jQuery("#inputEmail").val(j);jQuery("#inputPassword").val(jQuery.base64Decode(A.split("@@@")[2].split(" ")[1]).split(":")[1]);e=A.split("@@@")[2];if(sessionStorage.selectedAuthScheme){var x=h==sessionStorage.selectedAuthScheme.split("@@@")[0]&&u==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="basicauth"?"selected":""}if(x!=""){jQuery("[data-role='basic_auth_container']").addClass(x);a="basicauth"}jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(B);jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='basic_auth_container']").show()}if(t.indexOf("OAuth 2.0")!=-1){if(t.indexOf(",")==-1){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@oauth2";a="oauth2"}var F="";if(localStorage.apisOAuth2CredentialsDetails){var w=new Date;var D=w.getMonth()+1+"/"+w.getDate()+"/"+w.getFullYear();var y=localStorage.apisOAuth2CredentialsDetails.split("@@@")[2];var E=D;var C=parseInt(k.dateDiff(new Date(E),new Date(y)));if(C>30){localStorage.removeItem("apisBasicAuthDetails")}else{F=localStorage.apisOAuth2CredentialsDetails}}else{if(sessionStorage.apisOAuth2CredentialsDetails){F=sessionStorage.apisOAuth2CredentialsDetails}}if(F!==""){if(h==F.split("@@@")[0]){i=jQuery.parseJSON(F.split("@@@")[1]);var x=h==F.split("@@@")[0]&&sessionStorage.selectedAuthScheme.split("@@@")[1]=="oauth2"?"selected":"";if(x!=""){jQuery("[data-role='oauth2_container']").addClass(x)}jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Authenticated");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='oauth2_container']").show()}if(t.indexOf("API Key")!=-1){if(t.indexOf(",")==-1){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@customtoken";a="customtoken"}var z=sessionStorage.revisionsCustomTokenCredentialsDetails;if(z){if(h==z.split("@@@")[0]&&u==z.split("@@@")[1]){d=JSON.parse(z.split("@@@")[2]);var x=h==sessionStorage.selectedAuthScheme.split("@@@")[0]&&u==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="customtoken"?"selected":"";if(x!=""){jQuery("[data-role='custom_token_container']").addClass(x)}jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Custom Token");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='custom_token_container']").show()}Apigee.APIModel.initMethodsAuthDialogsEvents()}};this.swapSampleRequestResponseContainer=function(){var w=jQuery(this);if(w.attr("id")=="link_request_tab"){jQuery("#link_response_tab").removeClass("selected");jQuery("#request_response_container .response").hide();jQuery("#link_curl_tab").removeClass("selected");jQuery("#request_response_container .curl").hide();jQuery("#request_response_container .request").show()}else{if(w.attr("id")=="link_response_tab"){jQuery("#link_request_tab").removeClass("selected");jQuery("#request_response_container .request").hide();jQuery("#link_curl_tab").removeClass("selected");jQuery("#request_response_container .curl").hide();jQuery("#request_response_container .response").show()}else{jQuery("#link_request_tab").removeClass("selected");jQuery("#request_response_container .request").hide();jQuery("#link_response_tab").removeClass("selected");jQuery("#request_response_container .response").hide();jQuery("#request_response_container .curl").show()}}w.addClass("selected")};this.saveAuthModal=function(B){var A=jQuery(this).parents(".modal");if(A.attr("data-role")=="basic_auth_modal"){var C=k.validateBasicAuthFields("basic_auth_modal");if(C==""){j=jQuery("#inputEmail").val();e="Basic "+jQuery.base64Encode(j+":"+jQuery("#inputPassword").val());var x=jQuery("[data-role='basic_auth_modal']").find("#chk_remember").is(":checked");if(x){var w=new Date;var z=w.getMonth()+1+"/"+w.getDate()+"/"+w.getFullYear();localStorage.apisBasicAuthDetails=h+"@@@"+j+"@@@"+e+"@@@"+z}else{localStorage.removeItem("apisBasicAuthDetails");sessionStorage.apisBasicAuthDetails=h+"@@@"+j+"@@@"+e}k.closeAuthModal();sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@basicauth";a="basicauth";k.updateAuthContainer()}else{jQuery("[role='dialog'].modal .error_container").html(C+"Please try again.").show()}}else{if(A.attr("data-role")=="oauth2_modal"){var y=window.location.href;y=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName;k.closeAuthModal();k.makeAJAXCall({url:y+"/templateauths/"+secName+"/authUrl",dataType:"json",callback:k.renderCallbackURL,errorCallback:k.handleOAuth2Failure})}else{if(A.attr("data-role")=="custom_token_modal"){d={};d.tokenType=jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked")=="checked"?"header":"query";d.tokenMap={};jQuery("[data-role='custom_token_row']").each(function(){d.tokenMap[jQuery(this).find("[data-role='name']").val()]=jQuery(this).find("[data-role='value']").val()});sessionStorage.revisionsCustomTokenCredentialsDetails=h+"@@@"+u+"@@@"+JSON.stringify(d);k.closeAuthModal();sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@customtoken";a="customtoken";k.updateAuthContainer()}}}};this.getCustomTokenCredentials=function(){if(typeof Apigee.APIModel.apiKey!=="undefined"&&Apigee.APIModel.apiKey!=""){d={};d.tokenType=Apigee.APIModel.location;d.tokenMap={};d.tokenMap[Apigee.APIModel.templateAuthName]=Apigee.APIModel.apiKey;sessionStorage.revisionsCustomTokenCredentialsDetails=h+"@@@"+u+"@@@"+JSON.stringify(d);sessionStorage.selectedAuthScheme=Apigee.APIModel.apiName+"@@@"+Apigee.APIModel.revisionNumber+"@@@customtoken";jQuery("[data-role='custom_token_row']").find("[data-role='name']").val(Apigee.APIModel.templateAuthName.toLowerCase());jQuery("[data-role='custom_token_row']").find("[data-role='value']").val(Apigee.APIModel.apiKey);if(d.tokenType==="query"){jQuery("[data-role='custom_token_modal']").find("[data-role='query']").attr("checked","checked")}if(d.tokenType==="header"){jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked","checked")}k.updateAuthContainer();jQuery(".link_open_customtoken").unbind("click");jQuery(".link_open_customtoken").attr("href","");jQuery(".link_open_customtoken").removeClass("link_open_customtoken");jQuery("i.icon-remove").remove()}};this.toggleRequestPayload=function(A){var w=jQuery(this);if(!w.parent().hasClass("active")){w.parent().siblings().removeClass("active");w.parent().addClass("active");var B=w.attr("data-role");var x=jQuery("[data-role='request-payload-docs']");var z=jQuery("[data-role='request-payload-example']");var y=jQuery("[data-role='request-payload-schema']");if(x.siblings("textarea").length){x.siblings("textarea").hide();x.siblings("a.allow_edit").hide()}if(z.siblings("a.allow_edit").length){z.siblings("a.allow_edit").hide()}if(B=="docs-link"){z.hide();y.hide();x.show()}else{if(B=="schema-link"){y.show();z.hide();x.hide()}else{x.hide();y.hide();z.show()}}}};this.resetFields=function(){jQuery("[data-role='query-param-list'],[data-role='header-param-list'],[data-role='body-param-list']").find("input").each(function(){jQuery(this).val("")});jQuery("[data-role='query-param-list'],[data-role='header-param-list']").each(function(x,y){var z=jQuery(this).find("[data-role='value']");z.val(z.attr("data-original-value"))});if(jQuery('[data-role="request-payload-example"]').length){var w=jQuery('[data-role="request-payload-example"]').children("textarea").val();window.apiModelEditor.setRequestPayLoad(w)}jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .curl").html("<p>Get an equivalent cURL command for the request.</p>").hide();r="";m=false};this.sendRequest=function(){jQuery("#working_alert").fadeIn();jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");var z=jQuery("[data-role='method_url_container'] span.template_param");if(z.length>=1){if(localStorage.hasOwnProperty("templateParams")){var K=JSON.parse(localStorage.getItem("templateParams"));jQuery("[data-role='method_url_container'] span.template_param").each(function(){var aa=jQuery(this).siblings("span").attr("data-role");var ad=jQuery(this).text();if(aa==ad||ad==""||jQuery(this).html()=="&nbsp;"){l=true;v.push(aa.substring(1,aa.length-1));jQuery(this).text(aa);jQuery(this).addClass("error")}var Y=false;for(var Z=0;Z<K.length;Z++){var ab=K[Z].name;var ac=K[Z].value;if(aa==ab){Y=true}if(aa==ab&&ad!=ac&&ad.length){K[Z].value=ad}}if(!Y){K.push({name:aa,value:ad})}});localStorage.setItem("templateParams",JSON.stringify(K))}else{var B=[];jQuery("[data-role='method_url_container'] span.template_param").each(function(){var Y=jQuery(this);B.push({name:Y.siblings("span").attr("data-role"),value:Y.html()})});localStorage.setItem("templateParams",JSON.stringify(B))}}var N=jQuery("[data-role='method_url_container']").text();var Q=jQuery.trim(jQuery("[data-role='verb']:first").text().toLowerCase());var M=[];if(jQuery("[data-role='header-param-list']").length){jQuery("[data-role='header-param-list']").each(function(Z,ab){var Y=jQuery(this).find("[data-role='name']").text();var aa;if(jQuery(this).find("[data-role='multiple-value']").length){aa=jQuery(this).find("select option:selected").val();aa=aa==s?"":aa}else{aa=jQuery(this).find("[data-role='value']").val()}if(Y=="Content-Type"&&jQuery(this).attr("data-scope")=="resource"){if(jQuery.trim(jQuery("[data-role='content-type']").text())==""){M.push({name:Y,value:aa})}}else{M.push({name:Y,value:aa})}if(jQuery(this).find("span.required").length&&jQuery(this).find("[data-role='value']").val()==""){g=true;o.push(Y);jQuery(this).find("[data-role='value']").addClass("error")}})}var w="";if(jQuery("[data-role='query-param-list']").length>=1){var U=true;jQuery("[data-role='query-param-list']").each(function(Y,ad){var ac=jQuery(this).find("[data-role='name']").text();var Z;if(jQuery(this).find("[data-role='multiple-value']").length){Z=jQuery(this).find("select option:selected").val();Z=Z==s?"":Z}else{Z=jQuery(this).find("[data-role='value']").val()}if(jQuery.trim(Z).length>=1){var ab=U?"":"&";try{Z=decodeURIComponent(Z)}catch(aa){}w+=ab+ac+"="+encodeURIComponent(Z);U=false}if(jQuery(this).find("span.required").length&&Z==""){n=true;f.push(ac);jQuery(this).find("[data-role='value']").addClass("error")}})}var T="";var C=jQuery("[data-role='param-groups']");if(C.length){C.each(function(Z,ab){var ae=jQuery(this);var aa=ae.find("[data-role='maxChoice']").length?parseInt(ae.find("[data-role='maxChoice']").text()):ae.find("[data-role='param-group-list']").length;var ac=ae.find("[data-role='minChoice']").length?parseInt(ae.find("[data-role='minChoice']").text()):0;var Y=0;var ad=[];if(ae.find("[data-role='param-group-list']").length){ae.find("[data-role='param-group-list']").each(function(af,aj){var ag=jQuery(this).find("[data-role='name']").text();var ak=jQuery(this).find("[data-role='value']").val();var ai=jQuery(this).find("[data-role='type']").text().toLowerCase();if(jQuery.trim(ak).length>=1){Y++;if(ai=="query"){var ah=jQuery.trim(w).length?"&":"";w+=ah+ag+"="+encodeURIComponent(decodeURIComponent(ak))}else{if(ai=="header"){M.push({name:ag,value:ak})}}}else{ad.push(jQuery.trim(ag))}})}if(ac>Y){T+="Missing "+(aa-Y)+" value for parameter group of: <span>"+ad.join(", ")+"</span></br>"}if(Y>aa){T+="Number of entered parmeters exceeds the maximum number of choices in the parameter group</br>"}})}if(d.tokenType=="query"){var D=w!=""?"&":"";var I=0;for(var X in d.tokenMap){D=I==0?D:"&";var x=X;var W=d.tokenMap[X];if(jQuery.trim(x)!=""&&jQuery.trim(W)!=""){w+=D+x+"="+W;I++}}}else{for(var X in d.tokenMap){var x=X;var W=d.tokenMap[X];if(jQuery.trim(x)!=""&&jQuery.trim(W)!=""){M.push({name:x,value:W})}}}if(isOldMSIE()&&jQuery("[data-role='body-param-list']").length){M.push({name:"Content-Type",value:"application/x-www-form-urlencoded"})}N=N.replace(/\{/g,"").replace(/\}/g,"");N=jQuery.trim(N);w=jQuery.trim(w);if(w!=""){var D="?";if(N.indexOf("?")!=-1){D="&"}N=N+D+w}if(l){T+="Missing value for template parameter(s): <span>"+v.join(", ")+"</span></br>"}if(n){T+="Missing value for required query parameter(s):&nbsp;<span>"+f.join(", ")+"</span></br>"}if(g){T+="Missing value for required header parameter(s):&nbsp;<span>"+o.join(", ")+"</span></br>"}if(T!=""){jQuery("body").scrollTop(0);jQuery("[data-role='error_container']").html(T).show();k.clearMissingArray()}if(a=="basicauth"){if(e){if(localStorage.apisBasicAuthDetails&&h==localStorage.apisBasicAuthDetails.split("@@@")[0]){if(e!=localStorage.apisBasicAuthDetails.split("@@@")[2]){e=localStorage.apisBasicAuthDetails.split("@@@")[2];jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(localStorage.apisBasicAuthDetails.split("@@@")[1])}}M.push({name:"Authorization",value:e})}}else{if(a=="oauth2"){if(a=="oauth2"&&i!=null){if(localStorage.apisOAuth2CredentialsDetails&&h==localStorage.apisOAuth2CredentialsDetails.split("@@@")[0]){var P=jQuery.parseJSON(localStorage.apisOAuth2CredentialsDetails.split("@@@")[1]);if(P.accessToken!=i.accessToken){i=P}}if(i.accessTokenType=="query"){var G=i.accessToeknParamName==""?"oauth_token":i.accessToeknParamName;var D=w==""?"?":"&";N+=D+G+"="+i.accessToken}else{if(i.accessTokenType=="bearer"||i.accessTokenType=="header"){M.push({name:"Authorization",value:"Bearer "+i.accessToken})}}}}}c=N;N=encodeURIComponent(N).replace(/\{.*?\}/g,"");N=Apigee.APIModel.proxyURL+"?targeturl="+N;var O=null;var H=false;if(Q=="put"||Q=="post"||Q=="patch"){var F=jQuery("[data-role='content-type']");if(F.length){H=jQuery.trim(F.html().split(/(<br>|,)/)[0])}if(H===""||H===false){H="application/x-www-form-urlencoded;charset=utf-8"}}var A=true;if(jQuery("[data-role='attachments-list']").length||jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='body-param-list']").length){var E="";if(isOldMSIE()){if(localStorage.getItem("unsupportedAttachmentFlag")==null){k.showUnsupportedAttachmentAlertMessage()}jQuery("#working_alert").fadeOut();return}if(jQuery("[data-role='body-param-list']").length){if(jQuery("#formParams").length){var J=jQuery("#formParams").serialize();if(!jQuery("#formAttachment input[name='root-fields']").length){jQuery("#formAttachment").prepend('<input type="hidden" name="root-fields" value="'+J+'"/>')}else{jQuery("#formAttachment input[name='root-fields']").val(J)}}E="param";if(jQuery('[data-role="request-payload-example"]').length||jQuery("[data-role='attachments-list']").length){E+=jQuery('[data-role="request-payload-example"]').length?"+text":"";E+=jQuery("[data-role='attachments-list']").length?"+attachment":"";N+="&multiparttypes="+E}}else{var L=[];for(var V=0,S=M.length;V<S;V++){if(M[V].name!="Content-Type"){L[L.length]=M[V]}}M=L;if(jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='attachments-list']").length){N+="&multiparttypes=text+attachment"}}if(jQuery('[data-role="request-payload-example"]').length){if(!jQuery("#formAttachment textarea[name='text']").length){if(jQuery("#formAttachment input[name='root-fields']").length){jQuery("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>").insertAfter("#formAttachment input[name='root-fields']")}else{jQuery("#formAttachment").prepend("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>")}}else{jQuery("#formAttachment textarea[name='text']").val(window.apiModelEditor.getRequestPayLoad())}}O=new FormData(jQuery("#formAttachment")[0]);H=false;A=false}else{if(jQuery("[data-role='body-param-list']").length){if(jQuery("#formParams").length){O=jQuery("#formParams").serialize()}else{O=jQuery("#formAttachment").serialize()}}else{if(jQuery('[data-role="request-payload-example"]').length){O=window.apiModelEditor.getRequestPayLoad()}}}var R=[];R.push("-X "+Q.toUpperCase());var y=false;if(M){for(var V=0,S=M.length;V<S;V++){R.push('--header "'+M[V].name+": "+M[V].value+'"');if(M[V].name=="Content-Type"){y=true}}}if(!y){if(H){R.push('--header "Content-Type: '+H+'"')}}if(O&&O.replace){R.push('-d "'+O.replace(/"/g,'\\"')+'"')}else{jQuery("#formAttachment :input").each(function(Y,aa){var ab=jQuery(aa);var Z=ab.val();if(jQuery(aa).attr("type")=="file"){Z="@"+ab[0].files[0].name}R.push('-F "'+ab.attr("name")+"="+Z+'"')})}Apigee.curl="curl "+R.join(" ")+' "'+c+'"';k.makeAJAXCall({url:N,type:Q,data:O,callback:k.renderRequest,headers:M,contentType:H,processData:A})};this.renderRequest=function(O){var C=jQuery("[data-role='response-container']");var A=jQuery("[data-role='request-container']");var z=jQuery("[data-role='curl-container']");if(O==""||O==null){A.html("<strong> An internal error has occurred. Please retry your request.</strong>");C.html("<strong> An internal error has occurred. Please retry your request.</strong>");return}if(typeof O!="object"){O=jQuery.parseJSON(O)}Apigee.lastResponse=O;r=unescape(O.responseContent);var w="<strong";var G;var D;var M;if(O.responseStatusCode){G=O.responseStatusCode;D=O.httpVersion;M=O.responseReasonPhrase}else{G=O.responseCode;D=O.messageVersion;M=O.responsePharse}if(parseInt(G)>=100&&parseInt(G)<400){w+=" class='success'"}w+="> HTTP/"+D+" "+G+"  "+M+"</strong>";w+="<dl>";for(var J=0;J<O.responseHeaders.length;J++){w+="<dt>";w+=decodeURIComponent(O.responseHeaders[J].name);w+=": </dt><dd>";w+=decodeURIComponent(O.responseHeaders[J].value);w+="</dd>"}w+="</dl>";C.html(w);if(r!=""){var K=/^"\{/.test(r)&&/\}"$/.test(r)||/^"\[/.test(r)&&/\]"$/.test(r);if(K){r=r.replace(/^"((.|\s)*)"$/,"$1")}if(r){var F=true;try{var N=jQuery.parseJSON(r)}catch(L){F=false}if(F){var H=k.parseAndReturn(r);r=JSON.stringify(H,null,2);r=r.replace("[{","[\n  {");r=r.replace(/,\n[\n ]*$/,"");r=r.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");C.append("<pre><code class='language-javascript' id='some-code123'>"+r+"</code></pre>")}else{r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");C.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+r+"</code></pre>")}}}var I=c.split("//")[1].split("/")[0].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var y=c.split(I)[1].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var x="<strong>"+O.requestVerb+" "+y+" HTTP/"+D+"</strong>";x+="<dl>";for(var J=0;J<O.requestHeaders.length;J++){var E=O.requestHeaders[J].name;if(E.toLowerCase()!="origin"&&E.toLowerCase()!="referer"){var B=O.requestHeaders[J].value;x+="<dt>";x+=decodeURIComponent(E);x+=": </dt><dd>";x+=decodeURIComponent(B).replace(/</g,"&lt").replace(/>/g,"&gt");x+="</dd>"}}x+="</dl>";A.html(x);z.html("<pre>"+Apigee.curl.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")+"</pre>");m=unescape(O.requestContent);m=m.replace(/[^\x00-\x7F]/g,"###");if(m.indexOf("###")!=-1){m=m.replace(m.substring(m.indexOf("###"),m.lastIndexOf("###")+3),"[BINARY DATA]")}if(m){var F=true;try{N=jQuery.parseJSON(m)}catch(L){F=false}if(F){var H=k.parseAndReturn(m);m=JSON.stringify(H,null,2);m=m.replace("[{","[\n  {");m=m.replace(/,\n[\n ]*$/,"");m=m.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");A.append("<pre class='language-javascript'><code class='language-javascript' id='some-code'>"+m+"</code></pre>")}else{m=m.replace(/>/g,"&gt;").replace(/</g,"&lt;");A.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+m+"</code></pre>")}}if(typeof Prism=="object"){Prism.highlightAll()}};this.clearErrorContainer=function(){k.clearMissingBooleanVariables();k.clearMissingArray();jQuery("[data-role='error_container']").hide().html("")};this.clearMissingBooleanVariables=function(){l=false;g=false;n=false;isRequestBodyMissing=false};this.clearMissingArray=function(){v=[];o=[];f=[];requestBodyMissing=""};this.updateAuthModalFooter=function(x){var w=x=="basic_auth_modal"?"apisBasicAuthDetails":"apisOAuth2CredentialsDetails";if(localStorage.getItem(w)){jQuery("[data-role='"+x+"']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='"+x+"']").find(".modal-footer p input").length){jQuery("[data-role='"+x+"']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='"+x+"']").modal("show")};this.setOAuth2Credentials=function(z){if(z.errorMessage!=""){k.showError(z.errorMessage)}else{i=z;a="oauth2";var x=jQuery("[data-role='oauth2_modal']").find("#chk_remember").is(":checked");if(x){var w=new Date;var y=w.getMonth()+1+"/"+w.getDate()+"/"+w.getFullYear();localStorage.apisOAuth2CredentialsDetails=h+"@@@"+JSON.stringify(i)+"@@@"+y}else{localStorage.removeItem("apisOAuth2CredentialsDetails");sessionStorage.apisOAuth2CredentialsDetails=h+"@@@"+JSON.stringify(i)}sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@oauth2";k.updateAuthContainer()}};this.toggleAuthScheme=function(w){jQuery("[data-role='authentication_container'] .well").removeClass("selected");jQuery(this).addClass("selected");if(jQuery(this).hasClass("basicauth")){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@basicauth";a="basicauth"}else{if(jQuery(this).hasClass("oauth2")){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@oauth2";a="oauth2"}else{if(jQuery(this).hasClass("customtoken")){sessionStorage.selectedAuthScheme=h+"@@@"+u+"@@@customtoken";a="customtoken"}}}};this.clearSessionStorage=function(w){w=typeof w.data=="undefined"?w:w.data;if(w=="oauth2"){sessionStorage.removeItem("apisOAuth2CredentialsDetails");localStorage.removeItem("apisOAuth2CredentialsDetails");i=null;jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Set...").attr("title","Set OAuth 2 credentials.");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","none")}else{if(w=="basicauth"){e="";j="";jQuery("#inputEmail").val("");jQuery("#inputPassword").val("");sessionStorage.removeItem("apisBasicAuthDetails");localStorage.removeItem("apisBasicAuthDetails");jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html("Set...").attr("title","Set basic auth credentials.");jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","none")}else{if(w=="customtoken"){sessionStorage.removeItem("revisionsCustomTokenCredentialsDetails");jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Set...").attr("title","Set custom token credentials.");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","none");p=false;d={};jQuery("[data-role='custom_token_row']").find("[data-role='name']").val("");jQuery("[data-role='custom_token_row']").find("[data-role='value']").val("")}}}sessionStorage.selectedAuthScheme="";a="";authCredentials="";Apigee.APIModel.initMethodsAuthDialogsEvents()}};Apigee.APIModel.Methods.prototype=new Apigee.APIModel.Common;Apigee.APIModel.InlineEdit=function(){var m=this;var a=0;var h;var d=null;var e="";var b=false;var n=false;var c="method";var k=false;function l(){sessionStorage.removeItem("basicAuth1");sessionStorage.removeItem("userEmail1")}function f(t,q){var r;var o;var s="";templateParamAvailable=false;if(t=="general"){r="[data-role='query-param-list'][data-scope='method'], [data-role='header-param-list'][data-scope='method']";if(q=="resource"){r="[data-role='query-param-list'][data-scope='resource'], [data-role='header-param-list'][data-scope='resource']"}var p="[data-scope='method']";if(q=="resource"){p="[data-scope='resource']"}jQuery("[data-role='template-params']").find(p).each(function(u){templateParamAvailable=true;s+='{"name" :"'+jQuery(this).find("[data-role='name']").text()+'",';s+='"description" :"'+jQuery(this).find("[data-role='description']").text()+'",';if(jQuery(this).find("[data-role='required']").length){s+='"required" : '+jQuery(this).find("[data-role='required']").text()+","}if(jQuery(this).find("[data-role='defaultValue']").length){s+='"defaultValue" :"'+jQuery(this).find("[data-role='defaultValue']").text()+'",'}s+='"type" :"TEMPLATE",';s+='"dataType" :"string"}';var v=jQuery("[data-role='template-params']").find(p).length;if(v>u+1){s+=","}})}else{if(t=="body"){r="[data-role='body-param-list'][data-scope='method']";if(q=="resource"){r="[data-role='body-param-list'][data-scope='resource']"}o="BODY"}else{if(t=="attachments"){r="[data-role='attachments-list']"}}}if(templateParamAvailable){s+=","}jQuery(r).each(function(v){var y=jQuery(this);o=t;if(t=="general"){o=y.attr("data-role")=="query-param-list"?"QUERY":"HEADER"}var w=y.children(".title").find("[data-role='required']").text().indexOf("required")!=-1?true:false;var x;var u;if(y.find("div.title input[data-role='value']").length){x=jQuery.trim(y.find("div.title input[data-role='value']").val())}else{x=jQuery.trim(y.find("div.title span[data-role='name']").text())}if(y.find("div.description textarea").length){u=jQuery.trim(y.find("div.description textarea").val())}else{u=jQuery.trim(y.find("[data-role='description']").html());if(d.is(y.find("[data-role='description']"))){u=jQuery.trim(y.find("[data-role='description']").text())}}u=JSON.stringify(u);u=u.substring(1,u.length-1);u=m.escapeSpecialChars(u);s+='{"name" :"'+x+'",';s+='"description" :"'+u+'",';s+='"required" : '+w+",";if(t=="attachments"){s+='"sampleFileUrl" : "'+jQuery.trim(y.find("[data-role='value']").attr("data-sample-file-url"))+'",';s+='"contentDisposition" : "'+jQuery.trim(y.find("[data-role='value']").attr("data-content-disposition"))+'"}'}else{s+='"type" :"'+o+'",';s+='"defaultValue" :"'+y.find("[data-role='value']").val()+'",';s+='"dataType" :"string"}'}var z=jQuery(r).length;if(z>v+1){s+=","}});return s}function j(o){var p=jQuery("[data-role='param-groups'][data-scope='"+o+"']");var q="";if(p.length){p.each(function(r,s){var t=jQuery(this);q+="{";if(t.find("[data-role='maxChoice']").length){q+=' "maxChoice" : '+parseInt(t.find("[data-role='maxChoice']").text())}if(t.find("[data-role='minChoice']").length){q+=t.find("[data-role='maxChoice']").length?",":"";q+='"minChoice" : '+parseInt(t.find("[data-role='minChoice']").text())}q+=', "parameters" : [ ';if(t.find("[data-role='param-group-list']").length){t.find("[data-role='param-group-list']").each(function(v,y){var z=jQuery(this);var w=jQuery.trim(z.find("[data-role='name']").text());var B=jQuery.trim(z.find("[data-role='value']").val());var x=jQuery.trim(z.find("[data-role='type']").text());x=x.toUpperCase();var u;if(z.find("div.description textarea").length){u=jQuery.trim(z.find("div.description textarea").val())}else{u=jQuery.trim(z.find("div.description").text())}u=JSON.stringify(u);u=u.substring(1,u.length-1);u=m.escapeSpecialChars(u);q+='{"name" :"'+w+'",';q+='"defaultValue" :"'+B+'",';q+='"type" :"'+x+'",';q+='"description" :"'+u+'",';q+='"dataType" :"string"}';var A=t.find("[data-role='param-group-list']").length;if(A>v+1){q+=","}});q+="]"}q+="}";if(p.length>r+1){q+=","}})}return q}function i(v,r){var s=jQuery.trim(v.find("[data-role='name']").text());var q="";var u;if(v.attr("data-role")=="query-param-list"){q="QUERY";u=r.parameters}else{if(v.attr("data-role")=="header-param-list"){q="HEADER";u=r.parameters}else{if(v.attr("data-role")=="body-param-list"){q="BODY";if(r.body){u=r.body.parameters}}else{if(v.attr("data-role")=="attachments-list"){q="ATTACHMENT";if(r.body){u=r.body.attachments}}else{if(v.attr("data-role")=="response_errors_list"){q="ERRORS";if(r.response){u=r.response.errors}}}}}}if(u){for(var p=0,o=u.length;p<o;p++){var t=u[p];if(q=="QUERY"||q=="HEADER"){if(t.name==s&&t.type==q){v.find("[data-role='description']").html(t.description)}}else{if(t.name==s){v.find("[data-role='description']").html(t.description)}}}}}function g(){if(localStorage.orgAdminBasicAuthDetails){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='edit_auth_modal']").find(".modal-footer p input").length){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='edit_auth_modal']").modal("show")}this.init=function(o){a=o;if(sessionStorage.orgAdminBasicAuthDetails||localStorage.orgAdminBasicAuthDetails){m.showAdminAuthenticationSection()}else{g()}Apigee.APIModel.initInlineEditAdminAuthEvents()};this.saveAuthModal=function(){var s=m.validateBasicAuthFields("edit_auth_modal");if(s==""){var r=window.location.href;var o="password="+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val());if(Apigee.APIModel.authUrl!="null"){var p=Apigee.APIModel.authUrl.replace("{user}",encodeURIComponent(userEmail));var q=[];q.push({name:"Content-Type",value:"application/x-www-form-urlencoded"});m.makeAJAXCall({url:Apigee.APIModel.proxyURL+"?targeturl="+p,type:"post",dataType:"json",data:o,callback:m.saveAdminCredentials,errorCallback:m.showUnauthorizedInfo,headers:q})}else{m.saveAdminCredentials()}}else{jQuery("[data-role='edit_auth_modal'] .error_container").html(s+"Please try again.").show()}};this.saveAdminCredentials=function(){h="Basic "+jQuery.base64Encode(userEmail+":"+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val()));var p=jQuery("[data-role='edit_auth_modal']").find("#chk_remember").is(":checked");if(p){var o=new Date;var q=o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear();localStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail+"@@@"+q}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail}m.closeAuthModal();m.showAdminAuthenticationSection()};this.showUnauthorizedInfo=function(o){if(o=="401"){jQuery("[data-role='edit_auth_modal'] .error_container").html("Invalid credentials. Please try again.").show()}else{jQuery("[data-role='edit_auth_modal'] .error_container").html("Error saving details. Please try again.").show()}};this.showAdminAuthenticationSection=function(){var u="";if(localStorage.orgAdminBasicAuthDetails){var p=new Date;var r=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear();var q=localStorage.orgAdminBasicAuthDetails.split("@@@")[2];var o=r;var t=parseInt(m.dateDiff(new Date(o),new Date(q)));if(t>30){localStorage.removeItem("orgAdminBasicAuthDetails");g()}else{u=localStorage.orgAdminBasicAuthDetails}}else{if(sessionStorage.orgAdminBasicAuthDetails){u=sessionStorage.orgAdminBasicAuthDetails}}if(u!==""){h=u.split("@@@")[0];var s=u.split("@@@")[1];jQuery(".admin_auth_section a.auth_admin_email").html(s).show();jQuery(".admin_auth_section .icon-remove").css("display","inline-block");jQuery(".admin_auth_section").show().removeClass("hide")}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.removeItem("orgAdminBasicAuthDetails");jQuery(".admin_auth_section a.auth_admin_email").html("").hide();jQuery(".admin_auth_section .icon-remove").hide();jQuery(".admin_auth_section").show().removeClass("hide")}if(!n){m.constructEditMode()}};this.clearAdminAuthDetails=function(){l();jQuery(this).siblings("a.auth_admin_email").html("").hide();jQuery(this).hide()};this.reOpenAdminAuthDetails=function(){n=true;l();g();Apigee.APIModel.initInlineEditAdminAuthEvents()};this.constructEditMode=function(){jQuery("#method_content").addClass("edit_mode");var q='<a class="allow_edit hover"></a><a class="allow_edit ok" title="save and quit."></a><a class="allow_edit cancel" title="reset and quit."></a>';jQuery(".edit_mode .resource_details").parent().addClass("clearfix");jQuery(".edit_mode .resource_details").children("div").addClass("clearfix");jQuery("[data-role='method-title']").parent().append(q).addClass("clearfix");jQuery(".description_container").addClass("clearfix");jQuery("ul.method_table").parent().css({clear:"both"});if(jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list'] ").length){jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(s,t){jQuery(this).find("[data-role='description']").parent().append(q)})}jQuery(".description_container").append('<textarea class="resource_description_edit">'+jQuery("[data-role='method-description']").html()+"</textarea>"+q);var r=jQuery("[data-role='request-payload-docs']");r.wrap("<div class='clearfix'></div>");r.attr("data-allow-edit","true");r.parent().append('<textarea class="request_payload_doc_edit"></textarea>'+q);var p=jQuery("[data-role='request-payload-example']");p.wrap("<div class='clearfix'></div>");p.attr("data-allow-edit","true").width("90%").css({float:"left"});p.parent().append(q);var o=jQuery("[data-role='response-payload-docs']");o.wrap("<div class='clearfix'></div>");o.attr("data-allow-edit","true");o.parent().append('<textarea class="response_payload_doc_edit"></textarea>'+q);Apigee.APIModel.inlineEditPageEvents()};this.handleEditPropertiesMouseOver=function(){var o=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).addClass("edit");jQuery(this).siblings("a.allow_edit.hover").css({display:"inline-block"})}};this.handleEditPropertiesMouseOut=function(){var o=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).removeClass("edit");jQuery(this).siblings("a.allow_edit.hover").hide()}};this.handleEditableElementsClick=function(q){var o=false;if(d){if(jQuery(this).attr("data-role")=="description"&&!d.is(jQuery(this))){o=true}else{o=d.attr("data-role")!=jQuery(this).attr("data-role")}}jQuery("[data-role='error_container']").hide().html("");if(e!=""&&b&&d!=null&&o){var p=jQuery.trim(d.text());if(d.siblings("textarea").length){p=jQuery.trim(d.siblings("textarea").val())}if(e!=p){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}else{if(!d.is(jQuery(this))){m.resetEditableElement()}}}else{d=jQuery(this);if(!k&&jQuery(this).attr("data-role")=="description"){d.text(d.html());k=true}e=jQuery.trim(jQuery(this).text());if(jQuery(this).hasClass("resource_description")||jQuery(this).attr("data-role")=="request-payload-docs"||jQuery(this).attr("data-role")=="response-payload-docs"){e=jQuery.trim(jQuery(this).html());jQuery(this).hide();jQuery(this).siblings("textarea.payload_text").val(jQuery.trim(jQuery(this).html())).height(jQuery(this).height()+30).show();jQuery(this).siblings("textarea").focus();jQuery(this).siblings("textarea").unbind("click").click(function(){return false});Apigee.APIModel.initInlineEditAdminAuthEvents()}if(jQuery(this).attr("data-role")=="method-title"||jQuery(this).attr("data-role")=="description"){jQuery(this).attr("contenteditable","true")}else{jQuery("[data-role='method-title']").removeAttr("contenteditable")}jQuery(this).addClass("editing");jQuery(this).siblings("a.allow_edit.hover").hide();jQuery(this).siblings("a.allow_edit.ok").show();jQuery(this).siblings("a.allow_edit.cancel").show();jQuery(this).addClass("edit");b=true;jQuery(this).focus()}q.preventDefault();return false};this.resetEditableElement=function(){k=false;b=false;d.removeClass("editing");d.siblings("a.allow_edit").hide();d.html(e);if(d.attr("data-role")=="description"){d.html(e)}if(d.attr("data-role")=="method-description"){jQuery("textarea.resource_description_edit").val(e)}d.removeClass("edit").removeClass("editing");if(d.hasClass("resource_description")||d.attr("data-role")=="request-payload-docs"||d.attr("data-role")=="response-payload-docs"){d.siblings("textarea").hide();d.show()}e="";return false};this.documentClickHandler=function(){k=false;if(d){d.removeClass("editing")}var o="";if(d){if(d.hasClass("resource_description")||d.attr("data-role")=="request-payload-docs"||d.attr("data-role")=="response-payload-docs"){o=jQuery.trim(d.siblings("textarea").val())}else{o=jQuery.trim(d.text())}}if(e!=""&&e!=o&&jQuery("body").children("[role='dialog'].modal").is(":visible")==false){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}};this.handleConfirmDialogSave=function(){k=false;d.siblings("a.allow_edit.ok").trigger("click");m.closeAuthModal();Apigee.APIModel.initInlineEditAdminAuthEvents();e="";return false};this.makeAPICall=function(E){var q=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId;b=false;d.removeClass("editing");var A="";if(d.attr("data-role")=="description"&&d.parent().parent().attr("data-scope")=="resource"){c="resource";A+='{"parameters": ['+f("general","resource")+" ]";A+=', "parameterGroups": [ '+j("resource")+" ]}"}else{c="method";q+="/methods/"+Apigee.APIModel.methodId;var o=jQuery.trim(jQuery("textarea.resource_description_edit").val());if(d.attr("data-role")!="method-description"){o=jQuery.trim(jQuery(".resource_description ").html())}var F=jQuery("[data-role='auth-type']").text();F=F.replace("Basic Auth","BASICAUTH").replace("Custom Token","CUSTOM").replace("OAuth 1","OAUTH1WEBSERVER").replace("OAuth 1 Client Credentials","OAUTH1CLIENTCREDENTIALS").replace("OAuth 2","OAUTH2WEBSERVER").replace("OAuth 2 Client Credentials","OAUTH2CLIENTCREDENTIALS").replace("OAuth 2 Implicit Grant Flow","OAUTH2IMPLICITGRANT").replace("No auth","NOAUTH");var y="";if(F.split(",").length>1){y="[";for(var D=0;D<F.split(",").length;D++){y+='"'+F.split(",")[D]+'"';if(D!=F.split(",").length-1){y+=","}}y+="]"}else{y='[ "'+F+'" ]'}var w=jQuery.trim(jQuery("[data-role='category']").text());var z="";if(z.split(",").length>1){z="[";for(var D=0;D<w.split(",").length;D++){z+='"'+w.split(",")[D]+'"';if(D!=w.split(",").length-1){z+=","}}z+="]"}else{z='[ "'+w+'" ]'}o=JSON.stringify(o);o=o.substring(1,o.length-1);o=m.escapeSpecialChars(o);A='{ "displayName":"'+jQuery.trim(jQuery("[data-role='method-title']").html())+'", "description": "'+o+'","verb": "'+jQuery.trim(jQuery("[data-role='verb']").text())+'",';A+='"authSchemes" : '+y+', "tags" : '+z;var t="";if(jQuery.trim(jQuery("[data-role='content-type']").text())!="N.A."){t=jQuery.trim(jQuery("[data-role='content-type']").text())}var u=f("general");if(u.length){if(u.charAt(u.length-1)===","){u=u.substring(0,u.length-1)}A+=', "parameters": ['+u+" ]"}A+=', "parameterGroups": [ '+j("method")+" ]";A+=', "body": {';A+='"parameters": [';A+=f("body");A+=" ]";A+=', "attachments": [';A+=f("attachments");A+=" ]";A+=', "contentType":"'+t+'"';if(jQuery('[data-role="request-payload-example"]').length){var r=JSON.stringify(window.apiModelEditor.getRequestPayLoad());r=r.substring(1,r.length-1);r=m.escapeSpecialChars(r);A+=', "sample" :"'+r+'"'}var x=jQuery("[data-role='request-payload-docs']");var G=jQuery("[data-role='response-payload-docs']");var s="";var B="";if(x.length){var s=jQuery.trim(x.html());if(x.siblings("textarea").is(":visible")==true){s=jQuery.trim(x.siblings("textarea").val())}s=JSON.stringify(s);s=s.substring(1,s.length-1);s=m.escapeSpecialChars(s);s=', "doc": "'+s+'" ';A+=s}A+=" }";var p=jQuery("[data-role='response_errors_list']");if(G.length||p.length){A+=', "response": {';if(G.length){var B=jQuery.trim(G.html());if(G.siblings("textarea").is(":visible")==true){B=jQuery.trim(G.siblings("textarea").val())}B=JSON.stringify(B);B=B.substring(1,B.length-1);B=m.escapeSpecialChars(B);var C=JSON.stringify(jQuery("[data-role='response-payload']").val());C=C.substring(1,C.length-1);C=m.escapeSpecialChars(C);A+='"doc": "'+B+'"  ,"sample" : "'+C+'", "contentType" : "'+jQuery("[data-role='response-content-type']").text()+'"'}if(p.length){var u="";jQuery(p).each(function(I){var H=jQuery(this);u+='{"httpStatusCode" :"'+jQuery.trim(H.find("[data-role='http_status_code']").html())+'",';u+='"code" : "'+jQuery.trim(H.find("[data-role='code']").html())+'",';u+='"description" :"'+jQuery.trim(H.find("[data-role='description']").html())+'"}';var J=jQuery(p).length;if(J>I+1){u+=","}});if(G.length){A+=","}A+='"errors" : ['+u+"]"}A+="}"}A+="}"}var v=[];if(localStorage.orgAdminBasicAuthDetails){if(h!=localStorage.orgAdminBasicAuthDetails.split("@@@")[0]){h=localStorage.orgAdminBasicAuthDetails.split("@@@")[0];jQuery(".admin_auth_section a.auth_admin_email").html(localStorage.orgAdminBasicAuthDetails.split("@@@")[1])}}v.push({name:"Authorization",value:h});v.push({name:"Content-Type",value:"application/json"});jQuery("#working_alert").fadeIn();q=Apigee.APIModel.proxyURL+"?targeturl="+q;m.makeAJAXCall({url:q,type:"put",dataType:"json",headers:v,data:A,callback:m.handleAPICallSuccess,errorCallback:m.handleUpdateFailure});jQuery(this).siblings("[contenteditable='true']").removeClass("edit");jQuery(this).siblings("a.allow_edit.cancel").hide();jQuery(this).siblings("a.allow_edit.ok").hide();if(jQuery(this).siblings("textarea").is(":visible")){jQuery(this).siblings("textarea").hide();jQuery(this).siblings("[data-allow-edit='true']").html(jQuery(this).siblings("textarea").val()).removeClass("edit").removeClass("editing").show()}jQuery(this).hide();E.stopPropagation();return false};this.handleAPICallSuccess=function(q){k=false;q=unescape(q.responseContent);q=JSON.parse(q);e=jQuery.trim(d.html());jQuery("[data-role='method-title']").html(q.displayName);jQuery("[data-role='method-description']").html(q.description);jQuery("[data-role='query-param-list'], [data-role='header-param-list'], [data-role='body-param-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(r){i(jQuery(this),q)});if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var o=window.location.href;var p=o=o.replace("?editMode=1","?flush=1").replace("?editMode=2","?flush=1");m.makeAJAXCall({url:p,callback:m.drupalUpdateSuccess})}e=""};this.drupalUpdateSuccess=function(){};this.handleUpdateFailure=function(){m.resetEditableElement();m.showError("Error saving changes.")}};Apigee.APIModel.InlineEdit.prototype=new Apigee.APIModel.Common;Apigee.APIModel.SwaggerModel=function(a,d){this.name=d.id!=null?d.id:a;this.name=this.name.replace("#/definitions/","");this.properties=[];var b;for(b in d.properties){if(d.required!=null){var c;for(c in d.required){if(b===d.required[c]){d.properties[b].required=true}}}prop=new Apigee.APIModel.SwaggerModelProperty(b,d.properties[b]);this.properties.push(prop)}this.createJSONSample=function(g){if(Apigee.APIModel.sampleModels[this.name]){return Apigee.APIModel.sampleModels[this.name]}else{var e={};g=g||[];if(g.indexOf(this.name)!==-1){return this.name}g.push(this.name);for(var f=0;f<this.properties.length;f++){prop=this.properties[f];e[prop.name]=prop.getSampleValue(g)}Apigee.APIModel.sampleModels[this.name]=e;g.pop(this.name);return e}}};Apigee.APIModel.SwaggerModelProperty=function(a,b){this.name=a;this.dataType=b.type||b.dataType||b["$ref"];if(this.dataType==null){this.dataType=this.name}this.dataType=this.dataType.replace("#/definitions/","");this.isCollection=this.dataType&&(this.dataType.toLowerCase()==="array"||this.dataType.toLowerCase()==="list"||this.dataType.toLowerCase()==="set");this.descr=b.description;this.required=b.required;if(b.items!=null){if(b.items.type!=null){this.refDataType=b.items.type}if(b.items.$ref!=null){this.refDataType=b.items.$ref}if(this.refDataType){this.refDataType=this.refDataType.replace("#/definitions/","")}}this.dataTypeWithRef=this.refDataType!=null?this.dataType+"["+this.refDataType+"]":this.dataType;if(b.allowableValues!=null){this.valueType=b.allowableValues.valueType;this.values=b.allowableValues.values;if(this.values!=null){this.valuesString="'"+this.values.join("' or '")+"'"}}if(b["enum"]!=null){this.valueType="string";this.values=b["enum"];if(this.values!=null){this.valueString="'"+this.values.join("' or '")+"'"}}this.getSampleValue=function(d){d=d||[];var c;if(this.refModel!=null&&d.indexOf(this.refModel.name)===-1){c=this.refModel.createJSONSample(d)}else{if(this.isCollection){c=this.toSampleValue(this.refDataType,d)}else{c=this.toSampleValue(this.dataType,d)}}if(this.isCollection){return[c]}else{return c}};this.toSampleValue=function(e,d){var c;if(e==="integer"){c=0}else{if(e==="boolean"){c=false}else{if(e==="double"||e==="number"){c=0}else{if(e==="string"){c=""}else{if(Apigee.APIModel.originalExpandedSchema[e]){var f=new Apigee.APIModel.SwaggerModel(e,Apigee.APIModel.originalExpandedSchema[e]);c=f.createJSONSample(d)}else{c=e}}}}}return c}};Apigee.APIModel.sampleModels={};Apigee.APIModel.expandedSchema={};Apigee.APIModel.originalExpandedSchema={};Apigee.lastResponse={};Apigee.curl="";