Apigee.APIModel.Common=function(){var j=this;var a;var c='<button aria-hidden="true" data-dismiss="modal" class="close button_close_modal" type="button">x</button>';var b="<h3>Set Authentication</h3>";var d="<h3>Set Organization Admin Credentials</h3>";var f="<h3>Warning</h3>";var g="<h3>Custom Token</h3>";if(typeof apiName!="undefined"){var i="<h3>Request "+apiName+" permissions</h3>"}var k="<p>Your credentials are saved for the session only.</p>";var e='<a class="btn btn-primary button_save_modal" href="javascript:void(0)">Save</a><a class="button_close_modal" href="javascript:void(0)">Cancel</a>';var h=e.replace("Cancel","Discard");validateEmail=function(n){var l=false;if(jQuery.trim(n).length>1){var m=RegExp(/^[a-zA-Z0-9_]{0,1}([a-zA-Z0-9_\.\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~])+([a-zA-Z0-9_\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~]{0,1})+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);if(m.test(n)){if(n.indexOf("..")==-1){l=true}}}return l};navigator.sayswho=function(){var n=navigator.appName,m=navigator.userAgent,l;var o=m.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(o&&(l=m.match(/version\/([\.\d]+)/i))!=null){o[2]=l[1]}o=o?[o[1],o[2]]:[n,navigator.appVersion,"-?"];return o}();showMessage=function(l){theParent=document.getElementsByTagName("body")[0];theKid=document.createElement("div");theKid.setAttribute("style","height:20px;width:100%;background-color:#F9F6C5;text-align:center;position:fixed;z-index:999;");theKid.innerHTML=l;theParent.appendChild(theKid);theParent.insertBefore(theKid,theParent.firstChild)};this.makeAJAXCall=function(r){var u=r.url.toString();var v=document.location.host.toString();if(u.indexOf("targeturl=")!=-1){u=u.split("targeturl=")[0].toString()}if(jQuery.browser.msie&&window.XDomainRequest&&parseInt(jQuery.browser.version)<=9&&u.indexOf(v)==-1){var o=r.url;var t=r.type?r.type:"get";if(o.indexOf("targeturl")!=-1){var m=r.type?r.type:"get";o+="&method="+m;t="POST"}if(r.headers){var w=r.headers;var q="{";for(var s=0,p=w.length;s<p;s++){q+='"'+w[s].name+'" : "'+w[s].value+'"';if(p!=1&&s!=p-1){q+=","}}q+="}";q=encodeURIComponent(q);o+="&headers="+q}var n=r.data?r.data:null;xdr=new XDomainRequest;xdr.onload=function(){var y;var x=true;try{y=jQuery.parseJSON(xdr.responseText)}catch(z){x=false}if(!x){r.callback(xdr.responseText)}else{if(y){var l=y.responseStatusCode;if(l){if(parseInt(l)>=400){if(r.errorCallback){r.errorCallback(l);jQuery("#working_alert").fadeOut();return}else{r.callback(y);jQuery("#working_alert").fadeOut();return}}}r.callback(y)}else{r.callback(xdr.responseText)}}jQuery("#working_alert").fadeOut()};xdr.onerror=function(){if(r.errorCallback){r.errorCallback(xdr.responseText)}else{r.callback(xdr.responseText)}jQuery("#working_alert").fadeOut()};xdr.open(t,o);xdr.send(n)}else{jQuery.ajax({url:r.url,cache:false,type:r.hasOwnProperty("type")?r.type:"get",data:r.hasOwnProperty("data")?r.data:null,contentType:r.hasOwnProperty("contentType")?r.contentType:"application/x-www-form-urlencoded;charset=utf-8",processData:r.hasOwnProperty("processData")?r.processData:true,beforeSend:function(z){if(r.headers){for(var y=0,x=r.headers.length;y<x;y++){var A=r.headers[y];z.setRequestHeader(A.name,A.value)}}},success:function(y,z,x){if(typeof y!="object"){r.callback(x.responseText)}else{if(y){var l=y.responseStatusCode;if(l){if(parseInt(l)>=400){if(r.errorCallback){r.errorCallback(l);return}else{r.callback(y);return}}}r.callback(y)}}},error:function(y,l,x){if(r.errorCallback){r.errorCallback(y.status)}else{r.callback(y.responseText)}},complete:function(){jQuery("#working_alert").fadeOut()}})}};this.closeAuthModal=function(){jQuery('[role="dialog"].modal').modal("hide");jQuery('[role="dialog"].modal input').removeClass("error");jQuery('[role="dialog"].modal .error_container').hide().html("")};this.validateBasicAuthFields=function(m){var n="";userEmail=jQuery.trim(jQuery("[data-role='"+m+"']").find("#inputEmail").val());if(!userEmail.length){jQuery("#inputEmail").addClass("error");n+="<span>Email/Username required.</span><br/>"}var l=jQuery("[data-role='"+m+"']").find("#inputPassword");if(!jQuery.trim(l.val()).length){l.addClass("error");n+="<span>Password required.</span><br/>"}return n};this.shortenText=function(n,l){var m=n.text();if(m.length>l){m=m.substring(0,l-3)+"...";n.text(m)}};this.parseAndReturn=function(l){var n="";try{n=jQuery.parseJSON(l)}catch(m){n=l}return n};this.getQueryParam=function(n,p){var l=n.split("?");if(l.length>2){l=n.split(/\?(.*)/)}if(l.length>1){l=l[1];l=l.split("&");for(var m=0;m<l.length;m++){var o=l[m].split("=");if(o[0]==p){return o[1]}}return""}return""};this.escapeSpecialChars=function(l){return l.replace(/\\n/g,"\\n").replace(/'/g,"'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")};this.showError=function(l){jQuery("[data-role='error_container']").html(l).show();jQuery("body").scrollTop(0)};this.showUnsupportedBrowserAlertMessage=function(){var m=navigator.sayswho.toString();var o=m.split(",")[0].toLowerCase();var l=parseInt(m.split(",")[1]);var n="<p>You are using an unsupported browser. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 9. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedBrowserMessage()'> Close</a> ]</p>";if(o!="chrome"){if(o=="firefox"){if(l<10){showMessage(n)}}if(o=="safari"){if(l<6){showMessage(n)}}if(o=="msie"){if(l<9){showMessage(n)}}}};this.hideUnsupportedBrowserMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedBrowserFlag","true")};this.showUnsupportedAttachementAlertMessage=function(){showMessage("<p>Attachement is not supported in IE9. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 10. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedAttachementMessage()'> Close</a> ]</p>")};this.hideUnsupportedAttachementMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedAttachmentFlag","true")};this.dateDiff=function(m,l){var n=m.getTime()-l.getTime();return n/(24*60*60*1e3)}};Apigee.APIModel.Editor=function(){var a;this.initRequestPayloadEditor=function(){if(jQuery('[data-role="request-payload-example"]').length){jQuery('[data-role="request-payload-example"]').children("textarea").show();bodyPayloadElementValue=jQuery.trim(jQuery('[data-role="request-payload-example"]').find("textarea").val());jQuery(".request_payload textarea").val(bodyPayloadElementValue);bodyPayloadElement=jQuery(".request_payload textarea");if(bodyPayloadElement){var b=bodyPayloadElement.data("format")=="application/xml"?"xml":"javascript";a=CodeMirror.fromTextArea(jQuery(".request_payload textarea").get(0),{mode:b,lineNumbers:true});if(a.lineCount()<=2){a.setSize("100%",a.lineCount()*18)}else{a.setSize("100%",a.lineCount()*15)}}}};this.getRequestPayLoad=function(){return a.getValue()};this.setRequestPayLoad=function(b){a.setValue(b)}};Apigee.APIModel.Methods=function(){var p=this;var j=["January","February","March","April","May","June","July","August","September","October","November","December"];var z;var c;var g="";var o="";var y;var v="";var r;var q=false;var B=[];var k=false;var t=[];var s=false;var h=[];var i;var x;var n={};var e={};var b=false;var l="";var a="";var u=window.location.href;var m=Apigee.APIModel.apiName;var A=Apigee.APIModel.revisionNumber;var d="";var w="-None-";var f=["integer","long","float","double","string","byte","boolean","date","dateTime "];this.init=function(){var J=jQuery("[data-role='auth-type']");y=jQuery.trim(J.text());if(y.split(",").length>1){y=y.substr(0,y.length-1)}y=y.replace("BASICAUTH","Basic Auth").replace("CUSTOM","Custom Token").replace("OAUTH1WEBSERVER","OAuth 1").replace("OAUTH1CLIENTCREDENTIALS","OAuth 1 Client Credentials").replace("OAUTH2WEBSERVER","OAuth 2").replace("OAUTH2CLIENTCREDENTIALS","OAuth 2 Client Credentials").replace("OAUTH2IMPLICITGRANT","OAuth 2 Implicit Grant Flow").replace("NOAUTH","No auth");J.html(y);p.updateAuthContainer();var N="";jQuery("[data-role='method_url_container'] span").each(function(){N+='<span data-role="'+jQuery(this).attr("data-role")+'">'+jQuery(this).html()+"</span>"});jQuery("[data-role='method_url_container']").html(N);c=jQuery("[data-role='method_url_container']");c.html(c.html().replace(/\{/g,"<span data-toggle='tooltip' data-original-title=''><span class='template_param' contenteditable='true'>{").replace(/\}/g,"}</span><span></span></span>"));c.find("span.template_param").each(function(){jQuery(this).siblings("span").attr("data-role",jQuery(this).text())});jQuery("[data-role='template-params']").find("p").each(function(){var P=jQuery(this).find("[data-role='name']").html();var O=jQuery(this).find("[data-role='description']").html();jQuery("[data-toggle='tooltip']").each(function(){var Q=jQuery(this).find("span:eq(1)").data("role");if(Q){Q=Q.substring(1,Q.length-1);if(Q==P){O=jQuery.trim(O);if(O.charAt(O.length-1)!="."){O+="."}jQuery(this).attr("data-original-title",O+" Click to edit the value.")}}})});if(localStorage.hasOwnProperty("templateParams")){var H=JSON.parse(localStorage.getItem("templateParams"));for(var G=0;G<H.length;G++){var I=H[G].name;var E=H[G].value;jQuery("[data-role='method_url_container'] span.template_param").each(function(){var O=jQuery(this).siblings("span");var P=jQuery(this);if(O.attr("data-role")==I){P.text(jQuery.trim(E))}})}}jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='attachments-list']").each(function(O,P){if(!jQuery(this).find("span.required").length&&jQuery(this).find(".value select").length){jQuery(this).find(".value select").prepend("<option value='"+w+"' selected>"+w+"</option>")}var Q=jQuery(this).find("[data-role='value']");Q.attr("data-original-value",jQuery.trim(Q.val()))});var K=jQuery("[data-role='body-param-list']").length;jQuery("[data-role='body-param-list']").each(function(){var O=jQuery(this).find("[data-role='name']").text();if(O=="Content-Type"){jQuery(this).remove();if(K==1){$("#formParams").remove()}}});var C=jQuery("[data-role='category']");var F=jQuery.trim(C.text());if(F.split(",").length>1){F=F.substr(0,F.length-1)}C.html(F);if(jQuery("[data-role='request-payload-docs']").length&&!jQuery("[data-role='request-payload-example']").length){jQuery("[data-role='request-payload-docs']").show()}jQuery("#working_alert").css("left",jQuery(window).width()/2-56);jQuery("#method_content").show();var D;if(jQuery("[data-role='api_scheme']").length){D=jQuery.parseJSON(jQuery("[data-role='api_scheme']").text())}if(D){var M=false;var L=jQuery("[data-role='body-param-list']");L.each(function(){modelName=$(this).attr("data-dataType");if(modelName){var P=true;jQuery.each(f,function(R,S){if(modelName==S){P=false;return}});if(P){M=true;var Q=new Apigee.APIModel.SwaggerModel(modelName,D[modelName]);var O=Q.createJSONSample(false);jQuery('[data-role="request-payload-example"]').find("textarea").val(JSON.stringify(O,null,"\t"));jQuery(this).remove()}}});if(!M){jQuery('[data-role="request-payload-example"]').parent().hide()}L=jQuery("[data-role='body-param-list']");if(L.length==0){jQuery("#formParams").hide()}}window.apiModelEditor.initRequestPayloadEditor();Apigee.APIModel.proxyURL=Drupal.settings.smartdocs.proxyUrl;Apigee.APIModel.authUrl=Drupal.settings.smartdocs.authUrl;Apigee.APIModel.initMethodsPageEvents();Apigee.APIModel.initMethodsAuthDialogsEvents()};this.renderCallbackURL=function(C){if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var E=C.authUrl.split("redirect_uri=")[0];var D=C.authUrl.split("redirect_uri=")[1];D=E+"redirect_uri="+encodeURIComponent(Drupal.settings.smartdocs.oauth2AuthUrl+"?org="+Apigee.APIModel.organizationName+"&api="+Apigee.APIModel.apiName+"&revision="+Apigee.APIModel.revisionNumber)+"&client_id="+D.split("client_id=")[1];window.open(D,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}else{window.open(C.authUrl,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}};this.handleOAuth2Failure=function(){p.showError("Unable to proceed because of missing OAuth configuration.")};this.renderCustomTokenCredentials=function(H){var C=H;var L=C.tokenType;var F=Object.keys(C.tokenMap).length;jQuery("[data-role='custom_token_row']").each(function(M){if(M>0){jQuery(this).remove()}});if(F>=1){for(var I=1,E=F;I<E;I++){jQuery("[data-role='custom_token_row']").first().clone().appendTo("[data-role='custom_token_rows']")}}var J=1;for(var K in C.tokenMap){var G=K;var D=C.tokenMap[K];jQuery("[data-role='custom_token_row']:nth-child("+J+")").find("[data-role='name']").val(G);jQuery("[data-role='custom_token_row']:nth-child("+J+")").find("[data-role='value']").val(D);J++}if(L=="header"){jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked","checked")}else{jQuery("[data-role='custom_token_modal']").find("[data-role='query']").attr("checked","checked")}};this.handleCustomTokenFailure=function(){p.showError("Unable to proceed because of missing Custom token configuration.")};this.updateTemplateParamWidth=function(D,F){var E=D.text();var C=E.length;if(C==0){C=8.4}else{C=Math.ceil(C*8.4)}if(F){D.css("width",C)}else{D.css("width","auto")}};this.updateTemplateParamText=function(D){var E=D.text();var C=E.length;if(C==0){C=8.4;D.html("&nbsp;")}else{C=Math.ceil(C*8.4);if(D.html().indexOf("&nbsp;")!=-1){D.slice(D.html().indexOf("&nbsp;"),D.html().indexOf("&nbsp;")+1)}}};this.updateAuthContainer=function(){if(y.indexOf("No auth")!=-1){jQuery("[data-role='authentication_container']").css({visibility:"hidden"});jQuery(".icon_lock").css({visibility:"hidden"})}else{if(y.indexOf("Basic Auth")!=-1){if(y.indexOf(",")==-1){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@basicauth";a="basicauth"}var G="";if(localStorage.apisBasicAuthDetails){var D=new Date;var J=D.getMonth()+1+"/"+D.getDate()+"/"+D.getFullYear();var F=localStorage.apisBasicAuthDetails.split("@@@")[3];var K=J;var I=K-F;var I=parseInt(p.dateDiff(new Date(K),new Date(F)));if(I>30){localStorage.removeItem("apisBasicAuthDetails")}else{G=localStorage.apisBasicAuthDetails}}else{if(sessionStorage.apisBasicAuthDetails){G=sessionStorage.apisBasicAuthDetails}}if(G!==""){if(m==G.split("@@@")[0]){o=G.split("@@@")[1];var H=o;if(H.length>12){H=H.substring(0,12)+"..."}g=G.split("@@@")[2];if(sessionStorage.selectedAuthScheme){var E=m==sessionStorage.selectedAuthScheme.split("@@@")[0]&&A==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="basicauth"?"selected":""}if(E!=""){jQuery("[data-role='basic_auth_container']").addClass(E)}jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(H);jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='basic_auth_container']").show()}if(y.indexOf("OAuth 2")!=-1){if(y.indexOf(",")==-1){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@oauth2";a="oauth2"}var L="";if(localStorage.apisOAuth2CredentialsDetails){var D=new Date;var J=D.getMonth()+1+"/"+D.getDate()+"/"+D.getFullYear();var F=localStorage.apisOAuth2CredentialsDetails.split("@@@")[2];var K=J;var I=K-F;var I=parseInt(p.dateDiff(new Date(K),new Date(F)));if(I>30){localStorage.removeItem("apisBasicAuthDetails")}else{L=localStorage.apisOAuth2CredentialsDetails}}else{if(sessionStorage.apisOAuth2CredentialsDetails){L=sessionStorage.apisOAuth2CredentialsDetails}}if(L!==""){if(m==L.split("@@@")[0]){n=jQuery.parseJSON(L.split("@@@")[1]);var E=m==L.split("@@@")[0]&&sessionStorage.selectedAuthScheme.split("@@@")[1]=="oauth2"?"selected":"";if(E!=""){jQuery("[data-role='oauth2_container']").addClass(E)}jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Authenticated");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='oauth2_container']").show()}if(y.indexOf("Custom Token")!=-1){if(y.indexOf(",")==-1){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@customtoken";a="customtoken"}var C=sessionStorage.revisionsCustomTokenCredentialsDetails;if(C){if(m==C.split("@@@")[0]&&A==C.split("@@@")[1]){e=JSON.parse(C.split("@@@")[2]);var E=m==sessionStorage.selectedAuthScheme.split("@@@")[0]&&A==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="customtoken"?"selected":"";if(E!=""){jQuery("[data-role='custom_token_container']").addClass(E)}jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Custom Token");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='custom_token_container']").show()}Apigee.APIModel.initMethodsAuthDialogsEvents()}};this.swapSampleRequestResponseContainer=function(){var C=jQuery(this);if(C.attr("id")=="link_request_tab"){jQuery("#link_response_tab").removeClass("selected");jQuery("#request_response_container .response").hide();jQuery("#request_response_container .request").show()}else{jQuery("#link_request_tab").removeClass("selected");jQuery("#request_response_container .request").hide();jQuery("#request_response_container .response").show()}C.addClass("selected")};this.saveAuthModal=function(H){var G=jQuery(this).parents(".modal");if(G.attr("data-role")=="basic_auth_modal"){var I=p.validateBasicAuthFields("basic_auth_modal");if(I==""){o=jQuery("#inputEmail").val();g="Basic "+jQuery.base64Encode(o+":"+jQuery("#inputPassword").val());var D=jQuery("[data-role='basic_auth_modal']").find("#chk_remember").is(":checked");if(D){var C=new Date;var F=C.getMonth()+1+"/"+C.getDate()+"/"+C.getFullYear();localStorage.apisBasicAuthDetails=m+"@@@"+o+"@@@"+g+"@@@"+F}else{localStorage.removeItem("apisBasicAuthDetails");sessionStorage.apisBasicAuthDetails=m+"@@@"+o+"@@@"+g}p.closeAuthModal();sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@basicauth";a="basicauth";p.updateAuthContainer()}else{jQuery("[role='dialog'].modal .error_container").html(I+"Please try again.").show()}}else{if(G.attr("data-role")=="oauth2_modal"){var E=window.location.href;E=u.split("/resources/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){E=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}if(Apigee.APIModel.apiModelBaseUrl){E=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}p.closeAuthModal();p.makeAJAXCall({url:E+"/authschemes/oauth2webserverflow/authUrl",dataType:"json",callback:p.renderCallbackURL,errorCallback:p.handleOAuth2Failure})}else{if(G.attr("data-role")=="custom_token_modal"){e={};e.tokenType=jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked")=="checked"?"header":"query";e.tokenMap={};jQuery("[data-role='custom_token_row']").each(function(){e.tokenMap[jQuery(this).find("[data-role='name']").val()]=jQuery(this).find("[data-role='value']").val()});sessionStorage.revisionsCustomTokenCredentialsDetails=m+"@@@"+A+"@@@"+JSON.stringify(e);p.closeAuthModal();sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@customtoken";a="customtoken";p.updateAuthContainer()}}}};this.getCustomTokenCredentials=function(){if(!b){u=u.split("/resources/")[0];p.makeAJAXCall({url:u+"/authschemes/custom",dataType:"json",callback:p.renderCustomTokenCredentials,errorCallback:p.handleCustomTokenFailure});b=true}};this.toggleRequestPayload=function(F){var C=jQuery(this);if(!C.parent().hasClass("active")){C.parent().siblings().removeClass("active");C.parent().addClass("active");var G=C.attr("data-role");var D=jQuery("[data-role='request-payload-docs']");var E=jQuery("[data-role='request-payload-example']");if(D.siblings("textarea").length){D.siblings("textarea").hide();D.siblings("a.allow_edit").hide()}if(E.siblings("a.allow_edit").length){E.siblings("a.allow_edit").hide()}if(G=="docs-link"){E.hide();D.show()}else{D.hide();E.show()}}};this.resetFields=function(){jQuery("[data-role='query-param-list'],[data-role='header-param-list'],[data-role='body-param-list']").find("input").each(function(){jQuery(this).val("")});jQuery("[data-role='query-param-list'],[data-role='header-param-list']").each(function(D,E){var F=jQuery(this).find("[data-role='value']");F.val(F.attr("data-original-value"))});if(jQuery('[data-role="request-payload-example"]').length){var C=jQuery('[data-role="request-payload-example"]').children("textarea").val();window.apiModelEditor.setRequestPayLoad(C)}jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");v="";r=false};this.sendRequest=function(){jQuery("#working_alert").fadeIn();jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");var E=jQuery("[data-role='method_url_container'] span.template_param");if(E.length>=1){if(localStorage.hasOwnProperty("templateParams")){var O=JSON.parse(localStorage.getItem("templateParams"));jQuery("[data-role='method_url_container'] span.template_param").each(function(){var ac=jQuery(this).siblings("span").attr("data-role");var af=jQuery(this).text();if(ac==af||af==""||jQuery(this).html()=="&nbsp;"){q=true;B.push(ac.substring(1,ac.length-1));jQuery(this).text(ac);jQuery(this).addClass("error")}var aa=false;for(var ab=0;ab<O.length;ab++){var ad=O[ab].name;var ae=O[ab].value;if(ac==ad){aa=true}if(ac==ad&&af!=ae&&af.length){O[ab].value=af}}if(!aa){O.push({name:ac,value:af})}});localStorage.setItem("templateParams",JSON.stringify(O))}else{var G=[];jQuery("[data-role='method_url_container'] input").each(function(){var aa=jQuery(this).siblings("span");G.push({name:aa.attr("data-role"),value:aa.html()})});localStorage.setItem("templateParams",JSON.stringify(G))}}var Q=jQuery("[data-role='method_url_container']").text();var T=jQuery.trim(jQuery("[data-role='verb']").text().toLowerCase());var P=[];if(jQuery("[data-role='header-param-list']").length){jQuery("[data-role='header-param-list']").each(function(ab,ad){var aa=jQuery(this).find("[data-role='name']").text();var ac;if(jQuery(this).find("[data-role='multiple-value']").length){ac=jQuery(this).find("select option:selected").val();ac=ac==w?"":ac}else{ac=jQuery(this).find("[data-role='value']").val()}if(aa=="Content-Type"&&jQuery(this).attr("data-scope")=="resource"){if(jQuery.trim(jQuery("[data-role='content-type']").text())==""){P.push({name:aa,value:ac})}}else{P.push({name:aa,value:ac})}if(jQuery(this).find("span.required").length&&jQuery(this).find("[data-role='value']").val()==""){k=true;t.push(aa);jQuery(this).find("[data-role='value']").addClass("error")}})}var C="";if(jQuery("[data-role='query-param-list']").length>=1){var W=true;jQuery("[data-role='query-param-list']").each(function(aa,ae){var ad=jQuery(this).find("[data-role='name']").text();var ab;if(jQuery(this).find("[data-role='multiple-value']").length){ab=jQuery(this).find("select option:selected").val();ab=ab==w?"":ab}else{ab=jQuery(this).find("[data-role='value']").val()}if(jQuery.trim(ab).length>=1){var ac=W?"":"&";C+=ac+ad+"="+encodeURIComponent(decodeURIComponent(ab));W=false}if(jQuery(this).find("span.required").length&&ab==""){s=true;h.push(ad);jQuery(this).find("[data-role='value']").addClass("error")}})}var V="";var H=jQuery("[data-role='param-groups']");if(H.length){H.each(function(ab,ad){var ag=jQuery(this);var ac=ag.find("[data-role='maxChoice']").length?parseInt(ag.find("[data-role='maxChoice']").text()):ag.find("[data-role='param-group-list']").length;var ae=ag.find("[data-role='minChoice']").length?parseInt(ag.find("[data-role='minChoice']").text()):0;var aa=0;var af=[];if(ag.find("[data-role='param-group-list']").length){ag.find("[data-role='param-group-list']").each(function(ah,al){var ai=jQuery(this).find("[data-role='name']").text();var am=jQuery(this).find("[data-role='value']").val();var ak=jQuery(this).find("[data-role='type']").text().toLowerCase();if(jQuery.trim(am).length>=1){aa++;if(ak=="query"){var aj=jQuery.trim(C).length?"&":"";C+=aj+ai+"="+encodeURIComponent(decodeURIComponent(am))}else{if(ak=="header"){P.push({name:ai,value:am})}}}else{af.push(jQuery.trim(ai))}})}if(ae>aa){V+="Missing "+(ac-aa)+" value for parameter group of: <span>"+af.join(", ")+"</span></br>"}if(aa>ac){V+="Number of entered parmeters exceeds the maximum number of choices in the parameter group</br>"}})}if(e.tokenType=="query"){var I=C!=""?"&":"";var M=0;for(var Z in e.tokenMap){I=M==0?I:"&";var D=Z;var Y=e.tokenMap[Z];if(jQuery.trim(D)!=""&&jQuery.trim(Y)!=""){C+=I+D+"="+Y;M++}}}else{for(var Z in e.tokenMap){var D=Z;var Y=e.tokenMap[Z];if(jQuery.trim(D)!=""&&jQuery.trim(Y)!=""){P.push({name:D,value:Y})}}}if(jQuery.browser.msie&&parseInt(jQuery.browser.version)<=9&&jQuery("[data-role='body-param-list']").length){P.push({name:"Content-Type",value:"application/x-www-form-urlencoded"})}Q=Q.replace(/\{/g,"").replace(/\}/g,"");Q=jQuery.trim(Q);C=jQuery.trim(C);if(C!=""){var I="?";if(Q.indexOf("?")!=-1){I="&"}Q=Q+I+C}if(q){V+="Missing value for template parameter(s): <span>"+B.join(", ")+"</span></br>"}if(s){V+="Missing value for required query parameter(s):&nbsp;<span>"+h.join(", ")+"</span></br>"}if(k){V+="Missing value for required header parameter(s):&nbsp;<span>"+t.join(", ")+"</span></br>"}if(V!=""){jQuery("body").scrollTop(0);jQuery("[data-role='error_container']").html(V).show();p.clearMissingArray()}if(a=="basicauth"){if(g){if(localStorage.apisBasicAuthDetails&&m==localStorage.apisBasicAuthDetails.split("@@@")[0]){if(g!=localStorage.apisBasicAuthDetails.split("@@@")[2]){g=localStorage.apisBasicAuthDetails.split("@@@")[2];jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(localStorage.apisBasicAuthDetails.split("@@@")[1])}}P.push({name:"Authorization",value:g})}}else{if(a=="oauth2"&&n!=null){if(localStorage.apisOAuth2CredentialsDetails&&m==localStorage.apisOAuth2CredentialsDetails.split("@@@")[0]){var S=jQuery.parseJSON(localStorage.apisOAuth2CredentialsDetails.split("@@@")[1]);if(S.accessToken!=n.accessToken){n=S}}if(n.accessTokenType=="query"){var K=n.accessToeknParamName==""?"oauth_token":n.accessToeknParamName;var I=C==""?"?":"&";Q+=I+K+"="+n.accessToken}else{if(n.accessTokenType=="bearer"){P.push({name:"Authorization",value:"Bearer "+n.accessToken})}}}}d=Q;Q=encodeURIComponent(Q).replace(/\{.*?\}/g,"");Q=Apigee.APIModel.proxyURL+"?targeturl="+Q;var R=null;var L="application/x-www-form-urlencoded;charset=utf-8";if(jQuery.trim(jQuery("[data-role='content-type']").text())!=""){L=jQuery.trim(jQuery("[data-role='content-type']").text())}var F=true;if(jQuery("[data-role='attachments-list']").length||jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='body-param-list']").length){var J="";if(jQuery.browser.msie&&parseInt(jQuery.browser.version)<=9){if(localStorage.getItem("unsupportedAttachmentFlag")==null){p.showUnsupportedAttachementAlertMessage()}jQuery("#working_alert").fadeOut();return}if(jQuery("[data-role='body-param-list']").length){if(jQuery("#formParams").length){var N=jQuery("#formParams").serialize();if(!jQuery("#formAttachment input[name='root-fields']").length){jQuery("#formAttachment").prepend('<input type="hidden" name="root-fields" value="'+N+'"/>')}else{jQuery("#formAttachment input[name='root-fields']").val(N)}}J="param";if(jQuery('[data-role="request-payload-example"]').length||jQuery("[data-role='attachments-list']").length){J+=jQuery('[data-role="request-payload-example"]').length?"+text":"";J+=jQuery("[data-role='attachments-list']").length?"+attachment":"";Q+="&multiparttypes="+J}}else{for(var X=0,U=P.length;X<U;X++){if(P[X].name=="Content-Type"){P.splice(X,1)}}if(jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='attachments-list']").length){Q+="&multiparttypes=text+attachment"}}if(jQuery('[data-role="request-payload-example"]').length){if(!jQuery("#formAttachment textarea[name='text']").length){if(jQuery("#formAttachment input[name='root-fields']").length){jQuery("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>").insertAfter("#formAttachment input[name='root-fields']")}else{jQuery("#formAttachment").prepend("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>")}}else{jQuery("#formAttachment textarea[name='text']").val(window.apiModelEditor.getRequestPayLoad())}}R=new FormData(jQuery("#formAttachment")[0]);L=false;F=false}else{if(jQuery("[data-role='body-param-list']").length){if(jQuery("#formParams").length){R=jQuery("#formParams").serialize()}else{R=jQuery("#formAttachment").serialize()}}else{if(jQuery('[data-role="request-payload-example"]').length){R=window.apiModelEditor.getRequestPayLoad()}}}p.makeAJAXCall({url:Q,type:T,data:R,callback:p.renderRequest,headers:P,contentType:L,processData:F})};this.renderRequest=function(T){var H=jQuery("[data-role='response-container']");var F=jQuery("[data-role='request-container']");if(T==""||T==null){F.html("<strong> An internal error has occurred. Please retry your request.</strong>");H.html("<strong> An internal error has occurred. Please retry your request.</strong>");return}if(typeof T!="object"){T=jQuery.parseJSON(T)}v=unescape(T.responseContent);var C="<strong";var L;var I;var R;if(T.responseStatusCode){L=T.responseStatusCode;I=T.httpVersion;R=T.responseReasonPhrase}else{L=T.responseCode;I=T.messageVersion;R=T.responsePharse}if(parseInt(L)>=100&&parseInt(L)<400){C+=" class='success'"}C+="> HTTP/"+I+" "+L+"  "+R+"</strong>";C+="<dl>";for(var O=0;O<T.responseHeaders.length;O++){C+="<dt>";C+=unescape(T.responseHeaders[O].name);C+=": </dt><dd>";C+=unescape(T.responseHeaders[O].value);C+="</dd>"}C+="</dl>";H.html(C);if(v!=""){var P=/^"\{/.test(v)&&/\}"$/.test(v)||/^"\[/.test(v)&&/\]"$/.test(v);if(P){v=v.replace(/^"((.|\s)*)"$/,"$1")}if(v){var K=true;try{var S=jQuery.parseJSON(v)}catch(Q){K=false}if(K){var M=p.parseAndReturn(v);v=JSON.stringify(M,null,2);v=v.replace("[{","[\n  {");v=v.replace(/,\n[\n ]*$/,"");v=v.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");H.append("<pre><code class='language-javascript' id='some-code123'>"+v+"</code></pre>")}else{v=v.replace(/>/g,"&gt;").replace(/</g,"&lt;");H.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+v+"</code></pre>")}}}var N=d.split("//")[1].split("/")[0].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var E=d.split(N)[1].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var D="<strong>"+T.requestVerb+" "+E+" HTTP/"+I+"</strong>";D+="<dl>";for(var O=0;O<T.requestHeaders.length;O++){var J=T.requestHeaders[O].name;if(J.toLowerCase()!="origin"&&J.toLowerCase()!="referer"){var G=T.requestHeaders[O].value;D+="<dt>";D+=unescape(J);D+=": </dt><dd>";D+=unescape(G).replace(/</g,"&lt").replace(/>/g,"&gt");D+="</dd>"}}D+="</dl>";F.html(D);r=unescape(T.requestContent);r=r.replace(/[^\x00-\x7F]/g,"###");if(r.indexOf("###")!=-1){r=r.replace(r.substring(r.indexOf("###"),r.lastIndexOf("###")+3),"[BINARY DATA]")}if(r){var K=true;try{S=jQuery.parseJSON(r)}catch(Q){K=false}if(K){var M=p.parseAndReturn(r);r=JSON.stringify(M,null,2);r=r.replace("[{","[\n  {");r=r.replace(/,\n[\n ]*$/,"");r=r.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");F.append("<pre class='language-javascript'><code class='language-javascript' id='some-code'>"+r+"</code></pre>")}else{r=r.replace(/>/g,"&gt;").replace(/</g,"&lt;");F.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+r+"</code></pre>")}}if(typeof Prism=="object"){Prism.highlightAll()}};this.clearErrorContainer=function(){p.clearMissingBooleanVariables();p.clearMissingArray();jQuery("[data-role='error_container']").hide().html("")};this.clearMissingBooleanVariables=function(){q=false;k=false;s=false;isRequestBodyMissing=false};this.clearMissingArray=function(){B=[];t=[];h=[];requestBodyMissing=""};this.updateAuthModalFooter=function(D){var C=D=="basic_auth_modal"?"apisBasicAuthDetails":"apisOAuth2CredentialsDetails";if(localStorage.getItem(C)){jQuery("[data-role='"+D+"']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='"+D+"']").find(".modal-footer p input").length){jQuery("[data-role='"+D+"']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='"+D+"']").modal("show")};this.setOAuth2Credentials=function(F){if(F.errorMessage!=""){p.showError(F.errorMessage)}else{n=F;a="oauth2";var D=jQuery("[data-role='oauth2_modal']").find("#chk_remember").is(":checked");if(D){var C=new Date;var E=C.getMonth()+1+"/"+C.getDate()+"/"+C.getFullYear();localStorage.apisOAuth2CredentialsDetails=m+"@@@"+JSON.stringify(n)+"@@@"+E}else{localStorage.removeItem("apisOAuth2CredentialsDetails");sessionStorage.apisOAuth2CredentialsDetails=m+"@@@"+JSON.stringify(n)}sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@oauth2";p.updateAuthContainer()}};this.toggleAuthScheme=function(C){jQuery("[data-role='authentication_container'] .well").removeClass("selected");jQuery(this).addClass("selected");if(jQuery(this).hasClass("basicauth")){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@basicauth";a="basicauth"}else{if(jQuery(this).hasClass("oauth2")){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@oauth2";a="oauth2"}else{if(jQuery(this).hasClass("customtoken")){sessionStorage.selectedAuthScheme=m+"@@@"+A+"@@@customtoken";a="customtoken"}}}};this.clearSessionStorage=function(C){C=typeof C.data=="undefined"?C:C.data;if(C=="oauth2"){sessionStorage.removeItem("apisOAuth2CredentialsDetails");localStorage.removeItem("apisOAuth2CredentialsDetails");n=null;jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Set...").attr("title","Set OAuth 2 credentials.");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","none")}else{if(C=="basicauth"){g="";o="";sessionStorage.removeItem("apisBasicAuthDetails");localStorage.removeItem("apisBasicAuthDetails");jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html("Set...").attr("title","Set basic auth credentials.");jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","none")}else{if(C=="customtoken"){sessionStorage.removeItem("revisionsCustomTokenCredentialsDetails");jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Set...").attr("title","Set custom token credentials.");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","none");b=false}}}Apigee.APIModel.initMethodsAuthDialogsEvents()}};Apigee.APIModel.Methods.prototype=new Apigee.APIModel.Common;Apigee.APIModel.InlineEdit=function(){var n=this;var a=0;var h;var d=window.location.href;var c=null;var m="";var b=false;var o=false;var e="method";var k=false;function l(){sessionStorage.removeItem("basicAuth1");sessionStorage.removeItem("userEmail1")}function f(u,r){var s;var p;var t="";templateParamAvailable=false;if(u=="general"){s="[data-role='query-param-list'][data-scope='method'], [data-role='header-param-list'][data-scope='method']";if(r=="resource"){s="[data-role='query-param-list'][data-scope='resource'], [data-role='header-param-list'][data-scope='resource']"}var q="[data-scope='method']";if(r=="resource"){q="[data-scope='resource']"}jQuery("[data-role='template-params']").find(q).each(function(v){templateParamAvailable=true;t+='{"name" :"'+jQuery(this).find("[data-role='name']").text()+'",';t+='"description" :"'+jQuery(this).find("[data-role='description']").text()+'",';if(jQuery(this).find("[data-role='required']").length){t+='"required" : '+jQuery(this).find("[data-role='required']").text()+","}if(jQuery(this).find("[data-role='defaultValue']").length){t+='"defaultValue" :"'+jQuery(this).find("[data-role='defaultValue']").text()+'",'}t+='"type" :"TEMPLATE",';t+='"dataType" :"string"}';var w=jQuery("[data-role='template-params']").find(q).length;if(w>v+1){t+=","}})}else{if(u=="body"){s="[data-role='body-param-list'][data-scope='method']";if(r=="resource"){s="[data-role='body-param-list'][data-scope='resource']"}p="BODY"}else{if(u=="attachments"){s="[data-role='attachments-list']"}}}if(templateParamAvailable){t+=","}jQuery(s).each(function(w){var z=jQuery(this);p=u;if(u=="general"){p=z.attr("data-role")=="query-param-list"?"QUERY":"HEADER"}var x=z.children(".title").find("[data-role='required']").text().indexOf("required")!=-1?true:false;var y;var v;if(z.find("div.title input[data-role='value']").length){y=jQuery.trim(z.find("div.title input[data-role='value']").val())}else{y=jQuery.trim(z.find("div.title span[data-role='name']").text())}if(z.find("div.description textarea").length){v=jQuery.trim(z.find("div.description textarea").val())}else{v=jQuery.trim(z.find("[data-role='description']").html());if(c.is(z.find("[data-role='description']"))){v=jQuery.trim(z.find("[data-role='description']").text())}}v=JSON.stringify(v);v=v.substring(1,v.length-1);v=n.escapeSpecialChars(v);t+='{"name" :"'+y+'",';t+='"description" :"'+v+'",';t+='"required" : '+x+",";if(u=="attachments"){t+='"sampleFileUrl" : "'+jQuery.trim(z.find("[data-role='value']").attr("data-sample-file-url"))+'",';t+='"contentDisposition" : "'+jQuery.trim(z.find("[data-role='value']").attr("data-content-disposition"))+'"}'}else{t+='"type" :"'+p+'",';t+='"defaultValue" :"'+z.find("[data-role='value']").val()+'",';t+='"dataType" :"string"}'}var A=jQuery(s).length;if(A>w+1){t+=","}});return t}function j(p){var q=jQuery("[data-role='param-groups'][data-scope='"+p+"']");var r="";if(q.length){q.each(function(s,t){var u=jQuery(this);r+="{";if(u.find("[data-role='maxChoice']").length){r+=' "maxChoice" : '+parseInt(u.find("[data-role='maxChoice']").text())}if(u.find("[data-role='minChoice']").length){r+=u.find("[data-role='maxChoice']").length?",":"";r+='"minChoice" : '+parseInt(u.find("[data-role='minChoice']").text())}r+=', "parameters" : [ ';if(u.find("[data-role='param-group-list']").length){u.find("[data-role='param-group-list']").each(function(w,z){var A=jQuery(this);var x=jQuery.trim(A.find("[data-role='name']").text());var C=jQuery.trim(A.find("[data-role='value']").val());var y=jQuery.trim(A.find("[data-role='type']").text());y=y.toUpperCase();var v;if(A.find("div.description textarea").length){v=jQuery.trim(A.find("div.description textarea").val())}else{v=jQuery.trim(A.find("div.description").text())}v=JSON.stringify(v);v=v.substring(1,v.length-1);v=n.escapeSpecialChars(v);r+='{"name" :"'+x+'",';r+='"defaultValue" :"'+C+'",';r+='"type" :"'+y+'",';r+='"description" :"'+v+'",';r+='"dataType" :"string"}';var B=u.find("[data-role='param-group-list']").length;if(B>w+1){r+=","}});r+="]"}r+="}";if(q.length>s+1){r+=","}})}return r}function i(w,s){var t=jQuery.trim(w.find("[data-role='name']").text());var r="";var v;if(w.attr("data-role")=="query-param-list"){r="QUERY";v=s.parameters}else{if(w.attr("data-role")=="header-param-list"){r="HEADER";v=s.parameters}else{if(w.attr("data-role")=="body-param-list"){r="BODY";if(s.body){v=s.body.parameters}}else{if(w.attr("data-role")=="attachments-list"){r="ATTACHMENT";if(s.body){v=s.body.attachments}}else{if(w.attr("data-role")=="response_errors_list"){r="ERRORS";if(s.response){v=s.response.errors}}}}}}if(v){for(var q=0,p=v.length;q<p;q++){var u=v[q];if(r=="QUERY"||r=="HEADER"){if(u.name==t&&u.type==r){w.find("[data-role='description']").html(u.description)}}else{if(u.name==t){w.find("[data-role='description']").html(u.description)}}}}}function g(){if(localStorage.orgAdminBasicAuthDetails){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='edit_auth_modal']").find(".modal-footer p input").length){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='edit_auth_modal']").modal("show")}this.init=function(p){a=p;if(sessionStorage.orgAdminBasicAuthDetails||localStorage.orgAdminBasicAuthDetails){n.showAdminAuthenticationSection()}else{g()}Apigee.APIModel.initInlineEditAdminAuthEvents()};this.saveAuthModal=function(){var t=n.validateBasicAuthFields("edit_auth_modal");if(t==""){var s=window.location.href;var p="password="+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val());if(Apigee.APIModel.authUrl!="null"){var q=Apigee.APIModel.authUrl.replace("{user}",encodeURIComponent(userEmail));var r=[];r.push({name:"Content-Type",value:"application/x-www-form-urlencoded"});n.makeAJAXCall({url:Apigee.APIModel.proxyURL+"?targeturl="+q,type:"post",dataType:"json",data:p,callback:n.saveAdminCredentials,errorCallback:n.showUnauthorizedInfo,headers:r})}else{n.saveAdminCredentials()}}else{jQuery("[data-role='edit_auth_modal'] .error_container").html(t+"Please try again.").show()}};this.saveAdminCredentials=function(){h="Basic "+jQuery.base64Encode(userEmail+":"+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val()));var q=jQuery("[data-role='edit_auth_modal']").find("#chk_remember").is(":checked");if(q){var p=new Date;var r=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear();localStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail+"@@@"+r}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail}n.closeAuthModal();n.showAdminAuthenticationSection()};this.showUnauthorizedInfo=function(p){if(p=="401"){jQuery("[data-role='edit_auth_modal'] .error_container").html("Invalid credentials. Please try again.").show()}else{jQuery("[data-role='edit_auth_modal'] .error_container").html("Error saving details. Please try again.").show()}};this.showAdminAuthenticationSection=function(){var v="";if(localStorage.orgAdminBasicAuthDetails){var q=new Date;var s=q.getMonth()+1+"/"+q.getDate()+"/"+q.getFullYear();var r=localStorage.orgAdminBasicAuthDetails.split("@@@")[2];var p=s;var u=parseInt(n.dateDiff(new Date(p),new Date(r)));if(u>30){localStorage.removeItem("orgAdminBasicAuthDetails");g()}else{v=localStorage.orgAdminBasicAuthDetails}}else{if(sessionStorage.orgAdminBasicAuthDetails){v=sessionStorage.orgAdminBasicAuthDetails}}if(v!==""){h=v.split("@@@")[0];var t=v.split("@@@")[1];jQuery(".admin_auth_section a.auth_admin_email").html(t).show();jQuery(".admin_auth_section .icon-remove").css("display","inline-block");jQuery(".admin_auth_section").show().removeClass("hide")}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.removeItem("orgAdminBasicAuthDetails");jQuery(".admin_auth_section a.auth_admin_email").html("").hide();jQuery(".admin_auth_section .icon-remove").hide();jQuery(".admin_auth_section").show().removeClass("hide")}if(!o){n.constructEditMode()}};this.clearAdminAuthDetails=function(){l();jQuery(this).siblings("a.auth_admin_email").html("").hide();jQuery(this).hide()};this.reOpenAdminAuthDetails=function(){o=true;l();g();Apigee.APIModel.initInlineEditAdminAuthEvents()};this.constructEditMode=function(){jQuery("#method_content").addClass("edit_mode");var r='<a class="allow_edit hover"></a><a class="allow_edit ok" title="save and quit."></a><a class="allow_edit cancel" title="reset and quit."></a>';jQuery(".edit_mode .resource_details").parent().addClass("clearfix");jQuery(".edit_mode .resource_details").children("div").addClass("clearfix");jQuery("[data-role='method-title']").parent().append(r).addClass("clearfix");jQuery(".description_container").addClass("clearfix");jQuery("ul.method_table").parent().css({clear:"both"});if(jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list'] ").length){jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(t,u){jQuery(this).find("[data-role='description']").parent().append(r)})}jQuery(".description_container").append('<textarea class="resource_description_edit">'+jQuery("[data-role='method-description']").html()+"</textarea>"+r);var s=jQuery("[data-role='request-payload-docs']");s.wrap("<div class='clearfix'></div>");s.attr("data-allow-edit","true");s.parent().append('<textarea class="request_payload_doc_edit"></textarea>'+r);var q=jQuery("[data-role='request-payload-example']");q.wrap("<div class='clearfix'></div>");q.attr("data-allow-edit","true").width("90%").css({float:"left"});q.parent().append(r);var p=jQuery("[data-role='response-payload-docs']");p.wrap("<div class='clearfix'></div>");p.attr("data-allow-edit","true");p.parent().append('<textarea class="response_payload_doc_edit"></textarea>'+r);Apigee.APIModel.inlineEditPageEvents()};this.handleEditPropertiesMouseOver=function(){var p=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).addClass("edit");jQuery(this).siblings("a.allow_edit.hover").css({display:"inline-block"})}};this.handleEditPropertiesMouseOut=function(){var p=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).removeClass("edit");jQuery(this).siblings("a.allow_edit.hover").hide()}};this.handleEditableElementsClick=function(r){var p=false;if(c){if(jQuery(this).attr("data-role")=="description"&&!c.is(jQuery(this))){p=true}else{p=c.attr("data-role")!=jQuery(this).attr("data-role")}}jQuery("[data-role='error_container']").hide().html("");if(m!=""&&b&&c!=null&&p){var q=jQuery.trim(c.text());if(c.siblings("textarea").length){q=jQuery.trim(c.siblings("textarea").val())}if(m!=q){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}else{if(!c.is(jQuery(this))){n.resetEditableElement()}}}else{c=jQuery(this);if(!k&&jQuery(this).attr("data-role")=="description"){c.text(c.html());k=true}m=jQuery.trim(jQuery(this).text());if(jQuery(this).hasClass("resource_description")||jQuery(this).attr("data-role")=="request-payload-docs"||jQuery(this).attr("data-role")=="response-payload-docs"){m=jQuery.trim(jQuery(this).html());jQuery(this).hide();jQuery(this).siblings("textarea").val(jQuery.trim(jQuery(this).html())).height(jQuery(this).height()+30).show();jQuery(this).siblings("textarea").focus();jQuery(this).siblings("textarea").unbind("click").click(function(){return false});Apigee.APIModel.initInlineEditAdminAuthEvents()}if(jQuery(this).attr("data-role")=="method-title"||jQuery(this).attr("data-role")=="description"){jQuery(this).attr("contenteditable","true")}else{jQuery("[data-role='method-title']").removeAttr("contenteditable")}jQuery(this).addClass("editing");jQuery(this).siblings("a.allow_edit.hover").hide();jQuery(this).siblings("a.allow_edit.ok").show();jQuery(this).siblings("a.allow_edit.cancel").show();jQuery(this).addClass("edit");b=true;jQuery(this).focus()}r.preventDefault();return false};this.resetEditableElement=function(){k=false;b=false;c.removeClass("editing");c.siblings("a.allow_edit").hide();c.html(m);if(c.attr("data-role")=="description"){c.html(m)}if(c.attr("data-role")=="method-description"){jQuery("textarea.resource_description_edit").val(m)}c.removeClass("edit").removeClass("editing");if(c.hasClass("resource_description")||c.attr("data-role")=="request-payload-docs"||c.attr("data-role")=="response-payload-docs"){c.siblings("textarea").hide();c.show()}m="";return false};this.documentClickHandler=function(){k=false;if(c){c.removeClass("editing")}var p="";if(c){if(c.hasClass("resource_description")||c.attr("data-role")=="request-payload-docs"||c.attr("data-role")=="response-payload-docs"){p=jQuery.trim(c.siblings("textarea").val())}else{p=jQuery.trim(c.text())}}if(m!=""&&m!=p&&jQuery("body").children("[role='dialog'].modal").is(":visible")==false){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}};this.handleConfirmDialogSave=function(){k=false;c.siblings("a.allow_edit.ok").trigger("click");n.closeAuthModal();Apigee.APIModel.initInlineEditAdminAuthEvents();m="";return false};this.makeAPICall=function(F){var r=location.href;b=false;c.removeClass("editing");var B="";if(c.attr("data-role")=="description"&&c.parent().parent().attr("data-scope")=="resource"){e="resource";r=r.split("/methods/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){r=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}if(Apigee.APIModel.apiModelBaseUrl){r=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}B+='{"parameters": ['+f("general","resource")+" ]";B+=', "parameterGroups": [ '+j("resource")+" ]}"}else{e="method";r=r.split("/doc?")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){r=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}if(Apigee.APIModel.apiModelBaseUrl){r=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}var p=jQuery.trim(jQuery("textarea.resource_description_edit").val());if(c.attr("data-role")!="method-description"){p=jQuery.trim(jQuery(".resource_description ").html())}var G=jQuery("[data-role='auth-type']").text();G=G.replace("Basic Auth","BASICAUTH").replace("Custom Token","CUSTOM").replace("OAuth 1","OAUTH1WEBSERVER").replace("OAuth 1 Client Credentials","OAUTH1CLIENTCREDENTIALS").replace("OAuth 2","OAUTH2WEBSERVER").replace("OAuth 2 Client Credentials","OAUTH2CLIENTCREDENTIALS").replace("OAuth 2 Implicit Grant Flow","OAUTH2IMPLICITGRANT").replace("No auth","NOAUTH");var z="";if(G.split(",").length>1){z="[";for(var E=0;E<G.split(",").length;E++){z+='"'+G.split(",")[E]+'"';if(E!=G.split(",").length-1){z+=","}}z+="]"}else{z='[ "'+G+'" ]'}var x=jQuery.trim(jQuery("[data-role='category']").text());var A="";if(A.split(",").length>1){A="[";for(var E=0;E<x.split(",").length;E++){A+='"'+x.split(",")[E]+'"';if(E!=x.split(",").length-1){A+=","}}A+="]"}else{A='[ "'+x+'" ]'}p=JSON.stringify(p);p=p.substring(1,p.length-1);p=n.escapeSpecialChars(p);B='{ "displayName":"'+jQuery.trim(jQuery("[data-role='method-title']").html())+'", "description": "'+p+'","verb": "'+jQuery.trim(jQuery("[data-role='verb']").text())+'",';B+='"authSchemes" : '+z+', "tags" : '+A;var u="";if(jQuery.trim(jQuery("[data-role='content-type']").text())!="N.A."){u=jQuery.trim(jQuery("[data-role='content-type']").text())}var v=f("general");if(v.length){if(v.charAt(v.length-1)===","){v=v.substring(0,v.length-1)}B+=', "parameters": ['+v+" ]"}B+=', "parameterGroups": [ '+j("method")+" ]";B+=', "body": {';B+='"parameters": [';B+=f("body");B+=" ]";B+=', "attachments": [';B+=f("attachments");B+=" ]";B+=', "contentType":"'+u+'"';if(jQuery('[data-role="request-payload-example"]').length){var s=JSON.stringify(window.apiModelEditor.getRequestPayLoad());s=s.substring(1,s.length-1);s=n.escapeSpecialChars(s);B+=', "sample" :"'+s+'"'}var y=jQuery("[data-role='request-payload-docs']");var H=jQuery("[data-role='response-payload-docs']");var t="";var C="";if(y.length){var t=jQuery.trim(y.html());if(y.siblings("textarea").is(":visible")==true){t=jQuery.trim(y.siblings("textarea").val())}t=JSON.stringify(t);t=t.substring(1,t.length-1);t=n.escapeSpecialChars(t);t=', "doc": "'+t+'" ';B+=t}B+=" }";var q=jQuery("[data-role='response_errors_list']");if(H.length||q.length){B+=', "response": {';if(H.length){var C=jQuery.trim(H.html());if(H.siblings("textarea").is(":visible")==true){C=jQuery.trim(H.siblings("textarea").val())}C=JSON.stringify(C);C=C.substring(1,C.length-1);C=n.escapeSpecialChars(C);var D=JSON.stringify(jQuery("[data-role='response-payload']").val());D=D.substring(1,D.length-1);D=n.escapeSpecialChars(D);B+='"doc": "'+C+'"  ,"sample" : "'+D+'", "contentType" : "'+jQuery("[data-role='response-content-type']").text()+'"'}if(q.length){var v="";jQuery(q).each(function(J){var I=jQuery(this);v+='{"httpStatusCode" :"'+jQuery.trim(I.find("[data-role='http_status_code']").html())+'",';v+='"code" : "'+jQuery.trim(I.find("[data-role='code']").html())+'",';v+='"description" :"'+jQuery.trim(I.find("[data-role='description']").html())+'"}';var K=jQuery(q).length;if(K>J+1){v+=","}});if(H.length){B+=","}B+='"errors" : ['+v+"]"}B+="}"}B+="}"}var w=[];if(localStorage.orgAdminBasicAuthDetails){if(h!=localStorage.orgAdminBasicAuthDetails.split("@@@")[0]){h=localStorage.orgAdminBasicAuthDetails.split("@@@")[0];jQuery(".admin_auth_section a.auth_admin_email").html(localStorage.orgAdminBasicAuthDetails.split("@@@")[1])}}w.push({name:"Authorization",value:h});w.push({name:"Content-Type",value:"application/json"});jQuery("#working_alert").fadeIn();r=Apigee.APIModel.proxyURL+"?targeturl="+r;n.makeAJAXCall({url:r,type:"put",dataType:"json",headers:w,data:B,callback:n.handleAPICallSuccess,errorCallback:n.handleUpdateFailure});jQuery(this).siblings("[contenteditable='true']").removeClass("edit");jQuery(this).siblings("a.allow_edit.cancel").hide();jQuery(this).siblings("a.allow_edit.ok").hide();if(jQuery(this).siblings("textarea").is(":visible")){jQuery(this).siblings("textarea").hide();jQuery(this).siblings("[data-allow-edit='true']").html(jQuery(this).siblings("textarea").val()).removeClass("edit").removeClass("editing").show()}jQuery(this).hide();F.stopPropagation();return false};this.handleAPICallSuccess=function(r){k=false;r=unescape(r.responseContent);r=JSON.parse(r);m=jQuery.trim(c.html());jQuery("[data-role='method-title']").html(r.displayName);jQuery("[data-role='method-description']").html(r.description);jQuery("[data-role='query-param-list'], [data-role='header-param-list'], [data-role='body-param-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(s){i(jQuery(this),r)});if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var p=window.location.href;var q=p=p.replace("?editMode=1","?flush=1").replace("?editMode=2","?flush=1");n.makeAJAXCall({url:q,callback:n.drupalUpdateSuccess})}m=""};this.drupalUpdateSuccess=function(){};this.handleUpdateFailure=function(){n.resetEditableElement();n.showError("Error saving changes.")}};Apigee.APIModel.InlineEdit.prototype=new Apigee.APIModel.Common;Apigee.APIModel.SwaggerModel=function(a,d){this.name=d.id!=null?d.id:a;this.properties=[];var b;for(b in d.properties){if(d.required!=null){var c;for(c in d.required){if(b===d.required[c]){d.properties[b].required=true}}}prop=new Apigee.APIModel.SwaggerModelProperty(b,d.properties[b]);this.properties.push(prop)}this.createJSONSample=function(g){if(Apigee.APIModel.sampleModels[this.name]){return Apigee.APIModel.sampleModels[this.name]}else{var e={};var g=g||[];g.push(this.name);for(var f=0;f<this.properties.length;f++){prop=this.properties[f];e[prop.name]=prop.getSampleValue(g)}g.pop(this.name);return e}}};Apigee.APIModel.SwaggerModelProperty=function(a,b){this.name=a;this.dataType=b.type||b.dataType||b["$ref"];this.isCollection=this.dataType&&(this.dataType.toLowerCase()==="array"||this.dataType.toLowerCase()==="list"||this.dataType.toLowerCase()==="set");this.descr=b.description;this.required=b.required;if(b.items!=null){if(b.items.type!=null){this.refDataType=b.items.type}if(b.items.$ref!=null){this.refDataType=b.items.$ref}}this.dataTypeWithRef=this.refDataType!=null?this.dataType+"["+this.refDataType+"]":this.dataType;if(b.allowableValues!=null){this.valueType=b.allowableValues.valueType;this.values=b.allowableValues.values;if(this.values!=null){this.valuesString="'"+this.values.join("' or '")+"'"}}if(b["enum"]!=null){this.valueType="string";this.values=b["enum"];if(this.values!=null){this.valueString="'"+this.values.join("' or '")+"'"}}this.getSampleValue=function(d){var c;if(this.refModel!=null&&d.indexOf(prop.refModel.name)===-1){c=this.refModel.createJSONSample(d)}else{if(this.isCollection){c=this.toSampleValue(this.refDataType)}else{c=this.toSampleValue(this.dataType)}}if(this.isCollection){return[c]}else{return c}};this.toSampleValue=function(d){var c;if(d==="integer"){c=0}else{if(d==="boolean"){c=false}else{if(d==="double"||d==="number"){c=0}else{if(d==="string"){c=""}else{c=d}}}}return c}};Apigee.APIModel.sampleModels={};