Apigee.APIModel.Common=function(){var j=this;var a;var c='<button aria-hidden="true" data-dismiss="modal" class="close button_close_modal" type="button">x</button>';var b="<h3>Set Authentication</h3>";var d="<h3>Set Organization Admin Credentials</h3>";var f="<h3>Warning</h3>";var g="<h3>Custom Token</h3>";if(typeof apiName!="undefined"){var i="<h3>Request "+apiName+" permissions</h3>"}var k="<p>Your credentials are saved for the session only.</p>";var e='<a class="btn btn-primary button_save_modal" href="javascript:void(0)">Save</a><a class="button_close_modal" href="javascript:void(0)">Cancel</a>';var h=e.replace("Cancel","Discard");validateEmail=function(n){var l=false;if(jQuery.trim(n).length>1){var m=RegExp(/^[a-zA-Z0-9_]{0,1}([a-zA-Z0-9_\.\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~])+([a-zA-Z0-9_\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~]{0,1})+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);if(m.test(n)){if(n.indexOf("..")==-1){l=true}}}return l};navigator.sayswho=function(){var n=navigator.appName,m=navigator.userAgent,l;var o=m.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(o&&(l=m.match(/version\/([\.\d]+)/i))!=null){o[2]=l[1]}o=o?[o[1],o[2]]:[n,navigator.appVersion,"-?"];return o}();showMessage=function(l){theParent=document.getElementsByTagName("body")[0];theKid=document.createElement("div");theKid.setAttribute("style","height:20px;width:100%;background-color:#F9F6C5;text-align:center;position:fixed;z-index:999;");theKid.innerHTML=l;theParent.appendChild(theKid);theParent.insertBefore(theKid,theParent.firstChild)};this.makeAJAXCall=function(r){var u=r.url.toString();var v=document.location.host.toString();if(u.indexOf("targeturl=")!=-1){u=u.split("targeturl=")[0].toString()}if(jQuery.browser.msie&&window.XDomainRequest&&parseInt(jQuery.browser.version)<=9&&u.indexOf(v)==-1){var o=r.url;var t=r.type?r.type:"get";if(o.indexOf("targeturl")!=-1){var m=r.type?r.type:"get";o+="&method="+m;t="POST"}if(r.headers){var w=r.headers;var q="{";for(var s=0,p=w.length;s<p;s++){q+='"'+w[s].name+'" : "'+w[s].value+'"';if(p!=1&&s!=p-1){q+=","}}q+="}";q=encodeURIComponent(q);o+="&headers="+q}var n=r.data?r.data:null;xdr=new XDomainRequest;xdr.onload=function(){var y;var x=true;try{y=jQuery.parseJSON(xdr.responseText)}catch(z){x=false}if(!x){r.callback(xdr.responseText)}else{if(y){var l=y.responseStatusCode;if(l){if(parseInt(l)>=400){if(r.errorCallback){r.errorCallback(l);jQuery("#working_alert").fadeOut();return}else{r.callback(y);jQuery("#working_alert").fadeOut();return}}}r.callback(y)}else{r.callback(xdr.responseText)}}jQuery("#working_alert").fadeOut()};xdr.onerror=function(){if(r.errorCallback){r.errorCallback(xdr.responseText)}else{r.callback(xdr.responseText)}jQuery("#working_alert").fadeOut()};xdr.open(t,o);xdr.send(n)}else{jQuery.ajax({url:r.url,cache:false,type:r.hasOwnProperty("type")?r.type:"get",data:r.hasOwnProperty("data")?r.data:null,contentType:r.hasOwnProperty("contentType")?r.contentType:"application/x-www-form-urlencoded;charset=utf-8",processData:r.hasOwnProperty("processData")?r.processData:true,beforeSend:function(z){if(r.headers){for(var y=0,x=r.headers.length;y<x;y++){var A=r.headers[y];z.setRequestHeader(A.name,A.value)}}},success:function(y,z,x){if(typeof y!="object"){r.callback(x.responseText)}else{if(y){var l=y.responseStatusCode;if(l){if(parseInt(l)>=400){if(r.errorCallback){r.errorCallback(l);return}else{r.callback(y);return}}}r.callback(y)}}},error:function(y,l,x){if(r.errorCallback){r.errorCallback(y.status)}else{r.callback(y.responseText)}},complete:function(){jQuery("#working_alert").fadeOut()}})}};this.closeAuthModal=function(){jQuery('[role="dialog"].modal').modal("hide");jQuery('[role="dialog"].modal input').removeClass("error");jQuery('[role="dialog"].modal .error_container').hide().html("")};this.validateBasicAuthFields=function(m){var n="";userEmail=jQuery.trim(jQuery("[data-role='"+m+"']").find("#inputEmail").val());if(!userEmail.length){jQuery("#inputEmail").addClass("error");n+="<span>Email/Username required.</span><br/>"}var l=jQuery("[data-role='"+m+"']").find("#inputPassword");if(!jQuery.trim(l.val()).length){l.addClass("error");n+="<span>Password required.</span><br/>"}return n};this.shortenText=function(n,l){var m=n.text();if(m.length>l){m=m.substring(0,l-3)+"...";n.text(m)}};this.parseAndReturn=function(l){var n="";try{n=jQuery.parseJSON(l)}catch(m){n=l}return n};this.getQueryParam=function(n,p){var l=n.split("?");if(l.length>2){l=n.split(/\?(.*)/)}if(l.length>1){l=l[1];l=l.split("&");for(var m=0;m<l.length;m++){var o=l[m].split("=");if(o[0]==p){return o[1]}}return""}return""};this.escapeSpecialChars=function(l){return l.replace(/\\n/g,"\\n").replace(/'/g,"'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")};this.showError=function(l){jQuery("[data-role='error_container']").html(l).show();jQuery("body").scrollTop(0)};this.showUnsupportedBrowserAlertMessage=function(){var m=navigator.sayswho.toString();var o=m.split(",")[0].toLowerCase();var l=parseInt(m.split(",")[1]);var n="<p>You are using an unsupported browser. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 9. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedBrowserMessage()'> Close</a> ]</p>";if(o!="chrome"){if(o=="firefox"){if(l<10){showMessage(n)}}if(o=="safari"){if(l<6){showMessage(n)}}if(o=="msie"){if(l<9){showMessage(n)}}}};this.hideUnsupportedBrowserMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedBrowserFlag","true")};this.showUnsupportedAttachementAlertMessage=function(){showMessage("<p>Attachement is not supported in IE9. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer >= 10. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedAttachementMessage()'> Close</a> ]</p>")};this.hideUnsupportedAttachementMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedAttachmentFlag","true")};this.dateDiff=function(m,l){var n=m.getTime()-l.getTime();return n/(24*60*60*1e3)}};Apigee.APIModel.Editor=function(){var a;this.initRequestPayloadEditor=function(){if(jQuery('[data-role="request-payload-example"]').length){jQuery('[data-role="request-payload-example"]').children("textarea").show();bodyPayloadElementValue=jQuery.trim(jQuery('[data-role="request-payload-example"]').find("textarea").val());jQuery(".request_payload textarea").val(bodyPayloadElementValue);bodyPayloadElement=jQuery(".request_payload textarea");if(bodyPayloadElement){var b=bodyPayloadElement.data("format")=="application/xml"?"xml":"javascript";a=CodeMirror.fromTextArea(jQuery(".request_payload textarea").get(0),{mode:b,lineNumbers:true});if(a.lineCount()<=2){a.setSize("100%",a.lineCount()*18)}else{a.setSize("100%",a.lineCount()*15)}}}};this.getRequestPayLoad=function(){return a.getValue()};this.setRequestPayLoad=function(b){a.setValue(b)}};Apigee.APIModel.Methods=function(){var o=this;var i=["January","February","March","April","May","June","July","August","September","October","November","December"];var y;var c;var f="";var n="";var x;var u="";var q;var p=false;var A=[];var j=false;var s=[];var r=false;var g=[];var h;var w;var m={};var e={};var b=false;var k="";var a="";var t=window.location.href;var l=Apigee.APIModel.apiName;var z=Apigee.APIModel.revisionNumber;var d="";var v="-None-";this.init=function(){var H=jQuery("[data-role='auth-type']");x=jQuery.trim(H.text());if(x.split(",").length>1){x=x.substr(0,x.length-1)}x=x.replace("BASICAUTH","Basic Auth").replace("CUSTOM","Custom Token").replace("OAUTH1WEBSERVER","OAuth 1").replace("OAUTH1CLIENTCREDENTIALS","OAuth 1 Client Credentials").replace("OAUTH2WEBSERVER","OAuth 2").replace("OAUTH2CLIENTCREDENTIALS","OAuth 2 Client Credentials").replace("OAUTH2IMPLICITGRANT","OAuth 2 Implicit Grant Flow").replace("NOAUTH","No auth");H.html(x);o.updateAuthContainer();var J="";jQuery("[data-role='method_url_container'] span").each(function(){J+='<span data-role="'+jQuery(this).attr("data-role")+'">'+jQuery(this).html()+"</span>"});jQuery("[data-role='method_url_container']").html(J);c=jQuery("[data-role='method_url_container']");c.html(c.html().replace(/\{/g,"<span data-toggle='tooltip' data-original-title=''><span class='template_param' contenteditable='true'>{").replace(/\}/g,"}</span><span></span></span>"));c.find("span.template_param").each(function(){jQuery(this).siblings("span").attr("data-role",jQuery(this).text())});jQuery("[data-role='template-params']").find("p").each(function(){var L=jQuery(this).find("[data-role='name']").html();var K=jQuery(this).find("[data-role='description']").html();jQuery("[data-toggle='tooltip']").each(function(){var M=jQuery(this).find("span:eq(1)").data("role");if(M){M=M.substring(1,M.length-1);if(M==L){K=jQuery.trim(K);if(K.charAt(K.length-1)!="."){K+="."}jQuery(this).attr("data-original-title",K+" Click to edit the value.")}}})});if(localStorage.hasOwnProperty("templateParams")){var F=JSON.parse(localStorage.getItem("templateParams"));for(var E=0;E<F.length;E++){var G=F[E].name;var C=F[E].value;jQuery("[data-role='method_url_container'] span.template_param").each(function(){var K=jQuery(this).siblings("span");var L=jQuery(this);if(K.attr("data-role")==G){L.text(jQuery.trim(C))}})}}jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='attachments-list']").each(function(K,L){if(!jQuery(this).find("span.required").length&&jQuery(this).find(".value select").length){jQuery(this).find(".value select").prepend("<option value='"+v+"' selected>"+v+"</option>")}var M=jQuery(this).find("[data-role='value']");M.attr("data-original-value",jQuery.trim(M.val()))});var B=jQuery("[data-role='category']");var D=jQuery.trim(B.text());if(D.split(",").length>1){D=D.substr(0,D.length-1)}B.html(D);if(jQuery("[data-role='request-payload-docs']").length&&!jQuery("[data-role='request-payload-example']").length){jQuery("[data-role='request-payload-docs']").show()}jQuery("#working_alert").css("left",jQuery(window).width()/2-56);jQuery("#method_content").show();window.apiModelEditor.initRequestPayloadEditor();var I=t.split("/apimodels/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){I=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName}if(Apigee.APIModel.apiModelBaseUrl){I=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName}I=I+"/apimodels/proxyUrl";o.makeAJAXCall({url:I,callback:o.storeProxyURL});Apigee.APIModel.initMethodsPageEvents();Apigee.APIModel.initMethodsAuthDialogsEvents()};this.storeProxyURL=function(B){Apigee.APIModel.proxyURL=B.proxyUrl;Apigee.APIModel.authUrl=B.authUrl;Apigee.APIModel.proxyURL=Apigee.APIModel.proxyURL+"/sendrequest"};this.renderCallbackURL=function(B){if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var D=B.authUrl.split("redirect_uri=")[0];var C=B.authUrl.split("redirect_uri=")[1];C=D+"redirect_uri="+encodeURIComponent(Drupal.settings.smartdocs.oauth2AuthUrl+"?org="+Apigee.APIModel.organizationName+"&api="+Apigee.APIModel.apiName+"&revision="+Apigee.APIModel.revisionNumber)+"&client_id="+C.split("client_id=")[1];window.open(C,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}else{window.open(B.authUrl,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}};this.handleOAuth2Failure=function(){o.showError("Unable to proceed because of missing OAuth configuration.")};this.renderCustomTokenCredentials=function(G){var B=G;var K=B.tokenType;var E=Object.keys(B.tokenMap).length;jQuery("[data-role='custom_token_row']").each(function(L){if(L>0){jQuery(this).remove()}});if(E>=1){for(var H=1,D=E;H<D;H++){jQuery("[data-role='custom_token_row']").first().clone().appendTo("[data-role='custom_token_rows']")}}var I=1;for(var J in B.tokenMap){var F=J;var C=B.tokenMap[J];jQuery("[data-role='custom_token_row']:nth-child("+I+")").find("[data-role='name']").val(F);jQuery("[data-role='custom_token_row']:nth-child("+I+")").find("[data-role='value']").val(C);I++}if(K=="header"){jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked","checked")}else{jQuery("[data-role='custom_token_modal']").find("[data-role='query']").attr("checked","checked")}};this.handleCustomTokenFailure=function(){o.showError("Unable to proceed because of missing Custom token configuration.")};this.updateTemplateParamWidth=function(C,E){var D=C.text();var B=D.length;if(B==0){B=8.4}else{B=Math.ceil(B*8.4)}if(E){C.css("width",B)}else{C.css("width","auto")}};this.updateTemplateParamText=function(C){var D=C.text();var B=D.length;if(B==0){B=8.4;C.html("&nbsp;")}else{B=Math.ceil(B*8.4);if(C.html().indexOf("&nbsp;")!=-1){C.slice(C.html().indexOf("&nbsp;"),C.html().indexOf("&nbsp;")+1)}}};this.updateAuthContainer=function(){if(x.indexOf("No auth")!=-1){jQuery("[data-role='authentication_container']").css({visibility:"hidden"});jQuery(".icon_lock").css({visibility:"hidden"})}else{if(x.indexOf("Basic Auth")!=-1){if(x.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@basicauth";a="basicauth"}var F="";if(localStorage.apisBasicAuthDetails){var C=new Date;var I=C.getMonth()+1+"/"+C.getDate()+"/"+C.getFullYear();var E=localStorage.apisBasicAuthDetails.split("@@@")[3];var J=I;var H=J-E;var H=parseInt(o.dateDiff(new Date(J),new Date(E)));if(H>30){localStorage.removeItem("apisBasicAuthDetails")}else{F=localStorage.apisBasicAuthDetails}}else{if(sessionStorage.apisBasicAuthDetails){F=sessionStorage.apisBasicAuthDetails}}if(F!==""){if(l==F.split("@@@")[0]){n=F.split("@@@")[1];var G=n;if(G.length>12){G=G.substring(0,12)+"..."}f=F.split("@@@")[2];if(sessionStorage.selectedAuthScheme){var D=l==sessionStorage.selectedAuthScheme.split("@@@")[0]&&z==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="basicauth"?"selected":""}if(D!=""){jQuery("[data-role='basic_auth_container']").addClass(D)}jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(G);jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='basic_auth_container']").show()}if(x.indexOf("OAuth 2")!=-1){if(x.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@oauth2";a="oauth2"}var K="";if(localStorage.apisOAuth2CredentialsDetails){var C=new Date;var I=C.getMonth()+1+"/"+C.getDate()+"/"+C.getFullYear();var E=localStorage.apisOAuth2CredentialsDetails.split("@@@")[2];var J=I;var H=J-E;var H=parseInt(o.dateDiff(new Date(J),new Date(E)));if(H>30){localStorage.removeItem("apisBasicAuthDetails")}else{K=localStorage.apisOAuth2CredentialsDetails}}else{if(sessionStorage.apisOAuth2CredentialsDetails){K=sessionStorage.apisOAuth2CredentialsDetails}}if(K!==""){if(l==K.split("@@@")[0]){m=jQuery.parseJSON(K.split("@@@")[1]);var D=l==K.split("@@@")[0]&&sessionStorage.selectedAuthScheme.split("@@@")[1]=="oauth2"?"selected":"";if(D!=""){jQuery("[data-role='oauth2_container']").addClass(D)}jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Authenticated");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='oauth2_container']").show()}if(x.indexOf("Custom Token")!=-1){if(x.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@customtoken";a="customtoken"}var B=sessionStorage.revisionsCustomTokenCredentialsDetails;if(B){if(l==B.split("@@@")[0]&&z==B.split("@@@")[1]){e=JSON.parse(B.split("@@@")[2]);var D=l==sessionStorage.selectedAuthScheme.split("@@@")[0]&&z==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="customtoken"?"selected":"";if(D!=""){jQuery("[data-role='custom_token_container']").addClass(D)}jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Custom Token");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='custom_token_container']").show()}Apigee.APIModel.initMethodsAuthDialogsEvents()}};this.swapSampleRequestResponseContainer=function(){var B=jQuery(this);if(B.attr("id")=="link_request_tab"){jQuery("#link_response_tab").removeClass("selected");jQuery("#request_response_container .response").hide();jQuery("#request_response_container .request").show()}else{jQuery("#link_request_tab").removeClass("selected");jQuery("#request_response_container .request").hide();jQuery("#request_response_container .response").show()}B.addClass("selected")};this.saveAuthModal=function(G){var F=jQuery(this).parents(".modal");if(F.attr("data-role")=="basic_auth_modal"){var H=o.validateBasicAuthFields("basic_auth_modal");if(H==""){n=jQuery("#inputEmail").val();f="Basic "+jQuery.base64Encode(n+":"+jQuery("#inputPassword").val());var C=jQuery("[data-role='basic_auth_modal']").find("#chk_remember").is(":checked");if(C){var B=new Date;var E=B.getMonth()+1+"/"+B.getDate()+"/"+B.getFullYear();localStorage.apisBasicAuthDetails=l+"@@@"+n+"@@@"+f+"@@@"+E}else{localStorage.removeItem("apisBasicAuthDetails");sessionStorage.apisBasicAuthDetails=l+"@@@"+n+"@@@"+f}o.closeAuthModal();sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@basicauth";a="basicauth";o.updateAuthContainer()}else{jQuery("[role='dialog'].modal .error_container").html(H+"Please try again.").show()}}else{if(F.attr("data-role")=="oauth2_modal"){var D=window.location.href;D=t.split("/resources/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){D=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}if(Apigee.APIModel.apiModelBaseUrl){D=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}o.closeAuthModal();o.makeAJAXCall({url:D+"/authschemes/oauth2webserverflow/authUrl",dataType:"json",callback:o.renderCallbackURL,errorCallback:o.handleOAuth2Failure})}else{if(F.attr("data-role")=="custom_token_modal"){e={};e.tokenType=jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked")=="checked"?"header":"query";e.tokenMap={};jQuery("[data-role='custom_token_row']").each(function(){e.tokenMap[jQuery(this).find("[data-role='name']").val()]=jQuery(this).find("[data-role='value']").val()});sessionStorage.revisionsCustomTokenCredentialsDetails=l+"@@@"+z+"@@@"+JSON.stringify(e);o.closeAuthModal();sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@customtoken";a="customtoken";o.updateAuthContainer()}}}};this.getCustomTokenCredentials=function(){if(!b){t=t.split("/resources/")[0];o.makeAJAXCall({url:t+"/authschemes/custom",dataType:"json",callback:o.renderCustomTokenCredentials,errorCallback:o.handleCustomTokenFailure});b=true}};this.toggleRequestPayload=function(E){var B=jQuery(this);if(!B.parent().hasClass("active")){B.parent().siblings().removeClass("active");B.parent().addClass("active");var F=B.attr("data-role");var C=jQuery("[data-role='request-payload-docs']");var D=jQuery("[data-role='request-payload-example']");if(C.siblings("textarea").length){C.siblings("textarea").hide();C.siblings("a.allow_edit").hide()}if(D.siblings("a.allow_edit").length){D.siblings("a.allow_edit").hide()}if(F=="docs-link"){D.hide();C.show()}else{C.hide();D.show()}}};this.resetFields=function(){jQuery("[data-role='query-param-list'],[data-role='header-param-list'],[data-role='body-param-list']").find("input").each(function(){jQuery(this).val("")});jQuery("[data-role='query-param-list'],[data-role='header-param-list']").each(function(C,D){var E=jQuery(this).find("[data-role='value']");E.val(E.attr("data-original-value"))});if(jQuery('[data-role="request-payload-example"]').length){var B=jQuery('[data-role="request-payload-example"]').children("textarea").val();window.apiModelEditor.setRequestPayLoad(B)}jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");u="";q=false};this.sendRequest=function(){jQuery("#working_alert").fadeIn();jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");var D=jQuery("[data-role='method_url_container'] span.template_param");if(D.length>=1){if(localStorage.hasOwnProperty("templateParams")){var N=JSON.parse(localStorage.getItem("templateParams"));jQuery("[data-role='method_url_container'] span.template_param").each(function(){var ab=jQuery(this).siblings("span").attr("data-role");var ae=jQuery(this).text();if(ab==ae||ae==""||jQuery(this).html()=="&nbsp;"){p=true;A.push(ab.substring(1,ab.length-1));jQuery(this).addClass("error")}var Z=false;for(var aa=0;aa<N.length;aa++){var ac=N[aa].name;var ad=N[aa].value;if(ab==ac){Z=true}if(ab==ac&&ae!=ad&&ae.length){N[aa].value=ae}}if(!Z){N.push({name:ab,value:ae})}});localStorage.setItem("templateParams",JSON.stringify(N))}else{var F=[];jQuery("[data-role='method_url_container'] input").each(function(){var Z=jQuery(this).siblings("span");F.push({name:Z.attr("data-role"),value:Z.html()})});localStorage.setItem("templateParams",JSON.stringify(F))}}var P=jQuery("[data-role='method_url_container']").text();var S=jQuery.trim(jQuery("[data-role='verb']").text().toLowerCase());var O=[];if(jQuery("[data-role='header-param-list']").length){jQuery("[data-role='header-param-list']").each(function(aa,ac){var Z=jQuery(this).find("[data-role='name']").text();var ab;if(jQuery(this).find("[data-role='multiple-value']").length){ab=jQuery(this).find("select option:selected").val();ab=ab==v?"":ab}else{ab=jQuery(this).find("[data-role='value']").val()}O.push({name:Z,value:ab});if(jQuery(this).find("span.required").length&&jQuery(this).find("[data-role='value']").val()==""){j=true;s.push(Z);jQuery(this).find("[data-role='value']").addClass("error")}})}var B="";if(jQuery("[data-role='query-param-list']").length>=1){var V=true;jQuery("[data-role='query-param-list']").each(function(Z,ad){var ac=jQuery(this).find("[data-role='name']").text();var aa;if(jQuery(this).find("[data-role='multiple-value']").length){aa=jQuery(this).find("select option:selected").val();aa=aa==v?"":aa}else{aa=jQuery(this).find("[data-role='value']").val()}if(jQuery.trim(aa).length>=1){var ab=V?"":"&";B+=ab+ac+"="+encodeURIComponent(decodeURIComponent(aa));V=false}if(jQuery(this).find("span.required").length&&aa==""){r=true;g.push(ac);jQuery(this).find("[data-role='value']").addClass("error")}})}var U="";var G=jQuery("[data-role='param-groups']");if(G.length){G.each(function(aa,ac){var af=jQuery(this);var ab=af.find("[data-role='maxChoice']").length?parseInt(af.find("[data-role='maxChoice']").text()):af.find("[data-role='param-group-list']").length;var ad=af.find("[data-role='minChoice']").length?parseInt(af.find("[data-role='minChoice']").text()):0;var Z=0;var ae=[];if(af.find("[data-role='param-group-list']").length){af.find("[data-role='param-group-list']").each(function(ag,ak){var ah=jQuery(this).find("[data-role='name']").text();var al=jQuery(this).find("[data-role='value']").val();var aj=jQuery(this).find("[data-role='type']").text().toLowerCase();if(jQuery.trim(al).length>=1){Z++;if(aj=="query"){var ai=jQuery.trim(B).length?"&":"";B+=ai+ah+"="+encodeURIComponent(decodeURIComponent(al))}else{if(aj=="header"){O.push({name:ah,value:al})}}}else{ae.push(jQuery.trim(ah))}})}if(ad>Z){U+="Missing "+(ab-Z)+" value for parameter group of: <span>"+ae.join(", ")+"</span></br>"}if(Z>ab){U+="Number of entered parmeters exceeds the maximum number of choices in the parameter group</br>"}})}if(e.tokenType=="query"){var H=B!=""?"&":"";var L=0;for(var Y in e.tokenMap){H=L==0?H:"&";var C=Y;var X=e.tokenMap[Y];if(jQuery.trim(C)!=""&&jQuery.trim(X)!=""){B+=H+C+"="+X;L++}}}else{for(var Y in e.tokenMap){var C=Y;var X=e.tokenMap[Y];if(jQuery.trim(C)!=""&&jQuery.trim(X)!=""){O.push({name:C,value:X})}}}if(jQuery.browser.msie&&parseInt(jQuery.browser.version)<=9&&jQuery("[data-role='body-param-list']").length){O.push({name:"Content-Type",value:"application/x-www-form-urlencoded"})}P=P.replace(/\{/g,"").replace(/\}/g,"");P=jQuery.trim(P);B=jQuery.trim(B);if(B!=""){var H="?";if(P.indexOf("?")!=-1){H="&"}P=P+H+B}if(p){U+="Missing value for template parameter(s): <span>"+A.join(", ")+"</span></br>"}if(r){U+="Missing value for required query parameter(s):&nbsp;<span>"+g.join(", ")+"</span></br>"}if(j){U+="Missing value for required header parameter(s):&nbsp;<span>"+s.join(", ")+"</span></br>"}if(U!=""){jQuery("body").scrollTop(0);jQuery("[data-role='error_container']").html(U).show();o.clearMissingArray()}if(a=="basicauth"){if(f){if(localStorage.apisBasicAuthDetails&&l==localStorage.apisBasicAuthDetails.split("@@@")[0]){if(f!=localStorage.apisBasicAuthDetails.split("@@@")[2]){f=localStorage.apisBasicAuthDetails.split("@@@")[2];jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(localStorage.apisBasicAuthDetails.split("@@@")[1])}}O.push({name:"Authorization",value:f})}}else{if(a=="oauth2"&&m!=null){if(localStorage.apisOAuth2CredentialsDetails&&l==localStorage.apisOAuth2CredentialsDetails.split("@@@")[0]){var R=jQuery.parseJSON(localStorage.apisOAuth2CredentialsDetails.split("@@@")[1]);if(R.accessToken!=m.accessToken){m=R}}if(m.accessTokenType=="query"){var J=m.accessToeknParamName==""?"oauth_token":m.accessToeknParamName;var H=B==""?"?":"&";P+=H+J+"="+m.accessToken}else{if(m.accessTokenType=="bearer"){O.push({name:"Authorization",value:"Bearer "+m.accessToken})}}}}d=P;P=encodeURIComponent(P).replace(/\{.*?\}/g,"");P=Apigee.APIModel.proxyURL+"?targeturl="+P;var Q=null;var K="application/x-www-form-urlencoded;charset=utf-8";var E=true;if(jQuery("[data-role='attachments-list']").length||jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='body-param-list']").length){var I="";if(jQuery.browser.msie&&parseInt(jQuery.browser.version)<=9){if(localStorage.getItem("unsupportedAttachmentFlag")==null){o.showUnsupportedAttachementAlertMessage()}jQuery("#working_alert").fadeOut();return}if(jQuery("[data-role='body-param-list']").length){var M=jQuery("#formParams").serialize();if(!jQuery("#formAttachment input[name='root-fields']").length){jQuery("#formAttachment").prepend('<input type="hidden" name="root-fields" value="'+M+'"/>')}else{jQuery("#formAttachment input[name='root-fields']").val(M)}I="param";if(jQuery('[data-role="request-payload-example"]').length||jQuery("[data-role='attachments-list']").length){I+=jQuery('[data-role="request-payload-example"]').length?"+text":"";I+=jQuery("[data-role='attachments-list']").length?"+attachment":"";P+="&multiparttypes="+I}}else{for(var W=0,T=O.length;W<T;W++){if(O[W].name=="Content-Type"){O.splice(W,1)}}if(jQuery('[data-role="request-payload-example"]').length&&jQuery("[data-role='attachments-list']").length){P+="&multiparttypes=text+attachment"}}if(jQuery('[data-role="request-payload-example"]').length){if(!jQuery("#formAttachment textarea[name='text']").length){if(jQuery("#formAttachment input[name='root-fields']").length){jQuery("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>").insertAfter("#formAttachment input[name='root-fields']")}else{jQuery("#formAttachment").prepend("<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>")}}else{jQuery("#formAttachment textarea[name='text']").val(window.apiModelEditor.getRequestPayLoad())}}if(jQuery("#formParams").length){Q=new FormData(jQuery("form")[1])}else{Q=new FormData(jQuery("form")[0])}K=false;E=false}else{if(jQuery("[data-role='body-param-list']").length){if(jQuery("#formParams").length){Q=jQuery("#formParams").serialize()}else{Q=jQuery("#formAttachment").serialize()}}else{if(jQuery('[data-role="request-payload-example"]').length){Q=window.apiModelEditor.getRequestPayLoad()}}}o.makeAJAXCall({url:P,type:S,data:Q,callback:o.renderRequest,headers:O,contentType:K,processData:E})};this.renderRequest=function(S){var G=jQuery("[data-role='response-container']");var E=jQuery("[data-role='request-container']");if(S==""||S==null){E.html("<strong> An internal error has occurred. Please retry your request.</strong>");G.html("<strong> An internal error has occurred. Please retry your request.</strong>");return}if(typeof S!="object"){S=jQuery.parseJSON(S)}u=unescape(S.responseContent);var B="<strong";var K;var H;var Q;if(S.responseStatusCode){K=S.responseStatusCode;H=S.httpVersion;Q=S.responseReasonPhrase}else{K=S.responseCode;H=S.messageVersion;Q=S.responsePharse}if(parseInt(K)>=100&&parseInt(K)<400){B+=" class='success'"}B+="> HTTP/"+H+" "+K+"  "+Q+"</strong>";B+="<dl>";for(var N=0;N<S.responseHeaders.length;N++){B+="<dt>";B+=unescape(S.responseHeaders[N].name);B+=": </dt><dd>";B+=unescape(S.responseHeaders[N].value);B+="</dd>"}B+="</dl>";G.html(B);if(u!=""){var O=/^"\{/.test(u)&&/\}"$/.test(u)||/^"\[/.test(u)&&/\]"$/.test(u);if(O){u=u.replace(/^"((.|\s)*)"$/,"$1")}if(u){var J=true;try{var R=jQuery.parseJSON(u)}catch(P){J=false}if(J){var L=o.parseAndReturn(u);u=JSON.stringify(L,null,2);u=u.replace("[{","[\n  {");u=u.replace(/,\n[\n ]*$/,"");u=u.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");G.append("<pre><code class='language-javascript' id='some-code123'>"+u+"</code></pre>")}else{u=u.replace(/>/g,"&gt;").replace(/</g,"&lt;");G.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+u+"</code></pre>")}}}var M=d.split("//")[1].split("/")[0].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var D=d.split(M)[1].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var C="<strong>"+S.requestVerb+" "+D+" HTTP/"+H+"</strong>";C+="<dl>";for(var N=0;N<S.requestHeaders.length;N++){var I=S.requestHeaders[N].name;if(I.toLowerCase()!="origin"&&I.toLowerCase()!="referer"){var F=S.requestHeaders[N].value;C+="<dt>";C+=unescape(I);C+=": </dt><dd>";C+=unescape(F).replace(/</g,"&lt").replace(/>/g,"&gt");C+="</dd>"}}C+="</dl>";E.html(C);q=unescape(S.requestContent);q=q.replace(/[^\x00-\x7F]/g,"###");if(q.indexOf("###")!=-1){q=q.replace(q.substring(q.indexOf("###"),q.lastIndexOf("###")+3),"[BINARY DATA]")}if(q){var J=true;try{R=jQuery.parseJSON(q)}catch(P){J=false}if(J){var L=o.parseAndReturn(q);q=JSON.stringify(L,null,2);q=q.replace("[{","[\n  {");q=q.replace(/,\n[\n ]*$/,"");q=q.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");E.append("<pre class='language-javascript'><code class='language-javascript' id='some-code'>"+q+"</code></pre>")}else{q=q.replace(/>/g,"&gt;").replace(/</g,"&lt;");E.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+q+"</code></pre>")}}if(typeof Prism=="object"){Prism.highlightAll()}};this.clearErrorContainer=function(){o.clearMissingBooleanVariables();o.clearMissingArray();jQuery("[data-role='error_container']").hide().html("")};this.clearMissingBooleanVariables=function(){p=false;j=false;r=false;isRequestBodyMissing=false};this.clearMissingArray=function(){A=[];s=[];g=[];requestBodyMissing=""};this.updateAuthModalFooter=function(C){var B=C=="basic_auth_modal"?"apisBasicAuthDetails":"apisOAuth2CredentialsDetails";if(localStorage.getItem(B)){jQuery("[data-role='"+C+"']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='"+C+"']").find(".modal-footer p input").length){jQuery("[data-role='"+C+"']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='"+C+"']").modal("show")};this.setOAuth2Credentials=function(E){if(E.errorMessage!=""){o.showError(E.errorMessage)}else{m=E;a="oauth2";var C=jQuery("[data-role='oauth2_modal']").find("#chk_remember").is(":checked");if(C){var B=new Date;var D=B.getMonth()+1+"/"+B.getDate()+"/"+B.getFullYear();localStorage.apisOAuth2CredentialsDetails=l+"@@@"+JSON.stringify(m)+"@@@"+D}else{localStorage.removeItem("apisOAuth2CredentialsDetails");sessionStorage.apisOAuth2CredentialsDetails=l+"@@@"+JSON.stringify(m)}sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@oauth2";o.updateAuthContainer()}};this.toggleAuthScheme=function(B){jQuery("[data-role='authentication_container'] .well").removeClass("selected");jQuery(this).addClass("selected");if(jQuery(this).hasClass("basicauth")){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@basicauth";a="basicauth"}else{if(jQuery(this).hasClass("oauth2")){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@oauth2";a="oauth2"}else{if(jQuery(this).hasClass("customtoken")){sessionStorage.selectedAuthScheme=l+"@@@"+z+"@@@customtoken";a="customtoken"}}}};this.clearSessionStorage=function(B){B=typeof B.data=="undefined"?B:B.data;if(B=="oauth2"){sessionStorage.removeItem("apisOAuth2CredentialsDetails");localStorage.removeItem("apisOAuth2CredentialsDetails");m=null;jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Set...").attr("title","Set OAuth 2 credentials.");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","none")}else{if(B=="basicauth"){f="";n="";sessionStorage.removeItem("apisBasicAuthDetails");localStorage.removeItem("apisBasicAuthDetails");jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html("Set...").attr("title","Set basic auth credentials.");jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","none")}else{if(B=="customtoken"){sessionStorage.removeItem("revisionsCustomTokenCredentialsDetails");jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Set...").attr("title","Set custom token credentials.");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","none");b=false}}}Apigee.APIModel.initMethodsAuthDialogsEvents()}};Apigee.APIModel.Methods.prototype=new Apigee.APIModel.Common;Apigee.APIModel.InlineEdit=function(){var n=this;var a=0;var h;var d=window.location.href;var c=null;var m="";var b=false;var o=false;var e="method";var k=false;function l(){sessionStorage.removeItem("basicAuth1");sessionStorage.removeItem("userEmail1")}function f(u,r){var s;var p;var t="";templateParamAvailable=false;if(u=="general"){s="[data-role='query-param-list'][data-scope='method'], [data-role='header-param-list'][data-scope='method']";if(r=="resource"){s="[data-role='query-param-list'][data-scope='resource'], [data-role='header-param-list'][data-scope='resource']"}var q="[data-scope='method']";if(r=="resource"){q="[data-scope='resource']"}jQuery("[data-role='template-params']").find(q).each(function(v){templateParamAvailable=true;t+='{"name" :"'+jQuery(this).find("[data-role='name']").text()+'",';t+='"description" :"'+jQuery(this).find("[data-role='description']").text()+'",';if(jQuery(this).find("[data-role='required']").length){t+='"required" : '+jQuery(this).find("[data-role='required']").text()+","}if(jQuery(this).find("[data-role='defaultValue']").length){t+='"defaultValue" :"'+jQuery(this).find("[data-role='defaultValue']").text()+'",'}t+='"type" :"TEMPLATE",';t+='"dataType" :"string"}';var w=jQuery("[data-role='template-params']").find(q).length;if(w>v+1){t+=","}})}else{if(u=="body"){s="[data-role='body-param-list'][data-scope='method']";if(r=="resource"){s="[data-role='body-param-list'][data-scope='resource']"}p="BODY"}else{if(u=="attachments"){s="[data-role='attachments-list']"}}}if(templateParamAvailable){t+=","}jQuery(s).each(function(w){var z=jQuery(this);p=u;if(u=="general"){p=z.attr("data-role")=="query-param-list"?"QUERY":"HEADER"}var x=z.children(".title").find("[data-role='required']").text().indexOf("required")!=-1?true:false;var y;var v;if(z.find("div.title input[data-role='value']").length){y=jQuery.trim(z.find("div.title input[data-role='value']").val())}else{y=jQuery.trim(z.find("div.title span[data-role='name']").text())}if(z.find("div.description textarea").length){v=jQuery.trim(z.find("div.description textarea").val())}else{v=jQuery.trim(z.find("[data-role='description']").html());if(c.is(z.find("[data-role='description']"))){v=jQuery.trim(z.find("[data-role='description']").text())}}v=JSON.stringify(v);v=v.substring(1,v.length-1);v=n.escapeSpecialChars(v);t+='{"name" :"'+y+'",';t+='"description" :"'+v+'",';t+='"required" : '+x+",";if(u=="attachments"){t+='"sampleFileUrl" : "'+jQuery.trim(z.find("[data-role='value']").attr("data-sample-file-url"))+'",';t+='"contentDisposition" : "'+jQuery.trim(z.find("[data-role='value']").attr("data-content-disposition"))+'"}'}else{t+='"type" :"'+p+'",';t+='"defaultValue" :"'+z.find("[data-role='value']").val()+'",';t+='"dataType" :"string"}'}var A=jQuery(s).length;if(A>w+1){t+=","}});return t}function j(p){var q=jQuery("[data-role='param-groups'][data-scope='"+p+"']");var r="";if(q.length){q.each(function(s,t){var u=jQuery(this);r+="{";if(u.find("[data-role='maxChoice']").length){r+=' "maxChoice" : '+parseInt(u.find("[data-role='maxChoice']").text())}if(u.find("[data-role='minChoice']").length){r+=u.find("[data-role='maxChoice']").length?",":"";r+='"minChoice" : '+parseInt(u.find("[data-role='minChoice']").text())}r+=', "parameters" : [ ';if(u.find("[data-role='param-group-list']").length){u.find("[data-role='param-group-list']").each(function(w,z){var A=jQuery(this);var x=jQuery.trim(A.find("[data-role='name']").text());var C=jQuery.trim(A.find("[data-role='value']").val());var y=jQuery.trim(A.find("[data-role='type']").text());y=y.toUpperCase();var v;if(A.find("div.description textarea").length){v=jQuery.trim(A.find("div.description textarea").val())}else{v=jQuery.trim(A.find("div.description").text())}v=JSON.stringify(v);v=v.substring(1,v.length-1);v=n.escapeSpecialChars(v);r+='{"name" :"'+x+'",';r+='"defaultValue" :"'+C+'",';r+='"type" :"'+y+'",';r+='"description" :"'+v+'",';r+='"dataType" :"string"}';var B=u.find("[data-role='param-group-list']").length;if(B>w+1){r+=","}});r+="]"}r+="}";if(q.length>s+1){r+=","}})}return r}function i(w,s){var t=jQuery.trim(w.find("[data-role='name']").text());var r="";var v;if(w.attr("data-role")=="query-param-list"){r="QUERY";v=s.parameters}else{if(w.attr("data-role")=="header-param-list"){r="HEADER";v=s.parameters}else{if(w.attr("data-role")=="body-param-list"){r="BODY";if(s.body){v=s.body.parameters}}else{if(w.attr("data-role")=="attachments-list"){r="ATTACHMENT";if(s.body){v=s.body.attachments}}else{if(w.attr("data-role")=="response_errors_list"){r="ERRORS";if(s.response){v=s.response.errors}}}}}}if(v){for(var q=0,p=v.length;q<p;q++){var u=v[q];if(r=="QUERY"||r=="HEADER"){if(u.name==t&&u.type==r){w.find("[data-role='description']").html(u.description)}}else{if(u.name==t){w.find("[data-role='description']").html(u.description)}}}}}function g(){if(localStorage.orgAdminBasicAuthDetails){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='edit_auth_modal']").find(".modal-footer p input").length){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='edit_auth_modal']").modal("show")}this.init=function(p){a=p;if(sessionStorage.orgAdminBasicAuthDetails||localStorage.orgAdminBasicAuthDetails){n.showAdminAuthenticationSection()}else{g()}Apigee.APIModel.initInlineEditAdminAuthEvents()};this.saveAuthModal=function(){var t=n.validateBasicAuthFields("edit_auth_modal");if(t==""){var s=window.location.href;var p="password="+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val());if(Apigee.APIModel.authUrl!="null"){var q=Apigee.APIModel.authUrl.replace("{user}",encodeURIComponent(userEmail));var r=[];r.push({name:"Content-Type",value:"application/x-www-form-urlencoded"});n.makeAJAXCall({url:Apigee.APIModel.proxyURL+"?targeturl="+q,type:"post",dataType:"json",data:p,callback:n.saveAdminCredentials,errorCallback:n.showUnauthorizedInfo,headers:r})}else{n.saveAdminCredentials()}}else{jQuery("[data-role='edit_auth_modal'] .error_container").html(t+"Please try again.").show()}};this.saveAdminCredentials=function(){h="Basic "+jQuery.base64Encode(userEmail+":"+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val()));var q=jQuery("[data-role='edit_auth_modal']").find("#chk_remember").is(":checked");if(q){var p=new Date;var r=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear();localStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail+"@@@"+r}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail}n.closeAuthModal();n.showAdminAuthenticationSection()};this.showUnauthorizedInfo=function(p){if(p=="401"){jQuery("[data-role='edit_auth_modal'] .error_container").html("Invalid credentials. Please try again.").show()}else{jQuery("[data-role='edit_auth_modal'] .error_container").html("Error saving details. Please try again.").show()}};this.showAdminAuthenticationSection=function(){var v="";if(localStorage.orgAdminBasicAuthDetails){var q=new Date;var s=q.getMonth()+1+"/"+q.getDate()+"/"+q.getFullYear();var r=localStorage.orgAdminBasicAuthDetails.split("@@@")[2];var p=s;var u=parseInt(n.dateDiff(new Date(p),new Date(r)));if(u>30){localStorage.removeItem("orgAdminBasicAuthDetails");g()}else{v=localStorage.orgAdminBasicAuthDetails}}else{if(sessionStorage.orgAdminBasicAuthDetails){v=sessionStorage.orgAdminBasicAuthDetails}}if(v!==""){h=v.split("@@@")[0];var t=v.split("@@@")[1];jQuery(".admin_auth_section a.auth_admin_email").html(t).show();jQuery(".admin_auth_section .icon-remove").css("display","inline-block");jQuery(".admin_auth_section").show().removeClass("hide")}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.removeItem("orgAdminBasicAuthDetails");jQuery(".admin_auth_section a.auth_admin_email").html("").hide();jQuery(".admin_auth_section .icon-remove").hide();jQuery(".admin_auth_section").show().removeClass("hide")}if(!o){n.constructEditMode()}};this.clearAdminAuthDetails=function(){l();jQuery(this).siblings("a.auth_admin_email").html("").hide();jQuery(this).hide()};this.reOpenAdminAuthDetails=function(){o=true;l();g();Apigee.APIModel.initInlineEditAdminAuthEvents()};this.constructEditMode=function(){jQuery("#method_content").addClass("edit_mode");var r='<a class="allow_edit hover"></a><a class="allow_edit ok" title="save and quit."></a><a class="allow_edit cancel" title="reset and quit."></a>';jQuery(".edit_mode .resource_details").parent().addClass("clearfix");jQuery(".edit_mode .resource_details").children("div").addClass("clearfix");jQuery("[data-role='method-title']").parent().append(r).addClass("clearfix");jQuery(".description_container").addClass("clearfix");jQuery("ul.method_table").parent().css({clear:"both"});if(jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list'] ").length){jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(t,u){jQuery(this).find("[data-role='description']").parent().append(r)})}jQuery(".description_container").append('<textarea class="resource_description_edit">'+jQuery("[data-role='method-description']").html()+"</textarea>"+r);var s=jQuery("[data-role='request-payload-docs']");s.wrap("<div class='clearfix'></div>");s.attr("data-allow-edit","true");s.parent().append('<textarea class="request_payload_doc_edit"></textarea>'+r);var q=jQuery("[data-role='request-payload-example']");q.wrap("<div class='clearfix'></div>");q.attr("data-allow-edit","true").width("90%").css({float:"left"});q.parent().append(r);var p=jQuery("[data-role='response-payload-docs']");p.wrap("<div class='clearfix'></div>");p.attr("data-allow-edit","true");p.parent().append('<textarea class="response_payload_doc_edit"></textarea>'+r);Apigee.APIModel.inlineEditPageEvents()};this.handleEditPropertiesMouseOver=function(){var p=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).addClass("edit");jQuery(this).siblings("a.allow_edit.hover").css({display:"inline-block"})}};this.handleEditPropertiesMouseOut=function(){var p=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).removeClass("edit");jQuery(this).siblings("a.allow_edit.hover").hide()}};this.handleEditableElementsClick=function(r){var p=false;if(c){if(jQuery(this).attr("data-role")=="description"&&!c.is(jQuery(this))){p=true}else{p=c.attr("data-role")!=jQuery(this).attr("data-role")}}jQuery("[data-role='error_container']").hide().html("");if(m!=""&&b&&c!=null&&p){var q=jQuery.trim(c.text());if(c.siblings("textarea").length){q=jQuery.trim(c.siblings("textarea").val())}if(m!=q){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}else{if(!c.is(jQuery(this))){n.resetEditableElement()}}}else{c=jQuery(this);if(!k&&jQuery(this).attr("data-role")=="description"){c.text(c.html());k=true}m=jQuery.trim(jQuery(this).text());if(jQuery(this).hasClass("resource_description")||jQuery(this).attr("data-role")=="request-payload-docs"||jQuery(this).attr("data-role")=="response-payload-docs"){m=jQuery.trim(jQuery(this).html());jQuery(this).hide();jQuery(this).siblings("textarea").val(jQuery.trim(jQuery(this).html())).height(jQuery(this).height()+30).show();jQuery(this).siblings("textarea").focus();jQuery(this).siblings("textarea").unbind("click").click(function(){return false});Apigee.APIModel.initInlineEditAdminAuthEvents()}if(jQuery(this).attr("data-role")=="method-title"||jQuery(this).attr("data-role")=="description"){jQuery(this).attr("contenteditable","true")}else{jQuery("[data-role='method-title']").removeAttr("contenteditable")}jQuery(this).addClass("editing");jQuery(this).siblings("a.allow_edit.hover").hide();jQuery(this).siblings("a.allow_edit.ok").show();jQuery(this).siblings("a.allow_edit.cancel").show();jQuery(this).addClass("edit");b=true;jQuery(this).focus()}r.preventDefault();return false};this.resetEditableElement=function(){k=false;b=false;c.removeClass("editing");c.siblings("a.allow_edit").hide();c.html(m);if(c.attr("data-role")=="description"){c.html(m)}if(c.attr("data-role")=="method-description"){jQuery("textarea.resource_description_edit").val(m)}c.removeClass("edit").removeClass("editing");if(c.hasClass("resource_description")||c.attr("data-role")=="request-payload-docs"||c.attr("data-role")=="response-payload-docs"){c.siblings("textarea").hide();c.show()}m="";return false};this.documentClickHandler=function(){k=false;if(c){c.removeClass("editing")}if(m!=""&&jQuery("body").children("[role='dialog'].modal").is(":visible")==false){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}};this.handleConfirmDialogSave=function(){k=false;c.siblings("a.allow_edit.ok").trigger("click");n.closeAuthModal();Apigee.APIModel.initInlineEditAdminAuthEvents();m="";return false};this.makeAPICall=function(F){var r=location.href;b=false;c.removeClass("editing");var B="";if(c.attr("data-role")=="description"&&c.parent().parent().attr("data-scope")=="resource"){e="resource";r=r.split("/methods/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){r=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}if(Apigee.APIModel.apiModelBaseUrl){r=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}B+='{"parameters": ['+f("general","resource")+" ]";B+=', "parameterGroups": [ '+j("resource")+" ]}"}else{e="method";r=r.split("/doc?")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){r=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}if(Apigee.APIModel.apiModelBaseUrl){r=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}var p=jQuery.trim(jQuery("textarea.resource_description_edit").val());if(c.attr("data-role")!="method-description"){p=jQuery.trim(jQuery(".resource_description ").html())}var G=jQuery("[data-role='auth-type']").text();G=G.replace("Basic Auth","BASICAUTH").replace("Custom Token","CUSTOM").replace("OAuth 1","OAUTH1WEBSERVER").replace("OAuth 1 Client Credentials","OAUTH1CLIENTCREDENTIALS").replace("OAuth 2","OAUTH2WEBSERVER").replace("OAuth 2 Client Credentials","OAUTH2CLIENTCREDENTIALS").replace("OAuth 2 Implicit Grant Flow","OAUTH2IMPLICITGRANT").replace("No auth","NOAUTH");var z="";if(G.split(",").length>1){z="[";for(var E=0;E<G.split(",").length;E++){z+='"'+G.split(",")[E]+'"';if(E!=G.split(",").length-1){z+=","}}z+="]"}else{z='[ "'+G+'" ]'}var x=jQuery.trim(jQuery("[data-role='category']").text());var A="";if(A.split(",").length>1){A="[";for(var E=0;E<x.split(",").length;E++){A+='"'+x.split(",")[E]+'"';if(E!=x.split(",").length-1){A+=","}}A+="]"}else{A='[ "'+x+'" ]'}p=JSON.stringify(p);p=p.substring(1,p.length-1);p=n.escapeSpecialChars(p);B='{ "displayName":"'+jQuery.trim(jQuery("[data-role='method-title']").html())+'", "description": "'+p+'","verb": "'+jQuery.trim(jQuery("[data-role='verb']").text())+'",';B+='"authSchemes" : '+z+', "tags" : '+A;var u="";if(jQuery.trim(jQuery("[data-role='content-type']").text())!="N.A."){u=jQuery.trim(jQuery("[data-role='content-type']").text())}var v=f("general");if(v.length){if(v.charAt(v.length-1)===","){v=v.substring(0,v.length-1)}B+=', "parameters": ['+v+" ]"}B+=', "parameterGroups": [ '+j("method")+" ]";B+=', "body": {';B+='"parameters": [';B+=f("body");B+=" ]";B+=', "attachments": [';B+=f("attachments");B+=" ]";B+=', "contentType":"'+u+'"';if(jQuery('[data-role="request-payload-example"]').length){var s=JSON.stringify(window.apiModelEditor.getRequestPayLoad());s=s.substring(1,s.length-1);s=n.escapeSpecialChars(s);B+=', "sample" :"'+s+'"'}var y=jQuery("[data-role='request-payload-docs']");var H=jQuery("[data-role='response-payload-docs']");var t="";var C="";if(y.length){var t=jQuery.trim(y.html());if(y.siblings("textarea").is(":visible")==true){t=jQuery.trim(y.siblings("textarea").val())}t=JSON.stringify(t);t=t.substring(1,t.length-1);t=n.escapeSpecialChars(t);t=', "doc": "'+t+'" ';B+=t}B+=" }";var q=jQuery("[data-role='response_errors_list']");if(H.length||q.length){B+=', "response": {';if(H.length){var C=jQuery.trim(H.html());if(H.siblings("textarea").is(":visible")==true){C=jQuery.trim(H.siblings("textarea").val())}C=JSON.stringify(C);C=C.substring(1,C.length-1);C=n.escapeSpecialChars(C);var D=JSON.stringify(jQuery("[data-role='response-payload']").val());D=D.substring(1,D.length-1);D=n.escapeSpecialChars(D);B+='"doc": "'+C+'"  ,"sample" : "'+D+'", "contentType" : "'+jQuery("[data-role='response-content-type']").text()+'"'}if(q.length){var v="";jQuery(q).each(function(J){var I=jQuery(this);v+='{"httpStatusCode" :"'+jQuery.trim(I.find("[data-role='http_status_code']").html())+'",';v+='"code" : "'+jQuery.trim(I.find("[data-role='code']").html())+'",';v+='"description" :"'+jQuery.trim(I.find("[data-role='description']").html())+'"}';var K=jQuery(q).length;if(K>J+1){v+=","}});if(H.length){B+=","}B+='"errors" : ['+v+"]"}B+="}"}B+="}"}var w=[];if(localStorage.orgAdminBasicAuthDetails){if(h!=localStorage.orgAdminBasicAuthDetails.split("@@@")[0]){h=localStorage.orgAdminBasicAuthDetails.split("@@@")[0];jQuery(".admin_auth_section a.auth_admin_email").html(localStorage.orgAdminBasicAuthDetails.split("@@@")[1])}}w.push({name:"Authorization",value:h});w.push({name:"Content-Type",value:"application/json"});jQuery("#working_alert").fadeIn();r=Apigee.APIModel.proxyURL+"?targeturl="+r;n.makeAJAXCall({url:r,type:"put",dataType:"json",headers:w,data:B,callback:n.handleAPICallSuccess,errorCallback:n.handleUpdateFailure});jQuery(this).siblings("[contenteditable='true']").removeClass("edit");jQuery(this).siblings("a.allow_edit.cancel").hide();jQuery(this).siblings("a.allow_edit.ok").hide();if(jQuery(this).siblings("textarea").is(":visible")){jQuery(this).siblings("textarea").hide();jQuery(this).siblings("[data-allow-edit='true']").html(jQuery(this).siblings("textarea").val()).removeClass("edit").removeClass("editing").show()}jQuery(this).hide();F.stopPropagation();return false};this.handleAPICallSuccess=function(r){k=false;r=unescape(r.responseContent);r=JSON.parse(r);m=jQuery.trim(c.html());jQuery("[data-role='method-title']").html(r.displayName);jQuery("[data-role='method-description']").html(r.description);jQuery("[data-role='query-param-list'], [data-role='header-param-list'], [data-role='body-param-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(s){i(jQuery(this),r)});if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var p=window.location.href;var q=p=p.replace("?editMode=1","?flush=1").replace("?editMode=2","?flush=1");n.makeAJAXCall({url:q,callback:n.drupalUpdateSuccess})}m=""};this.drupalUpdateSuccess=function(){};this.handleUpdateFailure=function(){n.resetEditableElement();n.showError("Error saving changes.")}};Apigee.APIModel.InlineEdit.prototype=new Apigee.APIModel.Common;