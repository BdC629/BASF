Apigee.APIModel.Common=function(){var j=this;var a;var c='<button aria-hidden="true" data-dismiss="modal" class="close button_close_modal" type="button">x</button>';var b="<h3>Set Authentication</h3>";var d="<h3>Set Organization Admin Credentials</h3>";var f="<h3>Warning</h3>";var g="<h3>Custom Token</h3>";if(typeof apiName!="undefined"){var i="<h3>Request "+apiName+" permissions</h3>"}var k="<p>Your credentials are saved for the session only.</p>";var e='<a class="btn btn-primary button_save_modal" href="javascript:void(0)">Save</a><a class="button_close_modal" href="javascript:void(0)">Cancel</a>';var h=e.replace("Cancel","Discard");validateEmail=function(n){var l=false;if(jQuery.trim(n).length>1){var m=RegExp(/^[a-zA-Z0-9_]{0,1}([a-zA-Z0-9_\.\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~])+([a-zA-Z0-9_\-\+\&\/\$\!\#\%\'\*\=\?\^\`\{\|\}\~]{0,1})+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);if(m.test(n)){if(n.indexOf("..")==-1){l=true}}}return l};navigator.sayswho=function(){var n=navigator.appName,m=navigator.userAgent,l;var o=m.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(o&&(l=m.match(/version\/([\.\d]+)/i))!=null){o[2]=l[1]}o=o?[o[1],o[2]]:[n,navigator.appVersion,"-?"];return o}();this.makeAJAXCall=function(l){jQuery.ajax({url:l.url,cache:false,type:l.type?l.type:"get",data:l.data?l.data:null,contentType:l.contentType?l.contentType:"application/x-www-form-urlencoded;charset=utf-8",beforeSend:function(o){if(l.headers){for(var n=0,m=l.headers.length;n<m;n++){var p=l.headers[n];o.setRequestHeader(p.name,p.value)}}},success:function(o,p,n){if(l.dataType!="json"){l.callback(n.responseText)}else{if(o){var m=o.responseStatusCode;if(m){if(parseInt(m)>=400){if(l.errorCallback){l.errorCallback(m);return}else{l.callback(o);return}}}}l.callback(o)}},error:function(o,m,n){if(l.errorCallback){l.errorCallback(o.status)}else{l.callback(o.responseText)}},complete:function(){jQuery("#working_alert").fadeOut()}})};this.closeAuthModal=function(){jQuery("#modal_container.modal").modal("hide");jQuery("#modal_container.modal input").removeClass("error");jQuery("#modal_container.modal .error_container").hide().html("")};this.validateBasicAuthFields=function(m){var n="";userEmail=jQuery.trim(jQuery("[data-role='"+m+"']").find("#inputEmail").val());if(!userEmail.length){jQuery("#inputEmail").addClass("error");n+="<span>Email/Username required.</span><br/>"}var l=jQuery("[data-role='"+m+"']").find("#inputPassword");if(!jQuery.trim(l.val()).length){l.addClass("error");n+="<span>Password required.</span><br/>"}return n};this.shortenText=function(n,l){var m=n.text();if(m.length>l){m=m.substring(0,l-3)+"...";n.text(m)}};this.parseAndReturn=function(l){var n="";try{n=jQuery.parseJSON(l)}catch(m){n=l}return n};this.getQueryParam=function(n,p){var l=n.split("?");if(l.length>2){l=n.split(/\?(.*)/)}if(l.length>1){l=l[1];l=l.split("&");for(var m=0;m<l.length;m++){var o=l[m].split("=");if(o[0]==p){return o[1]}}return""}return""};this.escapeSpecialChars=function(l){return l.replace(/\\n/g,"\\n").replace(/'/g,"'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")};this.showError=function(l){jQuery("[data-role='error_container']").html(l).show();jQuery("body").scrollTop(0)};this.showUnsupportedBrowserAlertMessage=function(){var m=navigator.sayswho.toString();var o=m.split(",")[0].toLowerCase();var l=parseInt(m.split(",")[1]);if(o!="chrome"){if(o=="firefox"){if(l<10){n()}}if(o=="safari"){if(l<6){n()}}if(o=="msie"){if(l<10){n()}}}function n(){theParent=document.getElementsByTagName("body")[0];theKid=document.createElement("div");theKid.setAttribute("style","height:20px;width:100%;background-color:#F9F6C5;text-align:center;position:fixed;");theKid.innerHTML="<p>You are using an unsupported browser. Please switch to Chrome, Firefox >= 10, Safari >= 6 or Internet Explorer 11. [ <a href='javascript:void(0)' onclick='apiModelCommon.hideUnsupportedBrowserMessage()'> Close</a> ]</p>";theParent.appendChild(theKid);theParent.insertBefore(theKid,theParent.firstChild)}};this.hideUnsupportedBrowserMessage=function(){document.getElementsByTagName("body")[0].getElementsByTagName("div")[0].style.display="none";localStorage.setItem("unsupportedBrowserFlag","true")};this.dateDiff=function(m,l){var n=m.getTime()-l.getTime();return n/(24*60*60*1e3)}};Apigee.APIModel.Editor=function(){var a;this.initRequestPayloadEditor=function(){if(jQuery('[data-role="request-payload-example"]').length){jQuery('[data-role="request-payload-example"]').children("textarea").show();bodyPayloadElementValue=jQuery.trim(jQuery('[data-role="request-payload-example"]').find("textarea").val());jQuery(".request_payload textarea").val(bodyPayloadElementValue);bodyPayloadElement=jQuery(".request_payload textarea");if(bodyPayloadElement){var b=bodyPayloadElement.data("format")=="application/xml"?"xml":"javascript";a=CodeMirror.fromTextArea(jQuery(".request_payload textarea").get(0),{mode:b,lineNumbers:true});if(a.lineCount()<=2){a.setSize("100%",a.lineCount()*18)}else{a.setSize("100%",a.lineCount()*15)}}}};this.getRequestPayLoad=function(){return a.getValue()};this.setRequestPayLoad=function(b){a.setValue(b)}};Apigee.APIModel.Methods=function(){var o=this;var i=["January","February","March","April","May","June","July","August","September","October","November","December"];var x;var c;var f="";var n="";var w;var u="";var q;var p=false;var z=[];var j=false;var s=[];var r=false;var g=[];var h;var v;var m={};var e={};var b=false;var k="";var a="";var t=window.location.href;var l=Apigee.APIModel.apiName;var y=Apigee.APIModel.revisionNumber;var d="";this.init=function(){var G=jQuery("[data-role='auth-type']");w=jQuery.trim(G.text());if(w.split(",").length>1){w=w.substr(0,w.length-1)}w=w.replace("BASICAUTH","Basic Auth").replace("CUSTOM","Custom Token").replace("OAUTH1WEBSERVER","OAuth 1").replace("OAUTH1CLIENTCREDENTIALS","OAuth 1 Client Credentials").replace("OAUTH2WEBSERVER","OAuth 2").replace("OAUTH2CLIENTCREDENTIALS","OAuth 2 Client Credentials").replace("OAUTH2IMPLICITGRANT","OAuth 2 Implicit Grant Flow").replace("NOAUTH","No auth");G.html(w);o.updateAuthContainer();var I="";jQuery("[data-role='method_url_container'] span").each(function(){I+='<span data-role="'+jQuery(this).attr("data-role")+'">'+jQuery(this).html()+"</span>"});jQuery("[data-role='method_url_container']").html(I);c=jQuery("[data-role='method_url_container']");c.html(c.html().replace(/\{/g,"<span data-toggle='tooltip' data-original-title=''><span class='template_param' contenteditable='true'>{").replace(/\}/g,"}</span><span></span></span>"));c.find("span.template_param").each(function(){jQuery(this).siblings("span").attr("data-role",jQuery(this).text())});jQuery("[data-role='template-params']").find("p").each(function(){var K=jQuery(this).find("[data-role='name']").html();var J=jQuery(this).find("[data-role='description']").html();jQuery("[data-toggle='tooltip']").each(function(){var L=jQuery(this).find("span:eq(1)").data("role");if(L){L=L.substring(1,L.length-1);if(L==K){J=jQuery.trim(J);if(J.charAt(J.length-1)!="."){J+="."}jQuery(this).attr("data-original-title",J+" Click to edit the value.")}}})});if(localStorage.hasOwnProperty("templateParams")){var E=JSON.parse(localStorage.getItem("templateParams"));for(var D=0;D<E.length;D++){var F=E[D].name;var B=E[D].value;jQuery("[data-role='method_url_container'] span.template_param").each(function(){var J=jQuery(this).siblings("span");var K=jQuery(this);if(J.attr("data-role")==F){K.text(jQuery.trim(B))}})}}jQuery("[data-role='query-param-list'],[data-role='header-param-list']").each(function(J,K){var L=jQuery(this).find("[data-role='value']");L.attr("data-original-value",jQuery.trim(L.val()))});var A=jQuery("[data-role='category']");var C=jQuery.trim(A.text());if(C.split(",").length>1){C=C.substr(0,C.length-1)}A.html(C);if(jQuery("[data-role='request-payload-docs']").length&&!jQuery("[data-role='request-payload-example']").length){jQuery("[data-role='request-payload-docs']").show()}jQuery("#working_alert").css("left",jQuery(window).width()/2-56);jQuery("#method_content").show();window.apiModelEditor.initRequestPayloadEditor();var H=t.split("/apimodels/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){H=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName}if(Apigee.APIModel.apiModelBaseUrl){H=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName}H=H+"/apimodels/proxyUrl";o.makeAJAXCall({url:H,callback:o.storeProxyURL});Apigee.APIModel.initMethodsPageEvents();Apigee.APIModel.initMethodsAuthDialogsEvents()};this.storeProxyURL=function(A){A=jQuery.parseJSON(A);Apigee.APIModel.proxyURL=A.proxyUrl;Apigee.APIModel.authUrl=A.authUrl;if(Apigee.APIModel.proxyURL.indexOf("/sendrequest")==-1){Apigee.APIModel.proxyURL=Apigee.APIModel.proxyURL+"/sendrequest"}};this.renderCallbackURL=function(A){if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var C=A.authUrl.split("redirect_uri=")[0];var B=A.authUrl.split("redirect_uri=")[1];B=C+"redirect_uri="+encodeURIComponent(Drupal.settings.smartdocs.oauth2AuthUrl+"?org="+Apigee.APIModel.organizationName+"&api="+Apigee.APIModel.apiName+"&revision="+Apigee.APIModel.revisionNumber)+"&client_id="+B.split("client_id=")[1];window.open(B,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}else{window.open(A.authUrl,"oauth2Window","resizable=yes,scrollbars=yes,status=1,toolbar=1,height=500,width=500")}};this.handleOAuth2Failure=function(){o.showError("Unable to proceed because of missing OAuth configuration.")};this.renderCustomTokenCredentials=function(F){var A=F;var J=A.tokenType;var D=Object.keys(A.tokenMap).length;jQuery("[data-role='custom_token_row']").each(function(K){if(K>0){$(this).remove()}});if(D>=1){for(var G=1,C=D;G<C;G++){jQuery("[data-role='custom_token_row']").first().clone().appendTo("[data-role='custom_token_rows']")}}var H=1;for(var I in A.tokenMap){var E=I;var B=A.tokenMap[I];jQuery("[data-role='custom_token_row']:nth-child("+H+")").find("[data-role='name']").val(E);jQuery("[data-role='custom_token_row']:nth-child("+H+")").find("[data-role='value']").val(B);H++}if(J=="header"){jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked","checked")}else{jQuery("[data-role='custom_token_modal']").find("[data-role='query']").attr("checked","checked")}};this.handleCustomTokenFailure=function(){o.showError("Unable to proceed because of missing Custom token configuration.")};this.updateTemplateParamWidth=function(B,D){var C=B.text();var A=C.length;if(A==0){A=8.4}else{A=Math.ceil(A*8.4)}if(D){B.css("width",A)}else{B.css("width","auto")}};this.updateTemplateParamText=function(B){var C=B.text();var A=C.length;if(A==0){A=8.4;B.html("&nbsp;")}else{A=Math.ceil(A*8.4);if(B.html().indexOf("&nbsp;")!=-1){B.slice(B.html().indexOf("&nbsp;"),B.html().indexOf("&nbsp;")+1)}}};this.updateAuthContainer=function(){if(w.indexOf("No auth")!=-1){jQuery("[data-role='authentication_container']").css({visibility:"hidden"});jQuery(".icon_lock").css({visibility:"hidden"})}else{if(w.indexOf("Basic Auth")!=-1){if(w.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@basicauth";a="basicauth"}var E="";if(localStorage.apisBasicAuthDetails){var B=new Date;var H=B.getMonth()+1+"/"+B.getDate()+"/"+B.getFullYear();var D=localStorage.apisBasicAuthDetails.split("@@@")[3];var I=H;var G=I-D;var G=parseInt(o.dateDiff(new Date(I),new Date(D)));if(G>30){localStorage.removeItem("apisBasicAuthDetails")}else{E=localStorage.apisBasicAuthDetails}}else{if(sessionStorage.apisBasicAuthDetails){E=sessionStorage.apisBasicAuthDetails}}if(E!==""){if(l==E.split("@@@")[0]){n=E.split("@@@")[1];var F=n;if(F.length>12){F=F.substring(0,12)+"..."}f=E.split("@@@")[2];var C=l==sessionStorage.selectedAuthScheme.split("@@@")[0]&&y==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="basicauth"?"selected":"";if(C!=""){jQuery("[data-role='basic_auth_container']").addClass(C)}jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(F);jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='basic_auth_container']").show()}if(w.indexOf("OAuth 2")!=-1){if(w.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@oauth2";a="oauth2"}var J="";if(localStorage.apisOAuth2CredentialsDetails){var B=new Date;var H=B.getMonth()+1+"/"+B.getDate()+"/"+B.getFullYear();var D=localStorage.apisOAuth2CredentialsDetails.split("@@@")[2];var I=H;var G=I-D;var G=parseInt(o.dateDiff(new Date(I),new Date(D)));if(G>30){localStorage.removeItem("apisBasicAuthDetails")}else{J=localStorage.apisOAuth2CredentialsDetails}}else{if(sessionStorage.apisOAuth2CredentialsDetails){J=sessionStorage.apisOAuth2CredentialsDetails}}if(J!==""){if(l==J.split("@@@")[0]){m=jQuery.parseJSON(J.split("@@@")[1]);var C=l==J.split("@@@")[0]&&sessionStorage.selectedAuthScheme.split("@@@")[1]=="oauth2"?"selected":"";if(C!=""){jQuery("[data-role='oauth2_container']").addClass(C)}jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Authenticated");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='oauth2_container']").show()}if(w.indexOf("Custom Token")!=-1){if(w.indexOf(",")==-1){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@customtoken";a="customtoken"}var A=sessionStorage.revisionsCustomTokenCredentialsDetails;if(A){if(l==A.split("@@@")[0]&&y==A.split("@@@")[1]){e=JSON.parse(A.split("@@@")[2]);var C=l==sessionStorage.selectedAuthScheme.split("@@@")[0]&&y==sessionStorage.selectedAuthScheme.split("@@@")[1]&&sessionStorage.selectedAuthScheme.split("@@@")[2]=="customtoken"?"selected":"";if(C!=""){jQuery("[data-role='custom_token_container']").addClass(C)}jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Custom Token");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","inline-block")}}jQuery("[data-role='custom_token_container']").show()}Apigee.APIModel.initMethodsAuthDialogsEvents()}};this.swapSampleRequestResponseContainer=function(){var A=jQuery(this);if(A.attr("id")=="link_request_tab"){jQuery("#link_response_tab").removeClass("selected");jQuery("#request_response_container .response").hide();jQuery("#request_response_container .request").show()}else{jQuery("#link_request_tab").removeClass("selected");jQuery("#request_response_container .request").hide();jQuery("#request_response_container .response").show()}A.addClass("selected")};this.saveAuthModal=function(F){var E=jQuery(this).parents(".modal");if(E.attr("data-role")=="basic_auth_modal"){var G=o.validateBasicAuthFields("basic_auth_modal");if(G==""){n=jQuery("#inputEmail").val();f="Basic "+jQuery.base64Encode(n+":"+jQuery("#inputPassword").val());var B=jQuery("[data-role='basic_auth_modal']").find("#chk_remember").is(":checked");if(B){var A=new Date;var D=A.getMonth()+1+"/"+A.getDate()+"/"+A.getFullYear();localStorage.apisBasicAuthDetails=l+"@@@"+n+"@@@"+f+"@@@"+D}else{localStorage.removeItem("apisBasicAuthDetails");sessionStorage.apisBasicAuthDetails=l+"@@@"+n+"@@@"+f}o.closeAuthModal();sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@basicauth";a="basicauth";o.updateAuthContainer()}else{jQuery("#modal_container.modal .error_container").html(G+"Please try again.").show()}}else{if(E.attr("data-role")=="oauth2_modal"){var C=window.location.href;C=t.split("/resources/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){C=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}if(Apigee.APIModel.apiModelBaseUrl){C=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber}o.closeAuthModal();o.makeAJAXCall({url:C+"/authschemes/oauth2webserverflow/authUrl",dataType:"json",callback:o.renderCallbackURL,errorCallback:o.handleOAuth2Failure})}else{if(E.attr("data-role")=="custom_token_modal"){e={};e.tokenType=jQuery("[data-role='custom_token_modal']").find("[data-role='header']").attr("checked")=="checked"?"header":"query";e.tokenMap={};jQuery("[data-role='custom_token_row']").each(function(){e.tokenMap[jQuery(this).find("[data-role='name']").val()]=jQuery(this).find("[data-role='value']").val()});sessionStorage.revisionsCustomTokenCredentialsDetails=l+"@@@"+y+"@@@"+JSON.stringify(e);o.closeAuthModal();sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@customtoken";a="customtoken";o.updateAuthContainer()}}}};this.getCustomTokenCredentials=function(){if(!b){t=t.split("/resources/")[0];o.makeAJAXCall({url:t+"/authschemes/custom",dataType:"json",callback:o.renderCustomTokenCredentials,errorCallback:o.handleCustomTokenFailure});b=true}};this.toggleRequestPayload=function(D){var A=jQuery(this);if(!A.parent().hasClass("active")){A.parent().siblings().removeClass("active");A.parent().addClass("active");var E=A.attr("data-role");var B=jQuery("[data-role='request-payload-docs']");var C=jQuery("[data-role='request-payload-example']");if(B.siblings("textarea").length){B.siblings("textarea").hide();B.siblings("a.allow_edit").hide()}if(C.siblings("a.allow_edit").length){C.siblings("a.allow_edit").hide()}if(E=="docs-link"){C.hide();B.show()}else{B.hide();C.show()}}};this.resetFields=function(){jQuery("[data-role='query-param-list'],[data-role='header-param-list'],[data-role='body-param-list']").find("input").each(function(){jQuery(this).val("")});jQuery("[data-role='query-param-list'],[data-role='header-param-list']").each(function(B,C){var D=jQuery(this).find("[data-role='value']");D.val(D.attr("data-original-value"))});if(jQuery('[data-role="request-payload-example"]').length){var A=jQuery('[data-role="request-payload-example"]').children("textarea").val();window.apiModelEditor.setRequestPayLoad(A)}jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");u="";q=false};this.sendRequest=function(){jQuery("#working_alert").fadeIn();jQuery("#request_response_container .response").html("<p>Make a request and see the response.</p>");jQuery("#request_response_container .request").html("<p>Make a request and see the response.</p>");var C=jQuery("[data-role='method_url_container'] span.template_param");if(C.length>=1){if(localStorage.hasOwnProperty("templateParams")){var H=JSON.parse(localStorage.getItem("templateParams"));jQuery("[data-role='method_url_container'] span.template_param").each(function(){var U=jQuery(this).siblings("span").attr("data-role");var X=jQuery(this).text();if(U==X||X==""||jQuery(this).html()=="&nbsp;"){p=true;z.push(U.substring(1,U.length-1));jQuery(this).addClass("error")}var S=false;for(var T=0;T<H.length;T++){var V=H[T].name;var W=H[T].value;if(U==V){S=true}if(U==V&&X!=W&&X.length){H[T].value=X}}if(!S){H.push({name:U,value:X})}});localStorage.setItem("templateParams",JSON.stringify(H))}else{var D=[];jQuery("[data-role='method_url_container'] input").each(function(){var S=jQuery(this).siblings("span");D.push({name:S.attr("data-role"),value:S.html()})});localStorage.setItem("templateParams",JSON.stringify(D))}}var K=jQuery("[data-role='method_url_container']").text();var M=jQuery.trim(jQuery("[data-role='verb']").text().toLowerCase());var J=[];if(jQuery("[data-role='header-param-list']").length){jQuery("[data-role='header-param-list']").each(function(T,V){var S=jQuery(this).find("[data-role='name']").text();var U;if(jQuery(this).find("[data-role='multiple-value']").length){U=jQuery(this).find("select option:selected").val()}else{U=jQuery(this).find("[data-role='value']").val()}J.push({name:S,value:U});if(jQuery(this).find("span.required").length&&jQuery(this).find("[data-role='value']").val()==""){j=true;s.push(S);jQuery(this).find("[data-role='value']").addClass("error")}})}var A="";if(jQuery("[data-role='query-param-list']").length>=1){var P=true;jQuery("[data-role='query-param-list']").each(function(S,W){var V=jQuery(this).find("[data-role='name']").text();var T;if(jQuery(this).find("[data-role='multiple-value']").length){T=jQuery(this).find("select option:selected").val()}else{T=jQuery(this).find("[data-role='value']").val()}if(jQuery.trim(T).length>=1){var U=P?"":"&";A+=U+V+"="+encodeURIComponent(decodeURIComponent(T));P=false}if(jQuery(this).find("span.required").length&&T==""){r=true;g.push(V);jQuery(this).find("[data-role='value']").addClass("error")}})}if(e.tokenType=="query"){var E=A!=""?"&":"";var G=0;for(var R in e.tokenMap){E=G==0?E:"&";var B=R;var Q=e.tokenMap[R];if(jQuery.trim(B)!=""&&jQuery.trim(Q)!=""){A+=E+B+"="+Q;G++}}}else{for(var R in e.tokenMap){var B=R;var Q=e.tokenMap[R];if(jQuery.trim(B)!=""&&jQuery.trim(Q)!=""){J.push({name:B,value:Q})}}}var N="";K=K.replace(/\{/g,"").replace(/\}/g,"");K=jQuery.trim(K);A=jQuery.trim(A);if(A!=""){var E="?";if(K.indexOf("?")!=-1){E="&"}K=K+E+A}if(p){N+="Missing value for template parameter(s): <span>"+z.join(", ")+"</span></br>"}if(r){N+="Missing value for required query parameter(s):&nbsp;<span>"+g.join(", ")+"</span></br>"}if(j){N+="Missing value for required header parameter(s):&nbsp;<span>"+s.join(", ")+"</span></br>"}if(N!=""){jQuery("body").scrollTop(0);jQuery("[data-role='error_container']").html(N).show();o.clearMissingArray()}if(a=="basicauth"){if(f){if(localStorage.apisBasicAuthDetails&&l==localStorage.apisBasicAuthDetails.split("@@@")[0]){if(f!=localStorage.apisBasicAuthDetails.split("@@@")[2]){f=localStorage.apisBasicAuthDetails.split("@@@")[2];jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html(localStorage.apisBasicAuthDetails.split("@@@")[1])}}J.push({name:"Authorization",value:f})}}else{if(a=="oauth2"&&m!=null){if(localStorage.apisOAuth2CredentialsDetails&&l==localStorage.apisOAuth2CredentialsDetails.split("@@@")[0]){var L=jQuery.parseJSON(localStorage.apisOAuth2CredentialsDetails.split("@@@")[1]);if(L.accessToken!=m.accessToken){m=L}}if(m.accessTokenType=="query"){var F=m.accessToeknParamName==""?"oauth_token":m.accessToeknParamName;var E=A==""?"?":"&";K+=E+F+"="+m.accessToken}else{if(m.accessTokenType=="header"){J.push({name:"Authorization",value:m.accessToken})}}}}d=K;K=encodeURIComponent(K).replace(/\{.*?\}/g,"");K=Apigee.APIModel.proxyURL+"?targeturl="+K;if(jQuery("[data-role='attachments-list']").length){if(jQuery('[data-role="request-payload-example"]').length){var I="<textarea class='hide' name='text'>"+window.apiModelEditor.getRequestPayLoad()+"</textarea>";jQuery("#formAttachment").append(I)}var O=new FormData(jQuery("form")[0]);jQuery.ajax(K,{processData:false,type:"POST",contentType:false,data:O,success:function(T,U,S){o.renderRequest(S.responseText)},error:function(U,S,T){o.renderRequest(U.responseText)},complete:function(){jQuery("#working_alert").fadeOut()}})}else{if(jQuery("[data-role='body-param-list']").length){o.makeAJAXCall({url:K,type:M,data:jQuery("#formAttachment").serialize(),callback:o.renderRequest,headers:J})}else{if(jQuery('[data-role="request-payload-example"]').length){o.makeAJAXCall({url:K,type:M,data:window.apiModelEditor.getRequestPayLoad(),callback:o.renderRequest,headers:J})}else{o.makeAJAXCall({url:K,type:M,callback:o.renderRequest,headers:J})}}}};this.renderRequest=function(R){var F=jQuery("[data-role='response-container']");var D=jQuery("[data-role='request-container']");if(R==""||R==null){D.html("<strong> An internal error has occurred. Please retry your request.</strong>");F.html("<strong> An internal error has occurred. Please retry your request.</strong>");return}R=jQuery.parseJSON(R);u=unescape(R.responseContent);var A="<strong";var J;var G;var P;if(R.responseStatusCode){J=R.responseStatusCode;G=R.httpVersion;P=R.responseReasonPhrase}else{J=R.responseCode;G=R.messageVersion;P=R.responsePharse}if(parseInt(J)>=100&&parseInt(J)<400){A+=" class='success'"}A+="> HTTP/"+G+" "+J+"  "+P+"</strong>";A+="<dl>";for(var M=0;M<R.responseHeaders.length;M++){A+="<dt>";A+=unescape(R.responseHeaders[M].name);A+=": </dt><dd>";A+=unescape(R.responseHeaders[M].value);A+="</dd>"}A+="</dl>";F.html(A);if(u!=""){var N=/^"\{/.test(u)&&/\}"$/.test(u)||/^"\[/.test(u)&&/\]"$/.test(u);if(N){u=u.replace(/^"((.|\s)*)"$/,"$1")}if(u){var I=true;try{var Q=jQuery.parseJSON(u)}catch(O){I=false}if(I){var K=o.parseAndReturn(u);u=JSON.stringify(K,null,2);u=u.replace("[{","[\n  {");u=u.replace(/,\n[\n ]*$/,"");u=u.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");F.append("<pre><code class='language-javascript' id='some-code123'>"+u+"</code></pre>")}else{u=u.replace(/>/g,"&gt;").replace(/</g,"&lt;");F.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+u+"</code></pre>")}}}var L=d.split("//")[1].split("/")[0].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var C=d.split(L)[1].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var B="<strong>"+R.requestVerb+" "+C+" HTTP/"+G+"</strong>";B+="<dl>";for(var M=0;M<R.requestHeaders.length;M++){var H=R.requestHeaders[M].name;if(H.toLowerCase()!="origin"&&H.toLowerCase()!="referer"){var E=R.requestHeaders[M].value;B+="<dt>";B+=unescape(H);B+=": </dt><dd>";B+=unescape(E);B+="</dd>"}}B+="</dl>";D.html(B);q=unescape(R.requestContent);q=q.replace(/[^\x00-\x7F]/g,"###");if(q.indexOf("###")!=-1){q=q.replace(q.substring(q.indexOf("###"),q.lastIndexOf("###")+3),"[BINARY DATA]")}if(q){var I=true;try{Q=jQuery.parseJSON(q)}catch(O){I=false}if(I){var K=o.parseAndReturn(q);q=JSON.stringify(K,null,2);q=q.replace("[{","[\n  {");q=q.replace(/,\n[\n ]*$/,"");q=q.replace(/\n(\s*)},\n{/g,"\n$1},\n$1{");D.append("<pre class='language-javascript'><code class='language-javascript' id='some-code'>"+q+"</code></pre>")}else{q=q.replace(/>/g,"&gt;").replace(/</g,"&lt;");D.append("<pre class='language-markup'><code class='language-markup' id='some-code'>"+q+"</code></pre>")}}if(typeof Prism=="object"){Prism.highlightAll()}};this.clearErrorContainer=function(){o.clearMissingBooleanVariables();o.clearMissingArray();jQuery("[data-role='error_container']").hide().html("")};this.clearMissingBooleanVariables=function(){p=false;j=false;r=false;isRequestBodyMissing=false};this.clearMissingArray=function(){z=[];s=[];g=[];requestBodyMissing=""};this.updateAuthModalFooter=function(B){var A=B=="basic_auth_modal"?"apisBasicAuthDetails":"apisOAuth2CredentialsDetails";if(localStorage.getItem(A)){jQuery("[data-role='"+B+"']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='"+B+"']").find(".modal-footer p input").length){jQuery("[data-role='"+B+"']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='"+B+"']").modal("show")};this.setOAuth2Credentials=function(D){if(D.errorMessage!=""){o.showError(D.errorMessage)}else{m=D;a="oauth2";var B=jQuery("[data-role='oauth2_modal']").find("#chk_remember").is(":checked");if(B){var A=new Date;var C=A.getMonth()+1+"/"+A.getDate()+"/"+A.getFullYear();localStorage.apisOAuth2CredentialsDetails=l+"@@@"+JSON.stringify(m)+"@@@"+C}else{localStorage.removeItem("apisOAuth2CredentialsDetails");sessionStorage.apisOAuth2CredentialsDetails=l+"@@@"+JSON.stringify(m)}sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@oauth2";o.updateAuthContainer()}};this.toggleAuthScheme=function(A){jQuery("[data-role='authentication_container'] .well").removeClass("selected");jQuery(this).addClass("selected");if(jQuery(this).hasClass("basicauth")){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@basicauth";a="basicauth"}else{if(jQuery(this).hasClass("oauth2")){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@oauth2";a="oauth2"}else{if(jQuery(this).hasClass("customtoken")){sessionStorage.selectedAuthScheme=l+"@@@"+y+"@@@customtoken";a="customtoken"}}}};this.clearSessionStorage=function(A){A=typeof A.data=="undefined"?A:A.data;if(A=="oauth2"){sessionStorage.removeItem("apisOAuth2CredentialsDetails");localStorage.removeItem("apisOAuth2CredentialsDetails");m=null;jQuery("[data-role='oauth2_container']").find(".link_open_oauth2").html("Set...").attr("title","Set OAuth 2 credentials.");jQuery("[data-role='oauth2_container']").find(".icon-remove").css("display","none")}else{if(A=="basicauth"){f="";n="";sessionStorage.removeItem("apisBasicAuthDetails");localStorage.removeItem("apisBasicAuthDetails");jQuery("[data-role='basic_auth_container']").find(".link_open_basicauth").html("Set...").attr("title","Set basic auth credentials.");jQuery("[data-role='basic_auth_container']").find(".icon-remove").css("display","none")}else{if(A=="customtoken"){sessionStorage.removeItem("revisionsCustomTokenCredentialsDetails");jQuery("[data-role='custom_token_container']").find(".link_open_customtoken").html("Set...").attr("title","Set custom token credentials.");jQuery("[data-role='custom_token_container']").find(".icon-remove").css("display","none");b=false}}}Apigee.APIModel.initMethodsAuthDialogsEvents()}};Apigee.APIModel.Methods.prototype=new Apigee.APIModel.Common;Apigee.APIModel.InlineEdit=function(){var m=this;var a=0;var h;var d=window.location.href;var c=null;var l="";var b=false;var n=false;var e="method";var j=false;function k(){sessionStorage.removeItem("basicAuth1");sessionStorage.removeItem("userEmail1")}function f(t,q){var r;var o;var s="";templateParamAvailable=false;if(t=="general"){r="[data-role='query-param-list'][data-scope='method'], [data-role='header-param-list'][data-scope='method']";if(q=="resource"){r="[data-role='query-param-list'][data-scope='resource'], [data-role='header-param-list'][data-scope='resource']"}var p="[data-scope='method']";if(q=="resource"){p="[data-scope='resource']"}jQuery("[data-role='template-params']").find(p).each(function(u){templateParamAvailable=true;s+='{"name" :"'+jQuery(this).find("[data-role='name']").text()+'",';s+='"description" :"'+jQuery(this).find("[data-role='description']").text()+'",';if(jQuery(this).find("[data-role='required']").length){s+='"required" : '+jQuery(this).find("[data-role='required']").text()+","}if(jQuery(this).find("[data-role='defaultValue']").length){s+='"defaultValue" :"'+jQuery(this).find("[data-role='defaultValue']").text()+'",'}s+='"type" :"TEMPLATE",';s+='"dataType" :"string"}';var v=jQuery("[data-role='template-params']").find(p).length;if(v>u+1){s+=","}})}else{if(t=="body"){r="[data-role='body-param-list'][data-scope='method']";if(q=="resource"){r="[data-role='body-param-list'][data-scope='resource']"}o="BODY"}else{if(t=="attachments"){r="[data-role='attachments-list']"}}}if(templateParamAvailable){s+=","}jQuery(r).each(function(v){var y=jQuery(this);o=t;if(t=="general"){o=y.attr("data-role")=="query-param-list"?"QUERY":"HEADER"}var w=y.children(".title").find("[data-role='required']").text().indexOf("required")!=-1?true:false;var x;var u;if(y.find("div.title input[data-role='value']").length){x=jQuery.trim(y.find("div.title input[data-role='value']").val())}else{x=jQuery.trim(y.find("div.title span[data-role='name']").text())}if(y.find("div.description textarea").length){u=jQuery.trim(y.find("div.description textarea").val())}else{u=jQuery.trim(y.find("[data-role='description']").html());if(c.is(y.find("[data-role='description']"))){u=jQuery.trim(y.find("[data-role='description']").text())}}u=JSON.stringify(u);u=u.substring(1,u.length-1);u=m.escapeSpecialChars(u);s+='{"name" :"'+x+'",';s+='"description" :"'+u+'",';s+='"required" : '+w+",";if(t=="attachments"){s+='"sampleFileUrl" : "'+jQuery.trim(y.find("[data-role='value']").attr("data-sample-file-url"))+'",';s+='"contentDisposition" : "'+jQuery.trim(y.find("[data-role='value']").attr("data-content-disposition"))+'"}'}else{s+='"type" :"'+o+'",';s+='"defaultValue" :"'+y.find("[data-role='value']").val()+'",';s+='"dataType" :"string"}'}var z=jQuery(r).length;if(z>v+1){s+=","}});return s}function i(v,r){var s=jQuery.trim(v.find("[data-role='name']").text());var q="";var u;if(v.attr("data-role")=="query-param-list"){q="QUERY";u=r.parameters}else{if(v.attr("data-role")=="header-param-list"){q="HEADER";u=r.parameters}else{if(v.attr("data-role")=="body-param-list"){q="BODY";if(r.body){u=r.body.parameters}}else{if(v.attr("data-role")=="attachments-list"){q="ATTACHMENT";if(r.body){u=r.body.attachments}}else{if(v.attr("data-role")=="response_errors_list"){q="ERRORS";if(r.response){u=r.response.errors}}}}}}if(u){for(var p=0,o=u.length;p<o;p++){var t=u[p];if(q=="QUERY"||q=="HEADER"){if(t.name==s&&t.type==q){v.find("[data-role='description']").html(t.description)}}else{if(t.name==s){v.find("[data-role='description']").html(t.description)}}}}}function g(){if(localStorage.orgAdminBasicAuthDetails){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").html('<input type="checkbox" checked id="chk_remember"> Remember credentials for 30 days.')}else{if(!jQuery("[data-role='edit_auth_modal']").find(".modal-footer p input").length){jQuery("[data-role='edit_auth_modal']").find(".modal-footer p").append('<br><input type="checkbox" id="chk_remember"> Remember credentials for 30 days.')}}jQuery("[data-role='edit_auth_modal']").modal("show")}this.init=function(o){a=o;if(sessionStorage.orgAdminBasicAuthDetails||localStorage.orgAdminBasicAuthDetails){m.showAdminAuthenticationSection()}else{g()}Apigee.APIModel.initInlineEditAdminAuthEvents()};this.saveAuthModal=function(){var r=m.validateBasicAuthFields("edit_auth_modal");if(r==""){var q=window.location.href;var o="password="+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val());if(Apigee.APIModel.authUrl!="null"){var p=Apigee.APIModel.authUrl.replace("{user}",encodeURIComponent(userEmail));m.makeAJAXCall({url:Apigee.APIModel.proxyURL+"?targeturl="+p,type:"post",dataType:"json",data:o,contentType:"application/x-www-form-urlencoded",callback:m.saveAdminCredentials,errorCallback:m.showUnauthorizedInfo})}else{m.saveAdminCredentials()}}else{jQuery("[data-role='edit_auth_modal'] .error_container").html(r+"Please try again.").show()}};this.saveAdminCredentials=function(){h="Basic "+jQuery.base64Encode(userEmail+":"+jQuery.trim(jQuery("[data-role='edit_auth_modal']").find("#inputPassword").val()));var p=jQuery("[data-role='edit_auth_modal']").find("#chk_remember").is(":checked");if(p){var o=new Date;var q=o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear();localStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail+"@@@"+q}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.orgAdminBasicAuthDetails=h+"@@@"+userEmail}m.closeAuthModal();m.showAdminAuthenticationSection()};this.showUnauthorizedInfo=function(o){if(o=="401"){jQuery("[data-role='edit_auth_modal'] .error_container").html("Invalid credentials. Please try again.").show()}else{jQuery("[data-role='edit_auth_modal'] .error_container").html("Error saving details. Please try again.").show()}};this.showAdminAuthenticationSection=function(){var u="";if(localStorage.orgAdminBasicAuthDetails){var p=new Date;var r=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear();var q=localStorage.orgAdminBasicAuthDetails.split("@@@")[2];var o=r;var t=parseInt(m.dateDiff(new Date(o),new Date(q)));if(t>30){localStorage.removeItem("orgAdminBasicAuthDetails");g()}else{u=localStorage.orgAdminBasicAuthDetails}}else{if(sessionStorage.orgAdminBasicAuthDetails){u=sessionStorage.orgAdminBasicAuthDetails}}if(u!==""){h=u.split("@@@")[0];var s=u.split("@@@")[1];jQuery(".admin_auth_section a.auth_admin_email").html(s).show();jQuery(".admin_auth_section .icon-remove").css("display","inline-block");jQuery(".admin_auth_section").show().removeClass("hide")}else{localStorage.removeItem("orgAdminBasicAuthDetails");sessionStorage.removeItem("orgAdminBasicAuthDetails");jQuery(".admin_auth_section a.auth_admin_email").html("").hide();jQuery(".admin_auth_section .icon-remove").hide();jQuery(".admin_auth_section").show().removeClass("hide")}if(!n){m.constructEditMode()}};this.clearAdminAuthDetails=function(){k();jQuery(this).siblings("a.auth_admin_email").html("").hide();jQuery(this).hide()};this.reOpenAdminAuthDetails=function(){n=true;k();g();Apigee.APIModel.initInlineEditAdminAuthEvents()};this.constructEditMode=function(){jQuery("#method_content").addClass("edit_mode");var q='<a class="allow_edit hover"></a><a class="allow_edit ok" title="save and quit."></a><a class="allow_edit cancel" title="reset and quit."></a>';jQuery(".edit_mode .resource_details").parent().addClass("clearfix");jQuery(".edit_mode .resource_details").children("div").addClass("clearfix");jQuery("[data-role='method-title']").parent().append(q).addClass("clearfix");jQuery(".description_container").addClass("clearfix");jQuery("ul.method_table").parent().css({clear:"both"});if(jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list'] ").length){jQuery("[data-role='query-param-list'],[data-role='header-param-list'], [data-role='body-param-list'], [data-role='param-group-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(s,t){jQuery(this).find("[data-role='description']").parent().append(q)})}jQuery(".description_container").append('<textarea class="resource_description_edit">'+jQuery("[data-role='method-description']").html()+"</textarea>"+q);var r=jQuery("[data-role='request-payload-docs']");r.wrap("<div class='clearfix'></div>");r.attr("data-allow-edit","true");r.parent().append('<textarea class="request_payload_doc_edit"></textarea>'+q);var p=jQuery("[data-role='request-payload-example']");p.wrap("<div class='clearfix'></div>");p.attr("data-allow-edit","true").width(600).css({float:"left"});p.parent().append(q);var o=jQuery("[data-role='response-payload-docs']");o.wrap("<div class='clearfix'></div>");o.attr("data-allow-edit","true");o.parent().append('<textarea class="response_payload_doc_edit"></textarea>'+q);Apigee.APIModel.inlineEditPageEvents()};this.handleEditPropertiesMouseOver=function(){var o=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).addClass("edit");jQuery(this).siblings("a.allow_edit.hover").css({display:"inline-block"})}};this.handleEditPropertiesMouseOut=function(){var o=jQuery(this).attr("data-role");if(!jQuery(this).hasClass("editing")){jQuery(this).removeClass("edit");jQuery(this).siblings("a.allow_edit.hover").hide()}};this.handleEditableElementsClick=function(q){var o=false;if(c){if(jQuery(this).attr("data-role")=="description"&&!c.is(jQuery(this))){o=true}else{o=c.attr("data-role")!=jQuery(this).attr("data-role")}}jQuery("[data-role='error_container']").hide().html("");if(l!=""&&b&&c!=null&&o){var p=jQuery.trim(c.text());if(c.siblings("textarea").length){p=jQuery.trim(c.siblings("textarea").val())}if(l!=p){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}else{if(!c.is(jQuery(this))){m.resetEditableElement()}}}else{c=jQuery(this);if(!j&&jQuery(this).attr("data-role")=="description"){c.text(c.html());j=true}l=jQuery.trim(jQuery(this).text());if(jQuery(this).hasClass("resource_description")||jQuery(this).attr("data-role")=="request-payload-docs"||jQuery(this).attr("data-role")=="response-payload-docs"){l=jQuery.trim(jQuery(this).html());jQuery(this).hide();jQuery(this).siblings("textarea").html(jQuery.trim(jQuery(this).html())).height(jQuery(this).height()+30).show();jQuery(this).siblings("textarea").focus();jQuery(this).siblings("textarea").unbind("click").click(function(){return false});Apigee.APIModel.initInlineEditAdminAuthEvents()}if(jQuery(this).attr("data-role")=="method-title"||jQuery(this).attr("data-role")=="description"){jQuery(this).attr("contenteditable","true")}else{jQuery("[data-role='method-title']").removeAttr("contenteditable")}jQuery(this).addClass("editing");jQuery(this).siblings("a.allow_edit.hover").hide();jQuery(this).siblings("a.allow_edit.ok").show();jQuery(this).siblings("a.allow_edit.cancel").show();jQuery(this).addClass("edit");b=true;jQuery(this).focus()}q.preventDefault();return false};this.resetEditableElement=function(){j=false;b=false;c.removeClass("editing");c.siblings("a.allow_edit").hide();c.html(l);if(c.attr("data-role")=="description"){c.html(l)}if(c.attr("data-role")=="method-description"){jQuery("textarea.resource_description_edit").val(l)}c.removeClass("edit").removeClass("editing");if(c.hasClass("resource_description")||c.attr("data-role")=="request-payload-docs"||c.attr("data-role")=="response-payload-docs"){c.siblings("textarea").hide();c.show()}l="";return false};this.documentClickHandler=function(){j=false;if(c){c.removeClass("editing")}if(l!=""&&jQuery("body").children("#modal_container.modal").is(":visible")==false){jQuery("[data-role='confirm_modal']").modal("show");Apigee.APIModel.initInlineEditAdminAuthEvents()}};this.handleConfirmDialogSave=function(){j=false;c.siblings("a.allow_edit.ok").trigger("click");m.closeAuthModal();Apigee.APIModel.initInlineEditAdminAuthEvents();l="";return false};this.makeAPICall=function(E){var q=location.href;b=false;c.removeClass("editing");var A="";if(c.attr("data-role")=="description"&&c.parent().parent().attr("data-scope")=="resource"){e="resource";q=q.split("/methods/")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){q=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}if(Apigee.APIModel.apiModelBaseUrl){q=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId}A+='{"parameters": ['+f("general","resource")+" ]}"}else{e="method";q=q.split("/doc?")[0];if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){q=Drupal.settings.smartdocs.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}if(Apigee.APIModel.apiModelBaseUrl){q=Apigee.APIModel.apiModelBaseUrl+"/v1/o/"+Apigee.APIModel.organizationName+"/apimodels/"+Apigee.APIModel.apiName+"/revisions/"+Apigee.APIModel.revisionNumber+"/resources/"+Apigee.APIModel.resourceId+"/methods/"+Apigee.APIModel.methodId}var o=jQuery.trim(jQuery("textarea.resource_description_edit").val());var F=jQuery("[data-role='auth-type']").text();F=F.replace("Basic Auth","BASICAUTH").replace("Custom Token","CUSTOM").replace("OAuth 1","OAUTH1WEBSERVER").replace("OAuth 1 Client Credentials","OAUTH1CLIENTCREDENTIALS").replace("OAuth 2","OAUTH2WEBSERVER").replace("OAuth 2 Client Credentials","OAUTH2CLIENTCREDENTIALS").replace("OAuth 2 Implicit Grant Flow","OAUTH2IMPLICITGRANT").replace("No auth","NOAUTH");var y="";if(F.split(",").length>1){y="[";for(var D=0;D<F.split(",").length;D++){y+='"'+F.split(",")[D]+'"';if(D!=F.split(",").length-1){y+=","}}y+="]"}else{y='[ "'+F+'" ]'}var w=jQuery.trim(jQuery("[data-role='category']").text());var z="";if(z.split(",").length>1){z="[";for(var D=0;D<w.split(",").length;D++){z+='"'+w.split(",")[D]+'"';if(D!=w.split(",").length-1){z+=","}}z+="]"}else{z='[ "'+w+'" ]'}o=JSON.stringify(o);o=o.substring(1,o.length-1);o=m.escapeSpecialChars(o);A='{ "displayName":"'+jQuery.trim(jQuery("[data-role='method-title']").html())+'", "description": "'+o+'","verb": "'+jQuery.trim(jQuery("[data-role='verb']").text())+'",';A+='"authSchemes" : '+y+', "tags" : '+z;var t="";if(jQuery.trim(jQuery("[data-role='content-type']").text())!="N.A."){t=jQuery.trim(jQuery("[data-role='content-type']").text())}var u=f("general");if(u.length){if(u.charAt(u.length-1)===","){u=u.substring(0,u.length-1)}A+=', "parameters": ['+u+" ]"}A+=', "body": {';A+='"parameters": [';A+=f("body");A+=" ]";A+=', "attachments": [';A+=f("attachments");A+=" ]";A+=', "contentType":"'+t+'"';if(jQuery('[data-role="request-payload-example"]').length){var r=JSON.stringify(window.apiModelEditor.getRequestPayLoad());r=r.substring(1,r.length-1);r=m.escapeSpecialChars(r);A+=', "sample" :"'+r+'"'}var x=jQuery("[data-role='request-payload-docs']");var G=jQuery("[data-role='response-payload-docs']");var s="";var B="";if(x.length){var s=jQuery.trim(x.html());if(x.siblings("textarea").is(":visible")==true){s=jQuery.trim(x.siblings("textarea").val())}s=JSON.stringify(s);s=s.substring(1,s.length-1);s=m.escapeSpecialChars(s);s=', "doc": "'+s+'" ';A+=s}A+=" }";var p=jQuery("[data-role='response_errors_list']");if(G.length||p.length){A+=', "response": {';if(G.length){var B=jQuery.trim(G.html());if(G.siblings("textarea").is(":visible")==true){B=jQuery.trim(G.siblings("textarea").val())}B=JSON.stringify(B);B=B.substring(1,B.length-1);B=m.escapeSpecialChars(B);var C=JSON.stringify(jQuery("[data-role='response-payload']").val());C=C.substring(1,C.length-1);C=m.escapeSpecialChars(C);A+='"doc": "'+B+'"  ,"sample" : "'+C+'", "contentType" : "'+jQuery("[data-role='response-content-type']").text()+'"'}if(p.length){var u="";jQuery(p).each(function(I){var H=jQuery(this);u+='{"httpStatusCode" :"'+jQuery.trim(H.find("[data-role='http_status_code']").html())+'",';u+='"code" : "'+jQuery.trim(H.find("[data-role='code']").html())+'",';u+='"description" :"'+jQuery.trim(H.find("[data-role='description']").html())+'"}';var J=jQuery(p).length;if(J>I+1){u+=","}});if(G.length){A+=","}A+='"errors" : ['+u+"]"}A+="}"}A+="}"}var v=[];if(localStorage.orgAdminBasicAuthDetails){if(h!=localStorage.orgAdminBasicAuthDetails.split("@@@")[0]){h=localStorage.orgAdminBasicAuthDetails.split("@@@")[0];jQuery(".admin_auth_section a.auth_admin_email").html(localStorage.orgAdminBasicAuthDetails.split("@@@")[1])}}v.push({name:"Authorization",value:h});jQuery("#working_alert").fadeIn();q=Apigee.APIModel.proxyURL+"?targeturl="+q;m.makeAJAXCall({url:q,type:"put",dataType:"json",headers:v,data:A,contentType:"application/json",callback:m.handleAPICallSuccess,errorCallback:m.handleUpdateFailure});jQuery(this).siblings("[contenteditable='true']").removeClass("edit");jQuery(this).siblings("a.allow_edit.cancel").hide();jQuery(this).siblings("a.allow_edit.ok").hide();if(jQuery(this).siblings("textarea").is(":visible")){jQuery(this).siblings("textarea").hide();jQuery(this).siblings("[data-allow-edit='true']").html(jQuery(this).siblings("textarea").val()).removeClass("edit").removeClass("editing").show()}jQuery(this).hide();E.stopPropagation();return false};this.handleAPICallSuccess=function(q){j=false;q=unescape(q.responseContent);q=JSON.parse(q);l=jQuery.trim(c.html());jQuery("[data-role='method-title']").html(q.displayName);jQuery("[data-role='method-description']").html(q.description);jQuery("[data-role='query-param-list'], [data-role='header-param-list'], [data-role='body-param-list'], [data-role='response_errors_list'], [data-role='attachments-list']").each(function(r){i(jQuery(this),q)});if(typeof Drupal!="undefined"&&typeof Drupal.settings!="undefined"){var o=window.location.href;var p=o=o.replace("?editMode=1","?flush=1").replace("?editMode=2","?flush=1");m.makeAJAXCall({url:p,callback:m.drupalUpdateSuccess})}l=""};this.drupalUpdateSuccess=function(){};this.handleUpdateFailure=function(){m.resetEditableElement();m.showError("Error saving changes.")}};Apigee.APIModel.InlineEdit.prototype=new Apigee.APIModel.Common;