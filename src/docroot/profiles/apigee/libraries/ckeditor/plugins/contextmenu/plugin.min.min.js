CKEDITOR.plugins.add("contextmenu",{requires:"menu",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(a){this.base.call(this,a,{panel:{className:"cke_menu_panel",attributes:{"aria-label":a.lang.contextmenu.options}}})},proto:{addTarget:function(c,d){c.on("contextmenu",function(f){var k=f.data,l=CKEDITOR.env.webkit?a:CKEDITOR.env.mac?k.$.metaKey:k.$.ctrlKey;if(d&&l){return}k.preventDefault();var n=k.getTarget().getDocument(),g=k.getTarget().getDocument().getDocumentElement(),h=!n.equals(CKEDITOR.document),m=n.getWindow().getScrollPosition(),j=h?k.$.clientX:k.$.pageX||m.x+k.$.clientX,i=h?k.$.clientY:k.$.pageY||m.y+k.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(g,null,j,i)},CKEDITOR.env.ie?200:0,this)},this);if(CKEDITOR.env.webkit){var a,b=function(f){a=CKEDITOR.env.mac?f.data.$.metaKey:f.data.$.ctrlKey},e=function(){a=0};c.on("keydown",b);c.on("keyup",e);c.on("contextmenu",e)}},open:function(c,b,a,d){this.editor.focus();c=c||CKEDITOR.document.getDocumentElement();this.editor.selectionChange(1);this.show(c,b,a,d)}}})},beforeInit:function(b){var a=b.contextMenu=new CKEDITOR.plugins.contextMenu(b);b.on("contentDom",function(){a.addTarget(b.editable(),b.config.browserContextMenuOnCtrl!==false)});b.addCommand("contextMenu",{exec:function(){b.contextMenu.open(b.document.getBody())}});b.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu");b.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}});