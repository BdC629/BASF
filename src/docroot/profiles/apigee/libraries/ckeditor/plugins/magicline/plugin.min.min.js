"use strict";(function(){CKEDITOR.plugins.add("magicline",{lang:"ar,bg,ca,cs,cy,de,el,en,en-gb,eo,es,et,eu,fa,fi,fr,fr-ca,gl,he,hr,hu,id,it,ja,km,ko,ku,lv,nb,nl,no,pl,pt,pt-br,ru,si,sk,sl,sq,sv,tr,ug,uk,vi,zh,zh-cn",init:C});function C(ah){var af=ah.config,ao=af.magicline_triggerOffset||30,am=af.enterMode,ag={editor:ah,enterMode:am,triggerOffset:ao,holdDistance:0|ao*(af.magicline_holdDistance||.5),boxColor:af.magicline_color||"#ff0000",rtl:af.contentsLangDirection=="rtl",tabuList:["data-cke-hidden-sel"].concat(af.magicline_tabuList||[]),triggers:af.magicline_everywhere?f:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1}},an,aj,ae,al;try{ag.debug=window.top.DEBUG}catch(ai){}ag.debug=ag.debug||{groupEnd:function(){},groupStart:function(){},log:function(){},logElements:function(){},logElementsEnd:function(){},logEnd:function(){},mousePos:function(){},showHidden:function(){},showTrigger:function(){},startTimer:function(){},stopTimer:function(){}};ag.isRelevant=function(ap){return j(ap)&&!M(ag,ap)&&!L(ap)};ah.on("contentDom",ak,this);function ak(){var aq=ah.editable(),au=ah.document,at=ah.window,ar;o(ag,{editable:aq,inInlineMode:aq.isInline(),doc:au,win:at,hotNode:null},true);ag.boundary=ag.inInlineMode?ag.editable:ag.doc.getDocumentElement();if(aq.is(z.$inline)){return}if(ag.inInlineMode&&!V(aq)){aq.setStyles({position:"relative",top:null,left:null})}b.call(this,ag);U(ag);aq.attachListener(ah,"beforeUndoImage",function(){ag.line.detach()});aq.attachListener(ah,"beforeGetData",function(){if(ag.line.wrap.getParent()){ag.line.detach();ah.once("getData",function(){ag.line.attach()},null,null,1e3)}},null,null,0);aq.attachListener(ag.inInlineMode?au:au.getWindow().getFrame(),"mouseout",function(ay){if(ah.mode!="wysiwyg"){return}if(ag.inInlineMode){var aw={x:ay.data.$.clientX,y:ay.data.$.clientY};U(ag);w(ag,true);var ax=ag.view.editable,av=ag.view.scroll;if(!X(aw.x,ax.left-av.x,ax.right-av.x)||!X(aw.y,ax.top-av.y,ax.bottom-av.y)){clearTimeout(al);al=null;ag.line.detach()}}else{clearTimeout(al);al=null;ag.line.detach()}});aq.attachListener(aq,"keyup",function(av){ag.hiddenMode=0;ag.debug.showHidden(ag.hiddenMode)});aq.attachListener(aq,"keydown",function(ax){if(ah.mode!="wysiwyg"){return}var ay=ax.data.getKeystroke(),aw=ah.getSelection(),av=aw.getStartElement();switch(ay){case 2228240:case 16:ag.hiddenMode=1;ag.line.detach()}ag.debug.showHidden(ag.hiddenMode)});aq.attachListener(ag.inInlineMode?aq:au,"mousemove",function(aw){aj=true;if(ah.mode!="wysiwyg"||ah.readOnly||al){return}var av={x:aw.data.$.clientX,y:aw.data.$.clientY};al=setTimeout(function(){ap(av)},30)});aq.attachListener(at,"scroll",function(av){if(ah.mode!="wysiwyg"){return}ag.line.detach();if(k.webkit){ag.hiddenMode=1;clearTimeout(an);an=setTimeout(function(){if(!ag.mouseDown){ag.hiddenMode=0}ag.debug.showHidden(ag.hiddenMode)},50);ag.debug.showHidden(ag.hiddenMode)}});aq.attachListener(c?au:at,"mousedown",function(av){if(ah.mode!="wysiwyg"){return}ag.line.detach();ag.hiddenMode=1;ag.mouseDown=1;ag.debug.showHidden(ag.hiddenMode)});aq.attachListener(c?au:at,"mouseup",function(av){ag.hiddenMode=0;ag.mouseDown=0;ag.debug.showHidden(ag.hiddenMode)});ah.addCommand("accessPreviousSpace",R(ag));ah.addCommand("accessNextSpace",R(ag,true));ah.setKeystroke([[af.magicline_keystrokePrevious,"accessPreviousSpace"],[af.magicline_keystrokeNext,"accessNextSpace"]]);ah.on("loadSnapshot",function(ay){var az,ax,aw;for(var av in{p:1,br:1,div:1}){az=ah.document.getElementsByTag(av);for(aw=az.count();aw--;){if((ax=az.getItem(aw)).data("cke-magicline-hot")){ag.hotNode=ax;ag.lastCmdDirection=ax.data("cke-magicline-dir")==="true"?true:false;return}}}});function ap(av){ag.debug.groupStart("CheckMouse");ag.debug.startTimer();ag.mouse=av;ag.trigger=null;al=null;U(ag);if(aj&&!ag.hiddenMode&&ah.focusManager.hasFocus&&!ag.line.mouseNear()&&(ag.element=s(ag,true))){if((ag.trigger=aa(ag)||t(ag)||D(ag))&&!g(ag,ag.trigger.upper||ag.trigger.lower)){ag.line.attach().place()}else{ag.trigger=null;ag.line.detach()}ag.debug.showTrigger(ag.trigger);ag.debug.mousePos(av.y,ag.element);aj=false}ag.debug.stopTimer();ag.debug.groupEnd()}this.backdoor={accessFocusSpace:P,boxTrigger:A,isLine:M,getAscendantTrigger:y,getNonEmptyNeighbour:a,getSize:F,that:ag,triggerEdge:t,triggerEditable:aa,triggerExpand:D}}}var o=CKEDITOR.tools.extend,v=CKEDITOR.dom.element,G=v.createFromHtml,k=CKEDITOR.env,c=CKEDITOR.env.ie&&CKEDITOR.env.version<9,z=CKEDITOR.dtd,T={},ac=128,J=64,x=32,h=16,B=8,d=4,Z=2,I=1,Q="Â ",N=z.$listItem,K=z.$tableContent,S=o({},z.$nonEditable,z.$empty),f=z.$block,O=100,e="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",ad=e+"border-color:transparent;display:block;border-style:solid;",W="<span>"+Q+"</span>";T[CKEDITOR.ENTER_BR]="br";T[CKEDITOR.ENTER_P]="p";T[CKEDITOR.ENTER_DIV]="div";function u(ag,af,ae){return j(af)&&j(ae)&&ae.equals(af.getNext(function(ah){return!(m(ah)||q(ah)||L(ah))}))}function A(ae){this.upper=ae[0];this.lower=ae[1];this.set.apply(this,ae.slice(2))}A.prototype={set:function(ag,ae,af){this.properties=ag+ae+(af||I);return this},is:function(ae){return(this.properties&ae)==ae}};var s=function(){function ae(ag,af){return new CKEDITOR.dom.element(ag.$.elementFromPoint(af.x,af.y))}return function(aj,ag,af){if(!aj.mouse){return null}var al=aj.doc,ak=aj.line.wrap,ah=af||aj.mouse,ai=ae(al,ah);if(ag&&M(aj,ai)){ak.hide();ai=ae(al,ah);ak.show()}if(!(ai&&ai.type==CKEDITOR.NODE_ELEMENT&&ai.$)){return null}if(k.ie&&k.version<9){if(!(aj.boundary.equals(ai)||aj.boundary.contains(ai))){return null}}return ai}}();function y(ah){var ag=ah.element,af;if(ag&&j(ag)){af=ag.getAscendant(ah.triggers,true);if(af&&ah.editable.contains(af)){var ae=i(af,true);if(ae.getAttribute("contenteditable")=="true"){return af}else{if(ae.is(ah.triggers)){return ae}else{return null}}return af}else{return null}}return null}function Y(ah,ag,af){r(ah,ag);r(ah,af);var ae=ag.size.bottom,ai=af.size.top;return ae&&ai?0|(ae+ai)/2:ae||ai}function a(ag,af,ae){af=af[ae?"getPrevious":"getNext"](function(ah){return p(ah)&&!m(ah)||j(ah)&&!L(ah)&&!M(ag,ah)});return af}function X(ag,ae,af){return ag>ae&&ag<af}function i(af,ae){if(af.data("cke-editable")){return null}if(!ae){af=af.getParent()}while(af){if(af.data("cke-editable")){return null}if(af.hasAttribute("contenteditable")){return af}af=af.getParent()}return null}function b(ah){var ai=ah.doc,ae=G('<span contenteditable="false" style="'+e+"position:absolute;border-top:1px dashed "+ah.boxColor+'"></span>',ai),ag=this.path+"images/"+(k.hidpi?"hidpi/":"")+"icon.png";o(ae,{attach:function(){if(!this.wrap.getParent()){this.wrap.appendTo(ah.editable,true)}return this},lineChildren:[o(G('<span title="'+ah.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',ai),{base:e+"height:17px;width:17px;"+(ah.rtl?"left":"right")+":17px;background:url("+ag+") center no-repeat "+ah.boxColor+";cursor:pointer;"+(k.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(k.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px",1),"top:-17px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px 2px 0px 0px",1),"top:-1px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","0px 0px 2px 2px",1)]}),o(G(W,ai),{base:ad+"left:0px;border-left-color:"+ah.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),o(G(W,ai),{base:ad+"right:0px;border-right-color:"+ah.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){if(this.wrap.getParent()){this.wrap.remove()}return this},mouseNear:function(){ah.debug.groupStart("mouseNear");r(ah,this);var ak=ah.holdDistance,aj=this.size;if(aj&&X(ah.mouse.y,aj.top-ak,aj.bottom+ak)&&X(ah.mouse.x,aj.left-ak,aj.right+ak)){ah.debug.logEnd("Mouse is near.");return true}ah.debug.logEnd("Mouse isn't near.");return false},place:function(){var ap=ah.view,ak=ah.editable,al=ah.trigger,ar=al.upper,an=al.lower,ao=ar||an,aq=ao.getParent(),am={};this.trigger=al;ar&&r(ah,ar,true);an&&r(ah,an,true);r(ah,aq,true);if(ah.inInlineMode){w(ah,true)}if(aq.equals(ak)){am.left=ap.scroll.x;am.right=-ap.scroll.x;am.width=""}else{am.left=ao.size.left-ao.size.margin.left+ap.scroll.x-(ah.inInlineMode?ap.editable.left+ap.editable.border.left:0);am.width=ao.size.outerWidth+ao.size.margin.left+ao.size.margin.right+ap.scroll.x;am.right=""}if(ar&&an){if(ar.size.margin.bottom===an.size.margin.top){am.top=0|ar.size.bottom+ar.size.margin.bottom/2}else{if(ar.size.margin.bottom<an.size.margin.top){am.top=ar.size.bottom+ar.size.margin.bottom}else{am.top=ar.size.bottom+ar.size.margin.bottom-an.size.margin.top}}}else{if(!ar){am.top=an.size.top-an.size.margin.top}else{if(!an){am.top=ar.size.bottom+ar.size.margin.bottom}}}if(al.is(d)||X(am.top,ap.scroll.y-15,ap.scroll.y+5)){am.top=ah.inInlineMode?0:ap.scroll.y;this.look(d)}else{if(al.is(Z)||X(am.top,ap.pane.bottom-5,ap.pane.bottom+15)){am.top=ah.inInlineMode?ap.editable.height+ap.editable.padding.top+ap.editable.padding.bottom:ap.pane.bottom-1;this.look(Z)}else{if(ah.inInlineMode){am.top-=ap.editable.top+ap.editable.border.top}this.look(I)}}if(ah.inInlineMode){am.top--;am.top+=ap.editable.scroll.top;am.left+=ap.editable.scroll.left}for(var aj in am){am[aj]=CKEDITOR.tools.cssLength(am[aj])}this.setStyles(am)},look:function(ak){if(this.oldLook==ak){return}for(var aj=this.lineChildren.length,al;aj--;){(al=this.lineChildren[aj]).setAttribute("style",al.base+al.looks[0|ak/2])}this.oldLook=ak},wrap:new v("span",ah.doc)});for(var af=ae.lineChildren.length;af--;){ae.lineChildren[af].appendTo(ae)}ae.look(I);ae.appendTo(ae.wrap);ae.unselectable();ae.lineChildren[0].on("mouseup",function(aj){ae.detach();P(ah,function(al){var ak=ah.line.trigger;al[ak.is(ac)?"insertBefore":"insertAfter"](ak.is(ac)?ak.lower:ak.upper)},true);ah.editor.focus();if(!k.ie&&ah.enterMode!=CKEDITOR.ENTER_BR){ah.hotNode.scrollIntoView()}aj.data.preventDefault(true)});ae.on("mousedown",function(aj){aj.data.preventDefault(true)});ah.line=ae}function P(aj,af,ae){var ai=new CKEDITOR.dom.range(aj.doc),ak=aj.editor,al;if(k.ie&&aj.enterMode==CKEDITOR.ENTER_BR){al=aj.doc.createText(Q)}else{var ah=i(aj.element,true),am=ah&&ah.data("cke-enter-mode")||aj.enterMode;al=new v(T[am],aj.doc);if(!al.is("br")){var ag=aj.doc.createText(Q);ag.appendTo(al)}}ae&&ak.fire("saveSnapshot");af(al);ai.moveToPosition(al,CKEDITOR.POSITION_AFTER_START);ak.getSelection().selectRanges([ai]);aj.hotNode=al;ae&&ak.fire("saveSnapshot")}function R(af,ae){return{canUndo:true,modes:{wysiwyg:1},exec:function(){function ag(aj){var ai=k.ie&&k.version<9?" ":Q,ah=af.hotNode&&af.hotNode.getText()==ai&&af.element.equals(af.hotNode)&&af.lastCmdDirection===!!ae;P(af,function(ak){if(ah&&af.hotNode){af.hotNode.remove()}ak[ae?"insertAfter":"insertBefore"](aj);ak.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!ae});af.lastCmdDirection=!!ae});if(!k.ie&&af.enterMode!=CKEDITOR.ENTER_BR){af.hotNode.scrollIntoView()}af.line.detach()}return function(ak){var aj=ak.getSelection().getStartElement(),ah;aj=aj.getAscendant(f,1);if(g(af,aj)){return}if(!aj||aj.equals(af.editable)||aj.contains(af.editable)){return}if((ah=i(aj))&&ah.getAttribute("contenteditable")=="false"){aj=ah}af.element=aj;var am=a(af,aj,!ae),an;if(j(am)&&am.is(af.triggers)&&am.is(S)&&(!a(af,am,!ae)||(an=a(af,am,!ae))&&j(an)&&an.is(af.triggers))){ag(am);return}var al=y(af,aj);if(!j(al)){return}if(!a(af,al,!ae)){ag(al);return}var ai=a(af,al,!ae);if(ai&&j(ai)&&ai.is(af.triggers)){ag(al);return}}}()}}function M(ag,af){if(!(af&&af.type==CKEDITOR.NODE_ELEMENT&&af.$)){return false}var ae=ag.line;return ae.wrap.equals(af)||ae.wrap.contains(af)}var m=CKEDITOR.dom.walker.whitespaces();function j(ae){return ae&&ae.type==CKEDITOR.NODE_ELEMENT&&ae.$}function E(af){if(!j(af)){return false}var ae={left:1,right:1,center:1};return!!(ae[af.getComputedStyle("float")]||ae[af.getAttribute("align")])}function L(ae){if(!j(ae)){return false}return V(ae)||E(ae)}var q=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT);function V(ae){return!!{absolute:1,fixed:1}[ae.getComputedStyle("position")]}function p(ae){return ae&&ae.type==CKEDITOR.NODE_TEXT}function n(af,ae){return j(ae)?ae.is(af.triggers):null}function g(ai,ah){if(!ah){return false}var af=ah.getParents(1);for(var ag=af.length;ag--;){for(var ae=ai.tabuList.length;ae--;){if(af[ag].hasAttribute(ai.tabuList[ae])){return true}}}return false}function H(ag,af,ah){var ae=af[ah?"getLast":"getFirst"](function(ai){return ag.isRelevant(ai)&&!ai.is(K)});if(!ae){return false}r(ag,ae);return ah?ae.size.top>ag.mouse.y:ae.size.bottom<ag.mouse.y}function aa(al){al.debug.groupStart("triggerEditable");var aj=al.editable,ag=al.mouse,ae=al.view,af=al.triggerOffset,ai;w(al);var ak=ag.y>(al.inInlineMode?ae.editable.top+ae.editable.height/2:Math.min(ae.editable.height,ae.pane.height)/2),ah=aj[ak?"getLast":"getFirst"](function(am){return!(m(am)||q(am))});if(!ah){al.debug.logEnd("ABORT. No edge node found.");return null}if(M(al,ah)){ah=al.line.wrap[ak?"getPrevious":"getNext"](function(am){return!(m(am)||q(am))})}if(!j(ah)||L(ah)||!n(al,ah)){al.debug.logEnd("ABORT. Invalid edge node.");return null}r(al,ah);if(!ak&&ah.size.top>=0&&X(ag.y,0,ah.size.top+af)){ai=al.inInlineMode||ae.scroll.y===0?d:I;al.debug.logEnd("SUCCESS. Created box trigger. EDGE_TOP.");return new A([null,ah,ac,h,ai])}else{if(ak&&ah.size.bottom<=ae.pane.height&&X(ag.y,ah.size.bottom-af,ae.pane.height)){ai=al.inInlineMode||X(ah.size.bottom,ae.pane.height-af,ae.pane.height)?Z:I;al.debug.logEnd("SUCCESS. Created box trigger. EDGE_BOTTOM.");return new A([ah,null,J,h,ai])}}al.debug.logEnd("ABORT. No trigger created.");return null}function t(aj){aj.debug.groupStart("triggerEdge");var ak=aj.mouse,al=aj.view,am=aj.triggerOffset;var ai=y(aj);aj.debug.logElements([ai],["Ascendant trigger"],"First stage");if(!ai){aj.debug.logEnd("ABORT. No element, element is editable or element contains editable.");return null}r(aj,ai);var ae=Math.min(am,0|ai.size.outerHeight/2),an=[],ag,af;if(X(ak.y,ai.size.top-1,ai.size.top+ae)){af=false}else{if(X(ak.y,ai.size.bottom-ae,ai.size.bottom+1)){af=true}else{aj.debug.logEnd("ABORT. Not around of any edge.");return null}}if(L(ai)||H(aj,ai,af)||ai.getParent().is(N)){aj.debug.logEnd("ABORT. element is wrong",ai);return null}var ah=a(aj,ai,!af);if(!ah){if(ai.equals(aj.editable[af?"getLast":"getFirst"](aj.isRelevant))){w(aj);if(af&&X(ak.y,ai.size.bottom-ae,al.pane.height)&&X(ai.size.bottom,al.pane.height-ae,al.pane.height)){ag=Z}else{if(X(ak.y,0,ai.size.top+ae)){ag=d}}}else{ag=I}an=[null,ai][af?"reverse":"concat"]().concat([af?J:ac,h,ag,ai.equals(aj.editable[af?"getLast":"getFirst"](aj.isRelevant))?af?Z:d:I]);aj.debug.log("Configured edge trigger of "+(af?"EDGE_BOTTOM":"EDGE_TOP"))}else{if(p(ah)){aj.debug.logEnd("ABORT. Sibling is non-empty text element");return null}else{if(j(ah)){if(L(ah)||!n(aj,ah)||ah.getParent().is(N)){aj.debug.logEnd("ABORT. elementSibling is wrong",ah);return null}an=[ah,ai][af?"reverse":"concat"]().concat([x,h]);aj.debug.log("Configured edge trigger of EDGE_MIDDLE")}}}if(0 in an){aj.debug.logEnd("SUCCESS. Returning a trigger.");return new A(an)}aj.debug.logEnd("ABORT. No trigger generated.");return null}var D=function(){function ah(an){an.debug.groupStart("expandEngine");var aq=an.element,ar,am,aj;if(!j(aq)||aq.contains(an.editable)){an.debug.logEnd("ABORT. No start element, or start element contains editable.");return null}if(aq.isReadOnly()){return null}aj=l(an,function(au,at){return!at.equals(au)},function(au,at){return s(au,true,at)},aq),ar=aj.upper,am=aj.lower;an.debug.logElements([ar,am],["Upper","Lower"],"Pair found");if(u(an,ar,am)){an.debug.logEnd("SUCCESS. Expand trigger created.");return aj.set(x,B)}an.debug.logElements([aq,ar,am],["Start","Upper","Lower"],"Post-processing");if(ar&&aq.contains(ar)){while(!ar.getParent().equals(aq)){ar=ar.getParent()}}else{ar=aq.getFirst(function(at){return ae(an,at)})}if(am&&aq.contains(am)){while(!am.getParent().equals(aq)){am=am.getParent()}}else{am=aq.getLast(function(at){return ae(an,at)})}if(!ar||!am){an.debug.logEnd("ABORT. There is no upper or no lower element.");return null}r(an,ar);r(an,am);if(!ag(an,ar,am)){an.debug.logEnd("ABORT. Mouse is already above upper or below lower.");return null}var ao=Number.MAX_VALUE,ap,ak,al,ai;while(am&&!am.equals(ar)){if(!(ak=ar.getNext(an.isRelevant))){break}ap=Math.abs(Y(an,ar,ak)-an.mouse.y);if(ap<ao){ao=ap;al=ar;ai=ak}ar=ak;r(an,ar)}an.debug.logElements([al,ai],["Min","MinNext"],"Post-processing results");if(!al||!ai){an.debug.logEnd("ABORT. No Min or MinNext");return null}if(!ag(an,al,ai)){an.debug.logEnd("ABORT. Mouse is already above minElement or below minElementNext.");return null}aj.upper=al;aj.lower=ai;an.debug.logEnd("SUCCESSFUL post-processing. Trigger created.");return aj.set(x,B)}function ae(aj,ai){return!(p(ai)||q(ai)||L(ai)||M(aj,ai)||ai.type==CKEDITOR.NODE_ELEMENT&&ai.$&&ai.is("br"))}function ag(ak,aj,ai){return X(ak.mouse.y,aj.size.top,ai.size.bottom)}function af(al,aj){al.debug.groupStart("expandFilter");var ak=aj.upper,ai=aj.lower;if(!ak||!ai||L(ai)||L(ak)||ai.equals(ak)||ak.equals(ai)||ai.contains(ak)||ak.contains(ai)){al.debug.logEnd("REJECTED. No upper or no lower or they contain each other.");return false}else{if(n(al,ak)&&n(al,ai)&&u(al,ak,ai)){al.debug.logElementsEnd([ak,ai],["upper","lower"],"APPROVED EDGE_MIDDLE");return true}}al.debug.logElementsEnd([ak,ai],["upper","lower"],"Rejected unknown pair");return false}return function(aj){aj.debug.groupStart("triggerExpand");var ai=ah(aj);aj.debug.groupEnd();return ai&&af(aj,ai)?ai:null}}();var ab=["top","left","right","bottom"];function F(al,ai,am,ae){var an=function(){var ap=k.ie?ai.$.currentStyle:al.win.$.getComputedStyle(ai.$,"");return k.ie?function(aq){return ap[CKEDITOR.tools.cssStyleToDomStyle(aq)]}:function(aq){return ap.getPropertyValue(aq)}}(),ak=ai.getDocumentPosition(),ag={},af={},ao={},aj={};for(var ah=ab.length;ah--;){ag[ab[ah]]=parseInt(an("border-"+ab[ah]+"-width"),10)||0;ao[ab[ah]]=parseInt(an("padding-"+ab[ah]),10)||0;af[ab[ah]]=parseInt(an("margin-"+ab[ah]),10)||0}if(!am||ae){U(al,ae)}aj.top=ak.y-(am?0:al.view.scroll.y),aj.left=ak.x-(am?0:al.view.scroll.x),aj.outerWidth=ai.$.offsetWidth,aj.outerHeight=ai.$.offsetHeight,aj.height=aj.outerHeight-(ao.top+ao.bottom+ag.top+ag.bottom),aj.width=aj.outerWidth-(ao.left+ao.right+ag.left+ag.right),aj.bottom=aj.top+aj.outerHeight,aj.right=aj.left+aj.outerWidth;if(al.inInlineMode){aj.scroll={top:ai.$.scrollTop,left:ai.$.scrollLeft}}return o({border:ag,padding:ao,margin:af,ignoreScroll:am},aj,true)}function r(af,ae,ag){if(!j(ae)){return ae.size=null}if(!ae.size){ae.size={}}else{if(ae.size.ignoreScroll==ag&&ae.size.date>new Date-O){af.debug.log("element.size: get from cache");return null}}af.debug.log("element.size: capture");return o(ae.size,F(af,ae,ag),{date:+new Date},true)}function w(ae,af){ae.view.editable=F(ae,ae.editable,af,true)}function U(ah,ai){if(!ah.view){ah.view={}}var af=ah.view;if(!ai&&af&&af.date>new Date-O){ah.debug.log("win.size: get from cache");return}ah.debug.log("win.size: capturing");var aj=ah.win,ae=aj.getScrollPosition(),ag=aj.getViewPaneSize();o(ah.view,{scroll:{x:ae.x,y:ae.y,width:ah.doc.$.documentElement.scrollWidth-ag.width,height:ah.doc.$.documentElement.scrollHeight-ag.height},pane:{width:ag.width,height:ag.height,bottom:ag.height+ae.y},date:+new Date},true)}function l(ah,ao,aj,am){var an=am,af=am,al=0,ae=false,ag=false,ak=ah.view.pane.height,ai=ah.mouse;while(ai.y+al<ak&&ai.y-al>0){if(!ae){ae=ao(an,am)}if(!ag){ag=ao(af,am)}if(!ae&&ai.y-al>0){an=aj(ah,{x:ai.x,y:ai.y-al})}if(!ag&&ai.y+al<ak){af=aj(ah,{x:ai.x,y:ai.y+al})}if(ae&&ag){break}al+=2}return new A([an,af,null,null])}})();CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51;CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52;