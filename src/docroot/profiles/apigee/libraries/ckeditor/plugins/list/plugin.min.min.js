(function(){var s={ol:1,ul:1},c=/^[\n\r\t ]*$/;var l=CKEDITOR.dom.walker.whitespaces(),d=CKEDITOR.dom.walker.bookmark(),e=function(x){return!(l(x)||d(x))},r=CKEDITOR.dom.walker.bogus();function b(z){var y,A,x;if(y=z.getDirection()){A=z.getParent();while(A&&!(x=A.getDirection())){A=A.getParent()}if(y==x){z.removeAttribute("dir")}}}function f(z,y){var x=z.getAttribute("style");x&&y.setAttribute("style",x.replace(/([^;])$/,"$1;")+(y.getAttribute("style")||""))}CKEDITOR.plugins.list={listToArray:function(A,I,G,F,H){if(!s[A.getName()]){return[]}if(!F){F=0}if(!G){G=[]}for(var C=0,D=A.getChildCount();C<D;C++){var x=A.getChild(C);if(x.type==CKEDITOR.NODE_ELEMENT&&x.getName()in CKEDITOR.dtd.$list){CKEDITOR.plugins.list.listToArray(x,I,G,F+1)}if(x.$.nodeName.toLowerCase()!="li"){continue}var E={parent:A,indent:F,element:x,contents:[]};if(!H){E.grandparent=A.getParent();if(E.grandparent&&E.grandparent.$.nodeName.toLowerCase()=="li"){E.grandparent=E.grandparent.getParent()}}else{E.grandparent=H}if(I){CKEDITOR.dom.element.setMarker(I,x,"listarray_index",G.length)}G.push(E);for(var B=0,y=x.getChildCount(),z;B<y;B++){z=x.getChild(B);if(z.type==CKEDITOR.NODE_ELEMENT&&s[z.getName()]){CKEDITOR.plugins.list.listToArray(z,I,G,F+1,E.grandparent)}else{E.contents.push(z)}}}return G},arrayToList:function(F,O,P,ab,S){if(!P){P=0}if(!F||F.length<P+1){return null}var W,aa=F[P].parent.getDocument(),R=new CKEDITOR.dom.documentFragment(aa),Z=null,y=P,T=Math.max(F[P].indent,0),x=null,C,J,M=ab==CKEDITOR.ENTER_P?"p":"div";while(1){var Y=F[y],z=Y.grandparent;C=Y.element.getDirection(1);if(Y.indent==T){if(!Z||F[y].parent.getName()!=Z.getName()){Z=F[y].parent.clone(false,1);S&&Z.setAttribute("dir",S);R.append(Z)}x=Z.append(Y.element.clone(0,1));if(C!=Z.getDirection(1)){x.setAttribute("dir",C)}for(W=0;W<Y.contents.length;W++){x.append(Y.contents[W].clone(1,1))}y++}else{if(Y.indent==Math.max(T,0)+1){var V=F[y-1].element.getDirection(1),Q=CKEDITOR.plugins.list.arrayToList(F,null,y,ab,V!=C?C:null);if(!x.getChildCount()&&CKEDITOR.env.needsNbspFiller&&!(aa.$.documentMode>7)){x.append(aa.createText("Â "))}x.append(Q.listNode);y=Q.nextIndex}else{if(Y.indent==-1&&!P&&z){if(s[z.getName()]){x=Y.element.clone(false,true);if(C!=z.getDirection(1)){x.setAttribute("dir",C)}}else{x=new CKEDITOR.dom.documentFragment(aa)}var L=z.getDirection(1)!=C,N=Y.element,A=N.getAttribute("class"),X=N.getAttribute("style");var H=x.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(ab!=CKEDITOR.ENTER_BR||L||X||A);var E,G=Y.contents.length,U;for(W=0;W<G;W++){E=Y.contents[W];if(d(E)&&G>1){if(!H){x.append(E.clone(1,1))}else{U=E.clone(1,1)}}else{if(E.type==CKEDITOR.NODE_ELEMENT&&E.isBlockBoundary()){if(L&&!E.getDirection()){E.setAttribute("dir",C)}f(N,E);A&&E.addClass(A);J=null;if(U){x.append(U);U=null}x.append(E.clone(1,1))}else{if(H){if(!J){J=aa.createElement(M);x.append(J);L&&J.setAttribute("dir",C)}X&&J.setAttribute("style",X);A&&J.setAttribute("class",A);if(U){J.append(U);U=null}J.append(E.clone(1,1))}else{x.append(E.clone(1,1))}}}}if(U){(J||x).append(U);U=null}if(x.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&y!=F.length-1){var K;if(CKEDITOR.env.needsBrFiller){K=x.getLast();if(K&&K.type==CKEDITOR.NODE_ELEMENT&&K.is("br")){K.remove()}}K=x.getLast(e);if(!(K&&K.type==CKEDITOR.NODE_ELEMENT&&K.is(CKEDITOR.dtd.$block))){x.append(aa.createElement("br"))}}var I=x.$.nodeName.toLowerCase();if(I=="div"||I=="p"){x.appendBogus()}R.append(x);Z=null;y++}else{return null}}}J=null;if(F.length<=y||Math.max(F[y].indent,0)<T){break}}if(O){var B=R.getFirst(),D=F[0].parent;while(B){if(B.type==CKEDITOR.NODE_ELEMENT){CKEDITOR.dom.element.clearMarkers(O,B);if(B.getName()in CKEDITOR.dtd.$listItem){b(B)}}B=B.getNextSourceNode()}}return{listNode:R,nextIndex:y}}};function g(H,G,L,M){var C=CKEDITOR.plugins.list.listToArray(G.root,L),J=[];for(var F=0;F<G.contents.length;F++){var A=G.contents[F];A=A.getAscendant("li",true);if(!A||A.getCustomData("list_item_processed")){continue}J.push(A);CKEDITOR.dom.element.setMarker(L,A,"list_item_processed",true)}var I=G.root,K=I.getDocument(),D,E;for(F=0;F<J.length;F++){var B=J[F].getCustomData("listarray_index");D=C[B].parent;if(!D.is(this.type)){E=K.createElement(this.type);D.copyAttributes(E,{start:1,type:1});E.removeStyle("list-style-type");C[B].parent=E}}var z=CKEDITOR.plugins.list.arrayToList(C,L,null,H.config.enterMode);var y,x=z.listNode.getChildCount();for(F=0;F<x&&(y=z.listNode.getChild(F));F++){if(y.getName()==this.type){M.push(y)}}z.listNode.replace(G.root);H.fire("contentDomInvalidated")}function a(y,D,C){var L=D.contents,P=D.root.getDocument(),N=[];if(L.length==1&&L[0].equals(D.root)){var K=P.createElement("div");L[0].moveChildren&&L[0].moveChildren(K);L[0].append(K);L[0]=K}var H=D.contents[0].getParent();for(var J=0;J<L.length;J++){H=H.getCommonAncestor(L[J].getParent())}var M=y.config.useComputedState,I,x;M=M===undefined||M;for(J=0;J<L.length;J++){var A=L[J],E;while(E=A.getParent()){if(E.equals(H)){N.push(A);if(!x&&A.getDirection()){x=1}var G=A.getDirection(M);if(I!==null){if(I&&I!=G){I=null}else{I=G}}break}A=E}}if(N.length<1){return}var O=N[N.length-1].getNext(),z=P.createElement(this.type);C.push(z);var B,F;while(N.length){B=N.shift();F=P.createElement("li");if(p(B)){B.appendTo(F)}else{B.copyAttributes(F);if(I&&B.getDirection()){F.removeStyle("direction");F.removeAttribute("dir")}B.moveChildren(F);B.remove()}F.appendTo(z)}if(I&&x){z.setAttribute("dir",I)}if(O){z.insertBefore(O)}else{z.appendTo(H)}}function u(G,F,M){var C=CKEDITOR.plugins.list.listToArray(F.root,M),K=[];for(var D=0;D<F.contents.length;D++){var z=F.contents[D];z=z.getAscendant("li",true);if(!z||z.getCustomData("list_item_processed")){continue}K.push(z);CKEDITOR.dom.element.setMarker(M,z,"list_item_processed",true)}var H=null;for(D=0;D<K.length;D++){var B=K[D].getCustomData("listarray_index");C[B].indent=-1;H=B}for(D=H+1;D<C.length;D++){if(C[D].indent>C[D-1].indent+1){var J=C[D-1].indent+1-C[D].indent;var A=C[D].indent;while(C[D]&&C[D].indent>=A){C[D].indent+=J;D++}D--}}var y=CKEDITOR.plugins.list.arrayToList(C,M,null,G.config.enterMode,F.root.getAttribute("dir"));var I=y.listNode,x,E;function L(N){if((x=I[N?"getFirst":"getLast"]())&&!(x.is&&x.isBlockBoundary())&&(E=F.root[N?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(true)))&&!(E.is&&E.isBlockBoundary({br:1}))){G.document.createElement("br")[N?"insertBefore":"insertAfter"](x)}}L(true);L();I.replace(F.root);G.fire("contentDomInvalidated")}var w=/^h[1-6]$/;function p(x){return x.is("pre")||w.test(x.getName())||x.getAttribute("contenteditable")=="false"}function o(x,y){this.name=x;this.type=y;this.context=y;this.allowedContent=y+" li";this.requiredContent=y}var k=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);function h(C,z,x,y){var B,A;while(B=C[y?"getLast":"getFirst"](k)){if((A=B.getDirection(1))!==z.getDirection(1)){B.setAttribute("dir",A)}B.remove();x?B[y?"insertBefore":"insertAfter"](x):z.append(B,y)}}o.prototype={exec:function(z){this.refresh(z,z.elementPath());var Z=z.document,W=z.config,Y=z.getSelection(),y=Y&&Y.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF){var P=z.editable();if(!P.getFirst(e)){W.enterMode==CKEDITOR.ENTER_BR?P.appendBogus():y[0].fixBlock(1,W.enterMode==CKEDITOR.ENTER_P?"p":"div");Y.selectRanges(y)}else{var K=y.length==1&&y[0],T=K&&K.getEnclosedNode();if(T&&T.is&&this.type==T.getName()){this.setState(CKEDITOR.TRISTATE_ON)}}}var B=Y.createBookmarks(true);var U=[],J={},I=y.createIterator(),D=0;while((K=I.getNextRange())&&++D){var S=K.getBoundaryNodes(),X=S.startNode,L=S.endNode;if(X.type==CKEDITOR.NODE_ELEMENT&&X.getName()=="td"){K.setStartAt(S.startNode,CKEDITOR.POSITION_AFTER_START)}if(L.type==CKEDITOR.NODE_ELEMENT&&L.getName()=="td"){K.setEndAt(S.endNode,CKEDITOR.POSITION_BEFORE_END)}var N=K.createIterator(),H;N.forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;while(H=N.getNextParagraph()){if(H.getCustomData("list_block")){continue}else{CKEDITOR.dom.element.setMarker(J,H,"list_block",1)}var M=z.elementPath(H),V=M.elements,R=V.length,A=null,G=0,C=M.blockLimit,x;for(var Q=R-1;Q>=0&&(x=V[Q]);Q--){if(s[x.getName()]&&C.contains(x)){C.removeCustomData("list_group_object_"+D);var F=x.getCustomData("list_group_object");if(F){F.contents.push(H)}else{F={root:x,contents:[H]};U.push(F);CKEDITOR.dom.element.setMarker(J,x,"list_group_object",F)}G=1;break}}if(G){continue}var O=C;if(O.getCustomData("list_group_object_"+D)){O.getCustomData("list_group_object_"+D).contents.push(H)}else{F={root:O,contents:[H]};CKEDITOR.dom.element.setMarker(J,O,"list_group_object_"+D,F);U.push(F)}}}var E=[];while(U.length>0){F=U.shift();if(this.state==CKEDITOR.TRISTATE_OFF){if(s[F.root.getName()]){g.call(this,z,F,J,E)}else{a.call(this,z,F,E)}}else{if(this.state==CKEDITOR.TRISTATE_ON&&s[F.root.getName()]){u.call(this,z,F,J)}}}for(Q=0;Q<E.length;Q++){v(E[Q])}CKEDITOR.dom.element.clearAllMarkers(J);Y.selectBookmarks(B);z.focus()},refresh:function(y,A){var z=A.contains(s,1),x=A.blockLimit||A.root;if(z&&x.contains(z)){this.setState(z.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}else{this.setState(CKEDITOR.TRISTATE_OFF)}}};var m=CKEDITOR.dtd;var t=/[\t\r\n ]*(?:&nbsp;|\xa0)$/;function v(y){var x;(x=function(A){var z=y[A?"getPrevious":"getNext"](e);if(z&&z.type==CKEDITOR.NODE_ELEMENT&&z.is(y.getName())){h(y,z,null,!A);y.remove();y=z}})();x(1)}function i(z,C){var B,y=z.children,A=y.length;for(var x=0;x<A;x++){B=y[x];if(B.name&&B.name in C){return x}}return A}function n(x){return x.type==CKEDITOR.NODE_ELEMENT&&(x.getName()in CKEDITOR.dtd.$block||x.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[x.getName()]["#"]}function j(D,F,O){D.fire("saveSnapshot");O.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var y=O.extractContents();F.trim(false,true);var x=F.createBookmark();var z=new CKEDITOR.dom.elementPath(F.startContainer),Q=z.block,B=z.lastElement.getAscendant("li",1)||Q,A=new CKEDITOR.dom.elementPath(O.startContainer),L=A.contains(CKEDITOR.dtd.$listItem),H=A.contains(CKEDITOR.dtd.$list),J;if(Q){var I=Q.getBogus();I&&I.remove()}else{if(H){J=H.getPrevious(e);if(J&&r(J)){J.remove()}}}J=y.getLast();if(J&&J.type==CKEDITOR.NODE_ELEMENT&&J.is("br")){J.remove()}var C=F.startContainer.getChild(F.startOffset);if(C){y.insertBefore(C)}else{F.startContainer.append(y)}if(L){var G=q(L);if(G){if(B.contains(L)){h(G,L.getParent(),L);G.remove()}else{B.append(G)}}}var M,K;while(O.checkStartOfBlock()&&O.checkEndOfBlock()){A=O.startPath();M=A.block;if(!M){break}if(M.is("li")){K=M.getParent();if(M.equals(K.getLast(e))&&M.equals(K.getFirst(e))){M=K}}O.moveToPosition(M,CKEDITOR.POSITION_BEFORE_START);M.remove()}var E=O.clone(),P=D.editable();E.setEndAt(P,CKEDITOR.POSITION_BEFORE_END);var R=new CKEDITOR.dom.walker(E);R.evaluator=function(S){return e(S)&&!r(S)};var N=R.next();if(N&&N.type==CKEDITOR.NODE_ELEMENT&&N.getName()in CKEDITOR.dtd.$list){v(N)}F.moveToBookmark(x);F.select();D.fire("saveSnapshot")}function q(x){var y=x.getLast(e);return y&&y.type==CKEDITOR.NODE_ELEMENT&&y.getName()in s?y:null}CKEDITOR.plugins.add("list",{lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"bulletedlist,bulletedlist-rtl,numberedlist,numberedlist-rtl",hidpi:true,requires:"indentlist",init:function(x){if(x.blockless){return}x.addCommand("numberedlist",new o("numberedlist","ol"));x.addCommand("bulletedlist",new o("bulletedlist","ul"));if(x.ui.addButton){x.ui.addButton("NumberedList",{label:x.lang.list.numberedlist,command:"numberedlist",directional:true,toolbar:"list,10"});x.ui.addButton("BulletedList",{label:x.lang.list.bulletedlist,command:"bulletedlist",directional:true,toolbar:"list,20"})}x.on("key",function(E){var P=E.data.keyCode;if(x.mode=="wysiwyg"&&P in{8:1,46:1}){var I=x.getSelection(),D=I.getRanges()[0],F=D&&D.startPath();if(!D||!D.collapsed){return}F=new CKEDITOR.dom.elementPath(D.startContainer);var O=P==8;var H=x.editable();var J=new CKEDITOR.dom.walker(D.clone());J.evaluator=function(Q){return e(Q)&&!r(Q)};J.guard=function(Q,R){return!(R&&Q.type==CKEDITOR.NODE_ELEMENT&&Q.is("table"))};var z=D.clone();if(O){var y,L;if((y=F.contains(s))&&D.checkBoundaryOfElement(y,CKEDITOR.START)&&(y=y.getParent())&&y.is("li")&&(y=q(y))){L=y;y=y.getPrevious(e);z.moveToPosition(y&&r(y)?y:L,CKEDITOR.POSITION_BEFORE_START)}else{J.range.setStartAt(H,CKEDITOR.POSITION_AFTER_START);J.range.setEnd(D.startContainer,D.startOffset);y=J.previous();if(y&&y.type==CKEDITOR.NODE_ELEMENT&&(y.getName()in s||y.is("li"))){if(!y.is("li")){J.range.selectNodeContents(y);J.reset();J.evaluator=n;y=J.previous()}L=y;z.moveToElementEditEnd(L)}}if(L){j(x,z,D);E.cancel()}else{var M=F.contains(s);if(M&&D.checkBoundaryOfElement(M,CKEDITOR.START)){C=M.getFirst(e);if(D.checkBoundaryOfElement(C,CKEDITOR.START)){y=M.getPrevious(e);if(q(C)){if(y){D.moveToElementEditEnd(y);D.select()}E.cancel()}else{x.execCommand("outdent");E.cancel()}}}}}else{var G,N,C=F.contains("li");if(C){J.range.setEndAt(H,CKEDITOR.POSITION_BEFORE_END);var B=C.getLast(e);var A=B&&n(B)?B:C;var K=0;G=J.next();if(G&&G.type==CKEDITOR.NODE_ELEMENT&&G.getName()in s&&G.equals(B)){K=1;G=J.next()}else{if(D.checkBoundaryOfElement(A,CKEDITOR.END)){K=1}}if(K&&G){N=D.clone();N.moveToElementEditStart(G);j(x,z,N);E.cancel()}}else{J.range.setEndAt(H,CKEDITOR.POSITION_BEFORE_END);G=J.next();if(G&&G.type==CKEDITOR.NODE_ELEMENT&&G.is(s)){G=G.getFirst(e);if(F.block&&D.checkStartOfBlock()&&D.checkEndOfBlock()){F.block.remove();D.moveToElementEditStart(G);D.select();E.cancel()}else{if(q(G)){D.moveToElementEditStart(G);D.select();E.cancel()}else{N=D.clone();N.moveToElementEditStart(G);j(x,z,N);E.cancel()}}}}}setTimeout(function(){x.selectionChange(1)})}})}})})();