CKEDITOR.plugins.add("menubutton",{requires:"button,menu",onLoad:function(){var a=function(c){var b=this._,d=b.menu;if(b.state===CKEDITOR.TRISTATE_DISABLED){return}if(b.on&&d){d.hide();return}b.previousState=b.state;if(!d){d=b.menu=new CKEDITOR.menu(c,{panel:{className:"cke_menu_panel",attributes:{"aria-label":c.lang.common.options}}});d.onHide=CKEDITOR.tools.bind(function(){var e=this.command?c.getCommand(this.command).modes:this.modes;this.setState(!e||e[c.mode]?b.previousState:CKEDITOR.TRISTATE_DISABLED);b.on=0},this);if(this.onMenu){d.addListener(this.onMenu)}}this.setState(CKEDITOR.TRISTATE_ON);b.on=1;setTimeout(function(){d.show(CKEDITOR.document.getById(b.id),4)},0)};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(b){var c=b.panel;delete b.panel;this.base(b);this.hasArrow=true;this.click=a},statics:{handler:{create:function(b){return new CKEDITOR.ui.menuButton(b)}}}})},beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}});CKEDITOR.UI_MENUBUTTON="menubutton";