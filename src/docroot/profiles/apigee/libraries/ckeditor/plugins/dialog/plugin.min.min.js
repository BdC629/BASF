CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){var h=CKEDITOR.tools.cssLength;function f(H){return!!this._.tabs[H][0].$.offsetHeight}function q(){var I=this._.currentTabId,K=this._.tabIdList.length,H=CKEDITOR.tools.indexOf(this._.tabIdList,I)+K;for(var J=H-1;J>H-K;J--){if(f.call(this,this._.tabIdList[J%K])){return this._.tabIdList[J%K]}}return null}function C(){var I=this._.currentTabId,K=this._.tabIdList.length,H=CKEDITOR.tools.indexOf(this._.tabIdList,I);for(var J=H+1;J<H+K;J++){if(f.call(this,this._.tabIdList[J%K])){return this._.tabIdList[J%K]}}return null}function r(I,K){var H=I.$.getElementsByTagName("input");for(var J=0,M=H.length;J<M;J++){var L=new CKEDITOR.dom.element(H[J]);if(L.getAttribute("type").toLowerCase()=="text"){if(K){L.setAttribute("value",L.getCustomData("fake_value")||"");L.removeCustomData("fake_value")}else{L.setCustomData("fake_value",L.getAttribute("value"));L.setAttribute("value","")}}}}function a(I,J){var H=this.getInputElement();if(H){I?H.removeAttribute("aria-invalid"):H.setAttribute("aria-invalid",true)}if(!I){if(this.select){this.select()}else{this.focus()}}J&&alert(J);this.fire("validated",{valid:I,msg:J})}function z(){var H=this.getInputElement();H&&H.removeAttribute("aria-invalid")}var d='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';function s(K){var I=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",d).output({id:CKEDITOR.tools.getNextNumber(),editorId:K.id,langDir:K.lang.dir,langCode:K.langCode,editorDialogClass:"cke_editor_"+K.name.replace(/\./g,"\\.")+"_dialog",closeTitle:K.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""}));var H=I.getChild([0,0,0,0,0]),N=H.getChild(0),M=H.getChild(1);if(CKEDITOR.env.ie&&!CKEDITOR.env.ie6Compat){var L="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())",J=CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+L+'" tabIndex="-1"></iframe>');J.appendTo(H.getParent())}N.unselectable();M.unselectable();return{element:I,parts:{dialog:I.getChild(0),title:N,close:M,tabs:H.getChild(2),contents:H.getChild([3,0,0,0]),footer:H.getChild([3,0,1,0])}}}CKEDITOR.dialog=function(K,N){var L=CKEDITOR.dialog._.dialogDefinitions[N],Y=CKEDITOR.tools.clone(u),af=K.config.dialog_buttonsOrder||"OS",S=K.lang.dir,J={},Z,H,P;if(af=="OS"&&CKEDITOR.env.mac||af=="rtl"&&S=="ltr"||af=="ltr"&&S=="rtl"){Y.buttons.reverse()}L=CKEDITOR.tools.extend(L(K),Y);L=CKEDITOR.tools.clone(L);L=new t(this,L);var ag=CKEDITOR.document;var X=s(K);this._={editor:K,element:X.element,name:N,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=X.parts;CKEDITOR.tools.setTimeout(function(){K.fire("ariaWidget",this.parts.contents)},0,this);var ad={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"};ad[S=="rtl"?"right":"left"]=0;this.parts.dialog.setStyles(ad);CKEDITOR.event.call(this);this.definition=L=CKEDITOR.fire("dialogDefinition",{name:N,definition:L},K).definition;if(!("removeDialogTabs"in K._)&&K.config.removeDialogTabs){var ac=K.config.removeDialogTabs.split(";");for(Z=0;Z<ac.length;Z++){var T=ac[Z].split(":");if(T.length==2){var I=T[0];if(!J[I]){J[I]=[]}J[I].push(T[1])}}K._.removeDialogTabs=J}if(K._.removeDialogTabs&&(J=K._.removeDialogTabs[N])){for(Z=0;Z<J.length;Z++){L.removeContents(J[Z])}}if(L.onLoad){this.on("load",L.onLoad)}if(L.onShow){this.on("show",L.onShow)}if(L.onHide){this.on("hide",L.onHide)}if(L.onOk){this.on("ok",function(ah){K.fire("saveSnapshot");setTimeout(function(){K.fire("saveSnapshot")},0);if(L.onOk.call(this,ah)===false){ah.data.hide=false}})}if(L.onCancel){this.on("cancel",function(ah){if(L.onCancel.call(this,ah)===false){ah.data.hide=false}})}var ae=this;var V=function(al){var ak=ae._.contents,aj=false;for(var ai in ak){for(var ah in ak[ai]){aj=al.call(this,ak[ai][ah]);if(aj){return}}}};this.on("ok",function(ah){V(function(aj){if(aj.validate){var ai=aj.validate(this),ak=typeof ai=="string"||ai===false;if(ak){ah.data.hide=false;ah.stop()}a.call(aj,!ak,typeof ai=="string"?ai:undefined);return ak}})},this,null,0);this.on("cancel",function(ah){V(function(ai){if(ai.isChanged()){if(!K.config.dialog_noConfirmCancel&&!confirm(K.lang.common.confirmCancel)){ah.data.hide=false}return true}})},this,null,0);this.parts.close.on("click",function(ah){if(this.fire("cancel",{hide:true}).hide!==false){this.hide()}ah.data.preventDefault()},this);function R(){var aj=ae._.focusList;aj.sort(function(al,ak){if(al.tabIndex!=ak.tabIndex){return ak.tabIndex-al.tabIndex}else{return al.focusIndex-ak.focusIndex}});var ai=aj.length;for(var ah=0;ah<ai;ah++){aj[ah].focusIndex=ah}}function ab(al){var am=ae._.focusList;al=al||0;if(am.length<1){return}var aj=ae._.currentFocusIndex;try{am[aj].getInputElement().$.blur()}catch(ai){}var ak=(aj+al+am.length)%am.length,ah=ak;while(al&&!am[ah].isFocusable()){ah=(ah+al+am.length)%am.length;if(ah==ak){break}}am[ah].focus();if(am[ah].type=="text"){am[ah].select()}}this.changeFocus=ab;function O(ah){if(ae!=CKEDITOR.dialog._.currentTop){return}var an=ah.data.getKeystroke(),am=K.lang.dir=="rtl",ai;H=P=0;if(an==9||an==CKEDITOR.SHIFT+9){var ak=an==CKEDITOR.SHIFT+9;if(ae._.tabBarMode){var aj=ak?q.call(ae):C.call(ae);ae.selectPage(aj);ae._.tabs[aj][0].focus()}else{ab(ak?-1:1)}H=1}else{if(an==CKEDITOR.ALT+121&&!ae._.tabBarMode&&ae.getPageCount()>1){ae._.tabBarMode=true;ae._.tabs[ae._.currentTabId][0].focus();H=1}else{if((an==37||an==39)&&ae._.tabBarMode){aj=an==(am?39:37)?q.call(ae):C.call(ae);ae.selectPage(aj);ae._.tabs[aj][0].focus();H=1}else{if((an==13||an==32)&&ae._.tabBarMode){this.selectPage(this._.currentTabId);this._.tabBarMode=false;this._.currentFocusIndex=-1;ab(1);H=1}else{if(an==13){var al=ah.data.getTarget();if(!al.is("a","button","select","textarea")&&(!al.is("input")||al.$.type!="button")){ai=this.getButton("ok");ai&&CKEDITOR.tools.setTimeout(ai.click,0,ai);H=1}P=1}else{if(an==27){ai=this.getButton("cancel");if(ai){CKEDITOR.tools.setTimeout(ai.click,0,ai)}else{if(this.fire("cancel",{hide:true}).hide!==false){this.hide()}}P=1}else{return}}}}}}U(ah)}function U(ah){if(H){ah.data.preventDefault(1)}else{if(P){ah.data.stopPropagation()}}}var W=this._.element;K.focusManager.add(W,1);this.on("show",function(){W.on("keydown",O,this);if(CKEDITOR.env.opera||CKEDITOR.env.gecko){W.on("keypress",U,this)}});this.on("hide",function(){W.removeListener("keydown",O);if(CKEDITOR.env.opera||CKEDITOR.env.gecko){W.removeListener("keypress",U)}V(function(ah){z.apply(ah)})});this.on("iframeAdded",function(ah){var ai=new CKEDITOR.dom.document(ah.data.iframe.$.contentWindow.document);ai.on("keydown",O,this,null,0)});this.on("show",function(){R();if(K.config.dialog_startupFocusTab&&ae._.pageCount>1){ae._.tabBarMode=true;ae._.tabs[ae._.currentTabId][0].focus()}else{if(!this._.hasFocus){this._.currentFocusIndex=-1;if(L.onFocus){var ah=L.onFocus.call(this);ah&&ah.focus()}else{ab(1)}}}},this,null,4294967295);if(CKEDITOR.env.ie6Compat){this.on("load",function(ah){var aj=this.getElement(),ai=aj.getFirst();ai.remove();ai.appendTo(aj)},this)}w(this);F(this);new CKEDITOR.dom.text(L.title,CKEDITOR.document).appendTo(this.parts.title);for(Z=0;Z<L.contents.length;Z++){var M=L.contents[Z];M&&this.addPage(M)}this.parts.tabs.on("click",function(ah){var ai=ah.data.getTarget();if(ai.hasClass("cke_dialog_tab")){var aj=ai.$.id;this.selectPage(aj.substring(4,aj.lastIndexOf("_")));if(this._.tabBarMode){this._.tabBarMode=false;this._.currentFocusIndex=-1;ab(1)}ah.data.preventDefault()}},this);var Q=[],aa=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:L.buttons},Q).getChild();this.parts.footer.setHtml(Q.join(""));for(Z=0;Z<aa.length;Z++){this._.buttons[aa[Z].id]=aa[Z]}};function E(J,I,H){this.element=I;this.focusIndex=H;this.tabIndex=0;this.isFocusable=function(){return!I.getAttribute("disabled")&&I.isVisible()};this.focus=function(){J._.currentFocusIndex=this.focusIndex;this.element.focus()};I.on("keydown",function(K){if(K.data.getKeystroke()in{32:1,13:1}){this.fire("click")}});I.on("focus",function(){this.fire("mouseover")});I.on("blur",function(){this.fire("mouseout")})}function x(I){var J=CKEDITOR.document.getWindow();function H(){I.layout()}J.on("resize",H);I.on("hide",function(){J.removeListener("resize",H)})}CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove()},resize:function(){return function(I,H){if(this._.contentSize&&this._.contentSize.width==I&&this._.contentSize.height==H){return}CKEDITOR.dialog.fire("resize",{dialog:this,width:I,height:H},this._.editor);this.fire("resize",{width:I,height:H},this._.editor);var J=this.parts.contents;J.setStyles({width:I+"px",height:H+"px"});if(this._.editor.lang.dir=="rtl"&&this._.position){this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)}this._.contentSize={width:I,height:H}}}(),getSize:function(){var H=this._.element.getFirst();return{width:H.$.offsetWidth||0,height:H.$.offsetHeight||0}},move:function(P,M,L){var J=this._.element.getFirst(),N=this._.editor.lang.dir=="rtl";var I=J.getComputedStyle("position")=="fixed";if(CKEDITOR.env.ie){J.setStyle("zoom","100%")}if(I&&this._.position&&this._.position.x==P&&this._.position.y==M){return}this._.position={x:P,y:M};if(!I){var O=CKEDITOR.document.getWindow().getScrollPosition();P+=O.x;M+=O.y}if(N){var H=this.getSize(),K=CKEDITOR.document.getWindow().getViewPaneSize();P=K.width-H.width-P}var Q={top:(M>0?M:0)+"px"};Q[N?"right":"left"]=(P>0?P:0)+"px";J.setStyles(Q);L&&(this._.moved=1)},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var M=this._.element;var I=this.definition;if(!(M.getParent()&&M.getParent().equals(CKEDITOR.document.getBody()))){M.appendTo(CKEDITOR.document.getBody())}else{M.setStyle("display","block")}if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var P=this.parts.dialog;P.setStyle("position","absolute");setTimeout(function(){P.setStyle("position","fixed")},0)}this.resize(this._.contentSize&&this._.contentSize.width||I.width||I.minWidth,this._.contentSize&&this._.contentSize.height||I.height||I.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null){CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex}this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;i(this._.editor)}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;var R=this._.parentDialog.getElement().getFirst();R.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this}M.on("keydown",n);M.on(CKEDITOR.env.opera?"keypress":"keyup",A);this._.hasFocus=false;for(var N in I.contents){if(!I.contents[N]){continue}var O=I.contents[N],H=this._.tabs[O.id],K=O.requiredContent,Q=0;if(!H){continue}for(var L in this._.contents[O.id]){var J=this._.contents[O.id][L];if(J.type=="hbox"||J.type=="vbox"||!J.getInputElement()){continue}if(J.requiredContent&&!this._.editor.activeFilter.check(J.requiredContent)){J.disable()}else{J.enable();Q++}}if(!Q||K&&!this._.editor.activeFilter.check(K)){H[0].addClass("cke_dialog_tab_disabled")}else{H[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout();x(this);this.parts.dialog.setStyle("visibility","");this.fireOnce("load",{});CKEDITOR.ui.fire("ready",this);this.fire("show",{});this._.editor.fire("dialogShow",this);if(!this._.parentDialog){this._.editor.focusManager.lock()}this.foreach(function(S){S.setInitValue&&S.setInitValue()})},100,this)},layout:function(){var H=this.parts.dialog;var J=this.getSize();var I=CKEDITOR.document.getWindow(),M=I.getViewPaneSize();var L=(M.width-J.width)/2,K=(M.height-J.height)/2;if(!CKEDITOR.env.ie6Compat){if(J.height+(K>0?K:0)>M.height||J.width+(L>0?L:0)>M.width){H.setStyle("position","absolute")}else{H.setStyle("position","fixed")}}this.move(this._.moved?this._.position.x:L,this._.moved?this._.position.y:K)},foreach:function(J){for(var I in this._.contents){for(var H in this._.contents[I]){J.call(this,this._.contents[I][H])}}return this},reset:function(){var H=function(I){if(I.reset){I.reset(1)}};return function(){this.foreach(H);return this}}(),setupContent:function(){var H=arguments;this.foreach(function(I){if(I.setup){I.setup.apply(I,H)}})},commitContent:function(){var H=arguments;this.foreach(function(I){if(CKEDITOR.env.ie&&this._.currentFocusIndex==I.focusIndex){I.getInputElement().$.blur()}if(I.commit){I.commit.apply(I,H)}})},hide:function(){if(!this.parts.dialog.isVisible()){return}this.fire("hide",{});this._.editor.fire("dialogHide",this);this.selectPage(this._.tabIdList[0]);var I=this._.element;I.setStyle("display","none");this.parts.dialog.setStyle("visibility","hidden");k(this);while(CKEDITOR.dialog._.currentTop!=this){CKEDITOR.dialog._.currentTop.hide()}if(!this._.parentDialog){o(this._.editor)}else{var H=this._.parentDialog.getElement().getFirst();H.setStyle("z-index",parseInt(H.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}CKEDITOR.dialog._.currentTop=this._.parentDialog;if(!this._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;I.removeListener("keydown",n);I.removeListener(CKEDITOR.env.opera?"keypress":"keyup",A);var J=this._.editor;J.focus();setTimeout(function(){J.focusManager.unlock()},0)}else{CKEDITOR.dialog._.currentZIndex-=10}delete this._.parentDialog;this.foreach(function(K){K.resetInitValue&&K.resetInitValue()})},addPage:function(M){if(M.requiredContent&&!this._.editor.filter.check(M.requiredContent)){return}var K=[],Q=M.label?' title="'+CKEDITOR.tools.htmlEncode(M.label)+'"':"",H=M.elements,S=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:M.elements,expand:!!M.expand,padding:M.padding,style:M.style||"width: 100%;"},K);var N=this._.contents[M.id]={},T,J=S.getChild(),P=0;while(T=J.shift()){if(!T.notAllowed&&T.type!="hbox"&&T.type!="vbox"){P++}N[T.id]=T;if(typeof T.getChild=="function"){J.push.apply(J,T.getChild())}}if(!P){M.hidden=true}var R=CKEDITOR.dom.element.createFromHtml(K.join(""));R.setAttribute("role","tabpanel");var O=CKEDITOR.env;var I="cke_"+M.id+"_"+CKEDITOR.tools.getNextNumber(),L=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',this._.pageCount>0?" cke_last":"cke_first",Q,!!M.hidden?' style="display:none"':"",' id="',I,'"',O.gecko&&O.version>=10900&&!O.hc?"":' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',M.label,"</a>"].join(""));R.setAttribute("aria-labelledby",I);this._.tabs[M.id]=[L,R];this._.tabIdList.push(M.id);!M.hidden&&this._.pageCount++;this._.lastTab=L;this.updateStyle();R.setAttribute("name",M.id);R.appendTo(this.parts.contents);L.unselectable();this.parts.tabs.append(L);if(M.accessKey){l(this,this,"CTRL+"+M.accessKey,G,g);this._.accessKeyMap["CTRL+"+M.accessKey]=M.id}},selectPage:function(L){if(this._.currentTabId==L){return}if(this._.tabs[L][0].hasClass("cke_dialog_tab_disabled")){return}if(this.fire("selectPage",{page:L,currentPage:this._.currentTabId})===true){return}for(var H in this._.tabs){var J=this._.tabs[H][0],K=this._.tabs[H][1];if(H!=L){J.removeClass("cke_dialog_tab_selected");K.hide()}K.setAttribute("aria-hidden",H!=L)}var I=this._.tabs[L];I[0].addClass("cke_dialog_tab_selected");if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){r(I[1]);I[1].show();setTimeout(function(){r(I[1],1)},0)}else{I[1].show()}this._.currentTabId=L;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,L)},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(I){var H=this._.tabs[I]&&this._.tabs[I][0];if(!H||this._.pageCount==1||!H.isVisible()){return}else{if(I==this._.currentTabId){this.selectPage(q.call(this))}}H.hide();this._.pageCount--;this.updateStyle()},showPage:function(I){var H=this._.tabs[I]&&this._.tabs[I][0];if(!H){return}H.show();this._.pageCount++;this.updateStyle()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(I,H){var J=this._.contents[I];return J&&J[H]},getValueOf:function(I,H){return this.getContentElement(I,H).getValue()},setValueOf:function(I,H,J){return this.getContentElement(I,H).setValue(J)},getButton:function(H){return this._.buttons[H]},click:function(H){return this._.buttons[H].click()},disableButton:function(H){return this._.buttons[H].disable()},enableButton:function(H){return this._.buttons[H].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(J,H){if(typeof H=="undefined"){H=this._.focusList.length;this._.focusList.push(new E(this,J,H))}else{this._.focusList.splice(H,0,new E(this,J,H));for(var I=H+1;I<this._.focusList.length;I++){this._.focusList[I].focusIndex++}}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(H,I){if(!this._.dialogDefinitions[H]||typeof I=="function"){this._.dialogDefinitions[H]=I}},exists:function(H){return!!this._.dialogDefinitions[H]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(I,K,J){var H=I.config.removeDialogTabs;return!(H&&H.match(new RegExp("(?:^|;)"+K+":"+J+"(?:$|;)","i")))},okButton:function(){var H=function(J,I){I=I||{};return CKEDITOR.tools.extend({id:"ok",type:"button",label:J.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(K){var L=K.data.dialog;if(L.fire("ok",{hide:true}).hide!==false){L.hide()}}},I,true)};H.type="button";H.override=function(I){return CKEDITOR.tools.extend(function(J){return H(J,I)},{type:"button"},true)};return H}(),cancelButton:function(){var H=function(J,I){I=I||{};return CKEDITOR.tools.extend({id:"cancel",type:"button",label:J.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(K){var L=K.data.dialog;if(L.fire("cancel",{hide:true}).hide!==false){L.hide()}}},I,true)};H.type="button";H.override=function(I){return CKEDITOR.tools.extend(function(J){return H(J,I)},{type:"button"},true)};return H}(),addUIElement:function(I,H){this._.uiElementBuilders[I]=H}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var u={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]};var B=function(M,L,K){for(var I=0,J;J=M[I];I++){if(J.id==L){return J}if(K&&J[K]){var H=B(J[K],L,K);if(H){return H}}}return null};var c=function(O,J,N,L,M){if(N){for(var I=0,K;K=O[I];I++){if(K.id==N){O.splice(I,0,J);return J}if(L&&K[L]){var H=c(K[L],J,N,L,true);if(H){return H}}}if(M){return null}}O.push(J);return J};var j=function(M,L,K){for(var I=0,J;J=M[I];I++){if(J.id==L){return M.splice(I,1)}if(K&&J[K]){var H=j(J[K],L,K);if(H){return H}}}return null};var t=function(I,L){this.dialog=I;var K=L.contents;for(var H=0,J;J=K[H];H++){K[H]=J&&new b(I,J)}CKEDITOR.tools.extend(this,L)};t.prototype={getContents:function(H){return B(this.contents,H)},getButton:function(H){return B(this.buttons,H)},addContents:function(H,I){return c(this.contents,H,I)},addButton:function(H,I){return c(this.buttons,H,I)},removeContents:function(H){j(this.contents,H)},removeButton:function(H){j(this.buttons,H)}};function b(H,I){this._={dialog:H};CKEDITOR.tools.extend(this,I)}b.prototype={get:function(H){return B(this.elements,H,"children")},add:function(I,H){return c(this.elements,I,H,"children")},remove:function(H){j(this.elements,H,"children")}};function w(M){var J=null,O=null,I=M.getElement().getFirst(),K=M.getParentEditor(),H=K.config.dialog_magnetDistance,N=CKEDITOR.skin.margins||[0,0,0,0];if(typeof H=="undefined"){H=20}function L(W){var Q=M.getSize(),T=CKEDITOR.document.getWindow().getViewPaneSize(),V=W.data.$.screenX,U=W.data.$.screenY,Y=V-J.x,X=U-J.y,S,R;J={x:V,y:U};O.x+=Y;O.y+=X;if(O.x+N[3]<H){S=-N[3]}else{if(O.x-N[1]>T.width-Q.width-H){S=T.width-Q.width+(K.lang.dir=="rtl"?0:N[1])}else{S=O.x}}if(O.y+N[0]<H){R=-N[0]}else{if(O.y-N[2]>T.height-Q.height-H){R=T.height-Q.height+N[2]}else{R=O.y}}M.move(S,R,1);W.data.preventDefault()}function P(Q){CKEDITOR.document.removeListener("mousemove",L);CKEDITOR.document.removeListener("mouseup",P);if(CKEDITOR.env.ie6Compat){var R=v.getChild(0).getFrameDocument();R.removeListener("mousemove",L);R.removeListener("mouseup",P)}}M.parts.title.on("mousedown",function(Q){J={x:Q.data.$.screenX,y:Q.data.$.screenY};CKEDITOR.document.on("mousemove",L);CKEDITOR.document.on("mouseup",P);O=M.getPosition();if(CKEDITOR.env.ie6Compat){var R=v.getChild(0).getFrameDocument();R.on("mousemove",L);R.on("mouseup",P)}Q.data.preventDefault()},M)}function F(N){var I=N.definition,H=I.resizable;if(H==CKEDITOR.DIALOG_RESIZE_NONE){return}var M=N.getParentEditor();var K,J,O,Q,R,T;var P=CKEDITOR.tools.addFunction(function(V){R=N.getSize();var W=N.parts.contents,U=W.$.getElementsByTagName("iframe").length;if(U){T=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>');W.append(T)}J=R.height-N.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks));K=R.width-N.parts.contents.getSize("width",1);Q={x:V.screenX,y:V.screenY};O=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on("mousemove",L);CKEDITOR.document.on("mouseup",S);if(CKEDITOR.env.ie6Compat){var X=v.getChild(0).getFrameDocument();X.on("mousemove",L);X.on("mouseup",S)}V.preventDefault&&V.preventDefault()});N.on("load",function(){var U="";if(H==CKEDITOR.DIALOG_RESIZE_WIDTH){U=" cke_resizer_horizontal"}else{if(H==CKEDITOR.DIALOG_RESIZE_HEIGHT){U=" cke_resizer_vertical"}}var V=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+U+" cke_resizer_"+M.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(M.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+P+', event )">'+(M.lang.dir=="ltr"?"◢":"◣")+"</div>");N.parts.footer.append(V,1)});M.on("destroy",function(){CKEDITOR.tools.removeFunction(P)});function L(ab){var Z=M.lang.dir=="rtl",ae=(ab.data.$.screenX-Q.x)*(Z?-1:1),ad=ab.data.$.screenY-Q.y,U=R.width,ac=R.height,V=U+ae*(N._.moved?1:2),X=ac+ad*(N._.moved?1:2),W=N._.element.getFirst(),aa=Z&&W.getComputedStyle("right"),Y=N.getPosition();if(Y.y+X>O.height){X=O.height-Y.y}if((Z?aa:Y.x)+V>O.width){V=O.width-(Z?aa:Y.x)}if(H==CKEDITOR.DIALOG_RESIZE_WIDTH||H==CKEDITOR.DIALOG_RESIZE_BOTH){U=Math.max(I.minWidth||0,V-K)}if(H==CKEDITOR.DIALOG_RESIZE_HEIGHT||H==CKEDITOR.DIALOG_RESIZE_BOTH){ac=Math.max(I.minHeight||0,X-J)}N.resize(U,ac);if(!N._.moved){N.layout()}ab.data.preventDefault()}function S(){CKEDITOR.document.removeListener("mouseup",S);CKEDITOR.document.removeListener("mousemove",L);if(T){T.remove();T=null}if(CKEDITOR.env.ie6Compat){var U=v.getChild(0).getFrameDocument();U.removeListener("mouseup",S);U.removeListener("mousemove",L)}}}var p;var m={},v;function D(H){H.data.preventDefault(1)}function i(O){var N=CKEDITOR.document.getWindow();var I=O.config,P=I.dialog_backgroundCoverColor||"white",K=I.dialog_backgroundCoverOpacity,Q=I.baseFloatZIndex,S=CKEDITOR.tools.genKey(P,K,Q),J=m[S];if(!J){var M=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",Q,"; top: 0px; left: 0px; ",!CKEDITOR.env.ie6Compat?"background-color: "+P:"",'" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){var R="<html><body style=\\'background-color:"+P+";\\'></body></html>";M.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');M.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+R+"' );document.close();")+"})())");M.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}M.push("</div>");J=CKEDITOR.dom.element.createFromHtml(M.join(""));J.setOpacity(K!=undefined?K:.5);J.on("keydown",D);J.on("keypress",D);J.on("keyup",D);J.appendTo(CKEDITOR.document.getBody());m[S]=J}else{J.show()}O.focusManager.add(J);v=J;var T=function(){var U=N.getViewPaneSize();J.setStyles({width:U.width+"px",height:U.height+"px"})};var L=function(){var W=N.getScrollPosition(),V=CKEDITOR.dialog._.currentTop;J.setStyles({left:W.x+"px",top:W.y+"px"});if(V){do{var U=V.getPosition();V.move(U.x,U.y)}while(V=V._.parentDialog)}};p=T;N.on("resize",T);T();if(!(CKEDITOR.env.mac&&CKEDITOR.env.webkit)){J.focus()}if(CKEDITOR.env.ie6Compat){var H=function(){L();arguments.callee.prevScrollHandler.apply(this,arguments)};N.$.setTimeout(function(){H.prevScrollHandler=window.onscroll||function(){};window.onscroll=H},0);L()}}function o(H){if(!v){return}H.focusManager.remove(v);var I=CKEDITOR.document.getWindow();v.hide();I.removeListener("resize",p);if(CKEDITOR.env.ie6Compat){I.$.setTimeout(function(){var J=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=J||null},0)}p=null}function e(){for(var H in m){m[H].remove()}m={}}var y={};var n=function(J){var L=J.data.$.ctrlKey||J.data.$.metaKey,M=J.data.$.altKey,I=J.data.$.shiftKey,K=String.fromCharCode(J.data.$.keyCode),H=y[(L?"CTRL+":"")+(M?"ALT+":"")+(I?"SHIFT+":"")+K];if(!H||!H.length){return}H=H[H.length-1];H.keydown&&H.keydown.call(H.uiElement,H.dialog,H.key);J.data.preventDefault()};var A=function(J){var L=J.data.$.ctrlKey||J.data.$.metaKey,M=J.data.$.altKey,I=J.data.$.shiftKey,K=String.fromCharCode(J.data.$.keyCode),H=y[(L?"CTRL+":"")+(M?"ALT+":"")+(I?"SHIFT+":"")+K];if(!H||!H.length){return}H=H[H.length-1];if(H.keyup){H.keyup.call(H.uiElement,H.dialog,H.key);J.data.preventDefault()}};var l=function(H,J,I,K,M){var L=y[I]||(y[I]=[]);L.push({uiElement:H,dialog:J,key:I,keyup:M||H.accessKeyUp,keydown:K||H.accessKeyDown})};var k=function(K){for(var I in y){var J=y[I];for(var H=J.length-1;H>=0;H--){if(J[H].dialog==K||J[H].uiElement==K){J.splice(H,1)}}if(J.length===0){delete y[I]}}};var g=function(I,H){if(I._.accessKeyMap[H]){I.selectPage(I._.accessKeyMap[H])}};var G=function(I,H){};(function(){CKEDITOR.ui.dialog={uiElement:function(Z,T,U,K,W,I,J){if(arguments.length<4){return}var H=(K.call?K(T):K)||"div",R=["<",H," "],Q=(W&&W.call?W(T):W)||{},P=(I&&I.call?I(T):I)||{},N=(J&&J.call?J.call(this,Z,T):J)||"",M=this.domId=P.id||CKEDITOR.tools.getNextId()+"_uiElement",V=this.id=T.id,Y;if(T.requiredContent&&!Z.getParentEditor().filter.check(T.requiredContent)){Q.display="none";this.notAllowed=true}P.id=M;var aa={};if(T.type){aa["cke_dialog_ui_"+T.type]=1}if(T.className){aa[T.className]=1}if(T.disabled){aa.cke_disabled=1}var O=P["class"]&&P["class"].split?P["class"].split(" "):[];for(Y=0;Y<O.length;Y++){if(O[Y]){aa[O[Y]]=1}}var L=[];for(Y in aa){L.push(Y)}P["class"]=L.join(" ");if(T.title){P.title=T.title}var S=(T.style||"").split(";");if(T.align){var X=T.align;Q["margin-left"]=X=="left"?0:"auto";Q["margin-right"]=X=="right"?0:"auto"}for(Y in Q){S.push(Y+":"+Q[Y])}if(T.hidden){S.push("display:none")}for(Y=S.length-1;Y>=0;Y--){if(S[Y]===""){S.splice(Y,1)}}if(S.length>0){P.style=(P.style?P.style+"; ":"")+S.join("; ")}for(Y in P){R.push(Y+'="'+CKEDITOR.tools.htmlEncode(P[Y])+'" ')}R.push(">",N,"</",H,">");U.push(R.join(""));(this._||(this._={})).dialog=Z;if(typeof T.isChanged=="boolean"){this.isChanged=function(){return T.isChanged}}if(typeof T.isChanged=="function"){this.isChanged=T.isChanged}if(typeof T.setValue=="function"){this.setValue=CKEDITOR.tools.override(this.setValue,function(ac){return function(ad){ac.call(this,T.setValue.call(this,ad))}})}if(typeof T.getValue=="function"){this.getValue=CKEDITOR.tools.override(this.getValue,function(ac){return function(){return T.getValue.call(this,ac.call(this))}})}CKEDITOR.event.implementOn(this);this.registerEvents(T);if(this.accessKeyUp&&this.accessKeyDown&&T.accessKey){l(this,Z,"CTRL+"+T.accessKey)}var ab=this;Z.on("load",function(){var ac=ab.getInputElement();if(ac){var ad=ab.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?"cke_dialog_ui_focused":"";ac.on("focus",function(){Z._.tabBarMode=false;Z._.hasFocus=true;ab.fire("focus");ad&&this.addClass(ad)});ac.on("blur",function(){ab.fire("blur");ad&&this.removeClass(ad)})}});CKEDITOR.tools.extend(this,T);if(this.keyboardFocusable){this.tabIndex=T.tabIndex||0;this.focusIndex=Z._.focusList.push(this)-1;this.on("focus",function(){Z._.currentFocusIndex=ab.focusIndex})}},hbox:function(N,R,S,J,I){if(arguments.length<4){return}this._||(this._={});var K=this._.children=R,L=I&&I.widths||null,P=I&&I.height||null,Q={},M;var O=function(){var T=['<tbody><tr class="cke_dialog_ui_hbox">'];for(M=0;M<S.length;M++){var U="cke_dialog_ui_hbox_child",V=[];if(M===0){U="cke_dialog_ui_hbox_first"}if(M==S.length-1){U="cke_dialog_ui_hbox_last"}T.push('<td class="',U,'" role="presentation" ');if(L){if(L[M]){V.push("width:"+h(L[M]))}}else{V.push("width:"+Math.floor(100/S.length)+"%")}if(P){V.push("height:"+h(P))}if(I&&I.padding!=undefined){V.push("padding:"+h(I.padding))}if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&K[M].align){V.push("text-align:"+K[M].align)}if(V.length>0){T.push('style="'+V.join("; ")+'" ')}T.push(">",S[M],"</td>")}T.push("</tr></tbody>");return T.join("")};var H={role:"presentation"};I&&I.align&&(H.align=I.align);CKEDITOR.ui.dialog.uiElement.call(this,N,I||{type:"hbox"},J,"table",Q,H,O)},vbox:function(L,O,P,J,H){if(arguments.length<3){return}this._||(this._={});var K=this._.children=O,I=H&&H.width||null,M=H&&H.heights||null;var N=function(){var R=['<table role="presentation" cellspacing="0" border="0" '];R.push('style="');if(H&&H.expand){R.push("height:100%;")}R.push("width:"+h(I||"100%"),";");if(CKEDITOR.env.webkit){R.push("float:none;")}R.push('"');R.push('align="',CKEDITOR.tools.htmlEncode(H&&H.align||(L.getParentEditor().lang.dir=="ltr"?"left":"right")),'" ');R.push("><tbody>");for(var Q=0;Q<P.length;Q++){var S=[];R.push('<tr><td role="presentation" ');if(I){S.push("width:"+h(I||"100%"))}if(M){S.push("height:"+h(M[Q]))}else{if(H&&H.expand){S.push("height:"+Math.floor(100/P.length)+"%")}}if(H&&H.padding!=undefined){S.push("padding:"+h(H.padding))}if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&K[Q].align){S.push("text-align:"+K[Q].align)}if(S.length>0){R.push('style="',S.join("; "),'" ')}R.push(' class="cke_dialog_ui_vbox_child">',P[Q],"</td></tr>")}R.push("</tbody></table>");return R.join("")};CKEDITOR.ui.dialog.uiElement.call(this,L,H||{type:"vbox"},J,"div",null,{role:"presentation"},N)}}})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(I,H){this.getInputElement().setValue(I);!H&&this.fire("change",{value:I});return this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return false},selectParentTab:function(){var I=this.getInputElement(),J=I,H;while((J=J.getParent())&&J.$.className.search("cke_dialog_page_contents")==-1){}if(!J){return this}H=J.getAttribute("name");if(this._.dialog._.currentTabId!=H){this._.dialog.selectPage(H)}return this},focus:function(){this.selectParentTab().getInputElement().focus();return this},registerEvents:function(J){var K=/^on([A-Z]\w+)/,H;var L=function(N,O,M,P){O.on("load",function(){N.getInputElement().on(M,P,N)})};for(var I in J){if(!(H=I.match(K))){continue}if(this.eventProcessors[I]){this.eventProcessors[I].call(this,this._.dialog,J[I])}else{L(this,this._.dialog,H[1].toLowerCase(),J[I])}}return this},eventProcessors:{onLoad:function(H,I){H.on("load",I,this)},onShow:function(H,I){H.on("show",I,this)},onHide:function(H,I){H.on("hide",I,this)}},accessKeyDown:function(I,H){this.focus()},accessKeyUp:function(I,H){},disable:function(){var I=this.getElement(),H=this.getInputElement();H.setAttribute("disabled","true");I.addClass("cke_disabled")},enable:function(){var I=this.getElement(),H=this.getInputElement();H.removeAttribute("disabled");I.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){if(!this.isEnabled()||!this.isVisible()){return false}return true}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(H){if(arguments.length<1){return this._.children.concat()}if(!H.splice){H=[H]}if(H.length<2){return this._.children[H[0]]}else{return this._.children[H[0]]&&this._.children[H[0]].getChild?this._.children[H[0]].getChild(H.slice(1,H.length)):null}}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox;(function(){var H={build:function(O,I,L){var K=I.children,J,Q=[],P=[];for(var N=0;N<K.length&&(J=K[N]);N++){var M=[];Q.push(M);P.push(CKEDITOR.dialog._.uiElementBuilders[J.type].build(O,J,M))}return new CKEDITOR.ui.dialog[I.type](O,P,Q,L,I)}};CKEDITOR.dialog.addUIElement("hbox",H);CKEDITOR.dialog.addUIElement("vbox",H)})();CKEDITOR.dialogCommand=function(I,H){this.dialogName=I;CKEDITOR.tools.extend(this,H,true)};CKEDITOR.dialogCommand.prototype={exec:function(H){CKEDITOR.env.opera?CKEDITOR.tools.setTimeout(function(){H.openDialog(this.dialogName)},0,this):H.openDialog(this.dialogName)},canUndo:false,editorFocus:1};(function(){var I=/^([a]|[^a])+$/,H=/^\d*$/,J=/^\d*(?:\.\d+)?$/,K=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,M=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,L=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){var N=arguments;return function(){var Q=this&&this.getValue?this.getValue():N[0];var S=undefined,P=CKEDITOR.VALIDATE_AND,R=[],O;for(O=0;O<N.length;O++){if(typeof N[O]=="function"){R.push(N[O])}else{break}}if(O<N.length&&typeof N[O]=="string"){S=N[O];O++}if(O<N.length&&typeof N[O]=="number"){P=N[O]}var T=P==CKEDITOR.VALIDATE_AND?true:false;for(O=0;O<R.length;O++){if(P==CKEDITOR.VALIDATE_AND){T=T&&R[O](Q)}else{T=T||R[O](Q)}}return!T?S:true}},regex:function(N,O){return function(){var P=this&&this.getValue?this.getValue():arguments[0];return!N.test(P)?O:true}},notEmpty:function(N){return this.regex(I,N)},integer:function(N){return this.regex(H,N)},number:function(N){return this.regex(J,N)},cssLength:function(N){return this.functions(function(O){return M.test(CKEDITOR.tools.trim(O))},N)},htmlLength:function(N){return this.functions(function(O){return K.test(CKEDITOR.tools.trim(O))},N)},inlineStyle:function(N){return this.functions(function(O){return L.test(CKEDITOR.tools.trim(O))},N)},equals:function(N,O){return this.functions(function(P){return P==N},O)},notEqual:function(N,O){return this.functions(function(P){return P!=N},O)}};CKEDITOR.on("instanceDestroyed",function(O){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){var N;while(N=CKEDITOR.dialog._.currentTop){N.hide()}e()}var Q=O.editor._.storedDialogs;for(var P in Q){Q[P].destroy()}})})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(J,L){var H=null,K=CKEDITOR.dialog._.dialogDefinitions[J];if(CKEDITOR.dialog._.currentTop===null){i(this)}if(typeof K=="function"){var I=this._.storedDialogs||(this._.storedDialogs={});H=I[J]||(I[J]=new CKEDITOR.dialog(this,J));L&&L.call(H,H);H.show()}else{if(K=="failed"){o(this);throw new Error('[CKEDITOR.dialog.openDialog] Dialog "'+J+'" failed when loading definition.')}else{if(typeof K=="string"){CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(K),function(){var M=CKEDITOR.dialog._.dialogDefinitions[J];if(typeof M!="function"){CKEDITOR.dialog._.dialogDefinitions[J]="failed"}this.openDialog(J,L)},this,0,1)}}}CKEDITOR.skin.loadPart("dialog");return H}})})();CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(a){a.on("doubleclick",function(b){if(b.data.dialog){a.openDialog(b.data.dialog)}},null,null,999)}});